<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>ikarus&#39;s BLOG</title>
    <link>https://ikarus-999.github.io/</link>
    
    <image>
      <url>https://www.gravatar.com/avatar/5a9f87e79678fa1d3ad8a772986a89a0</url>
      <title>ikarus&#39;s BLOG</title>
      <link>https://ikarus-999.github.io/</link>
    </image>
    
    <atom:link href="https://ikarus-999.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>ë°ì´í„°ìŸì´ ì´ì¹´ë£¨ìŠ¤ ë¸”ë¡œê·¸ì…ë‹ˆë‹¤</description>
    <pubDate>Sun, 03 Jan 2021 07:56:26 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>ì†Œì†Œí•œ ì—°êµ¬ì•„ë‹Œ ì—°êµ¬</title>
      <link>https://ikarus-999.github.io/2021/01/03/%EC%86%8C%EC%86%8C%ED%95%9C-%EC%97%B0%EA%B5%AC%EC%95%84%EB%8B%8C-%EC%97%B0%EA%B5%AC/</link>
      <guid>https://ikarus-999.github.io/2021/01/03/%EC%86%8C%EC%86%8C%ED%95%9C-%EC%97%B0%EA%B5%AC%EC%95%84%EB%8B%8C-%EC%97%B0%EA%B5%AC/</guid>
      <pubDate>Sun, 03 Jan 2021 04:05:29 GMT</pubDate>
      
      <description>ë„˜ì‚¬ë²½ ë‚œì´ë„ì¸ íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ë§
 ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ë³‘ë ¬ ì²˜ë¦¬í•œë‹¤ëŠ” ì ì—ì„œëŠ” ê°€ì¥ ì¢‹ì§€ë§Œ
ê·¸ë§Œí¼ ëª¨ë¸ë§ í•˜ê¸°ê°€ ê¹Œë‹¤ë¡­ë‹¤.

 model input : (Batch, Sequence, feature_num)

 TransformerëŠ” input / outputì„ ì˜ëª» ì„¤ê³„í•˜ë‹¤ê°„ sequence ì •ë³´ê°€ ë‚ ì•„ê°ˆ ìˆ˜ë„ ìˆê³ 
ê·¸ëƒ¥ ë°ì´í„° ìì²´ê°€ 8:45 ê°€ ë ìˆ˜ê°€ ìˆë‹¤.

 ì…ë ¥ ë°ì´í„°ë¥¼ Seqneuceë¡œ Packing í•´ì£¼ì–´ì•¼ í•™ìŠµì´ ê°€ëŠ¥í•œ ë°ì´í„°ê°€ ëœë‹¤.

 Sequence Packing ë°©ë²•ì€ íŒŒì´ì¬ ë¬¸ë²•ìœ¼ë¡œ ë¹„êµì  ì‰½ê²Œ ë˜ì§€ë§Œâ€¦

1</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë„˜ì‚¬ë²½-ë‚œì´ë„ì¸-íŠ¸ëœìŠ¤í¬ë¨¸-ëª¨ë¸ë§"><a href="#ë„˜ì‚¬ë²½-ë‚œì´ë„ì¸-íŠ¸ëœìŠ¤í¬ë¨¸-ëª¨ë¸ë§" class="headerlink" title="ë„˜ì‚¬ë²½ ë‚œì´ë„ì¸ íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ë§"></a>ë„˜ì‚¬ë²½ ë‚œì´ë„ì¸ íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ë§</h2><p>  ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ë³‘ë ¬ ì²˜ë¦¬í•œë‹¤ëŠ” ì ì—ì„œëŠ” ê°€ì¥ ì¢‹ì§€ë§Œ<br>  ê·¸ë§Œí¼ ëª¨ë¸ë§ í•˜ê¸°ê°€ ê¹Œë‹¤ë¡­ë‹¤.</p><p>  model input : (Batch, Sequence, feature_num)</p><p>  TransformerëŠ” input / outputì„ ì˜ëª» ì„¤ê³„í•˜ë‹¤ê°„ sequence ì •ë³´ê°€ ë‚ ì•„ê°ˆ ìˆ˜ë„ ìˆê³ <br>  ê·¸ëƒ¥ ë°ì´í„° ìì²´ê°€ 8:45 ê°€ ë ìˆ˜ê°€ ìˆë‹¤.</p><p>  ì…ë ¥ ë°ì´í„°ë¥¼ Seqneuceë¡œ Packing í•´ì£¼ì–´ì•¼ í•™ìŠµì´ ê°€ëŠ¥í•œ ë°ì´í„°ê°€ ëœë‹¤.</p><p>  Sequence Packing ë°©ë²•ì€ íŒŒì´ì¬ ë¬¸ë²•ìœ¼ë¡œ ë¹„êµì  ì‰½ê²Œ ë˜ì§€ë§Œâ€¦</p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df_train = train.values</span><br><span class="line">train_seq = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(seq_len, <span class="built_in">len</span>(df_train)+<span class="number">1</span>):</span><br><span class="line">  train_seq.append(df_train[i - seq_len: i])</span><br><span class="line">train_seq = np.array(train_seq)</span><br></pre></td></tr></table></figure><p>  Sequence unpacking ì€ numpy ì—°ì‚°ì„ ì¨ì•¼ ë¹„êµì  ì‰¬ì›€..<br>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">out = np.vstack(r <span class="keyword">for</span> r <span class="keyword">in</span> train_seq)</span><br><span class="line">out = out.unique(out, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure></p><p>  <img src="/2021/01/03/%EC%86%8C%EC%86%8C%ED%95%9C-%EC%97%B0%EA%B5%AC%EC%95%84%EB%8B%8C-%EC%97%B0%EA%B5%AC/%ED%8F%AC%ED%8A%B8%ED%8F%B4%EB%A6%AC%EC%98%A41.PNG" alt="packing &amp; unpacking"></p><p>  <img src="/2021/01/03/%EC%86%8C%EC%86%8C%ED%95%9C-%EC%97%B0%EA%B5%AC%EC%95%84%EB%8B%8C-%EC%97%B0%EA%B5%AC/%ED%8F%AC%ED%8A%B8%ED%8F%B4%EB%A6%AC%EC%98%A42.PNG" alt="unpacking2"></p><h3 id="ë‹¤ë³€ëŸ‰-íšŒê·€ì—ì„œ-ì–»ì€-êµí›ˆ-1"><a href="#ë‹¤ë³€ëŸ‰-íšŒê·€ì—ì„œ-ì–»ì€-êµí›ˆ-1" class="headerlink" title="ë‹¤ë³€ëŸ‰ íšŒê·€ì—ì„œ ì–»ì€ êµí›ˆ 1"></a>ë‹¤ë³€ëŸ‰ íšŒê·€ì—ì„œ ì–»ì€ êµí›ˆ 1</h3><p>  ì…ë ¥ ë°ì´í„°ë¥¼ ë°›ì•„ì„œ Time Embeddingâ€¦</p><p>  ì‹œê°„ë³„ Positional Encoding ë°©ë²•ì„ ì†Œê°œí•˜ì§€.</p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time2Vector</span>(<span class="params">Layer</span>):</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, seq_len, **kwargs</span>):</span></span><br><span class="line">      <span class="built_in">super</span>(Time2Vector, self).__init__()</span><br><span class="line">      self.seq_len = seq_len</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">build</span>(<span class="params">self, input_shape</span>):</span></span><br><span class="line">      <span class="string">&#x27;&#x27;&#x27;shape (batch, seq_len) í˜•íƒœë¡œ ê°€ì¤‘ì¹˜ì™€ Bias ì´ˆê¸°í™” &#x27;&#x27;&#x27;</span></span><br><span class="line">      self.weights_linear = self.add_weight(name=<span class="string">&#x27;weight_linear&#x27;</span>,</span><br><span class="line">                                  shape=(<span class="built_in">int</span>(self.seq_len),),</span><br><span class="line">                                  initializer=<span class="string">&#x27;uniform&#x27;</span>,</span><br><span class="line">                                  trainable=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">      self.bias_linear = self.add_weight(name=<span class="string">&#x27;bias_linear&#x27;</span>,</span><br><span class="line">                                  shape=(<span class="built_in">int</span>(self.seq_len),),</span><br><span class="line">                                  initializer=<span class="string">&#x27;uniform&#x27;</span>,</span><br><span class="line">                                  trainable=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">      self.weights_periodic = self.add_weight(name=<span class="string">&#x27;weight_periodic&#x27;</span>,</span><br><span class="line">                                  shape=(<span class="built_in">int</span>(self.seq_len),),</span><br><span class="line">                                  initializer=<span class="string">&#x27;uniform&#x27;</span>,</span><br><span class="line">                                  trainable=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">      self.bias_periodic = self.add_weight(name=<span class="string">&#x27;bias_periodic&#x27;</span>,</span><br><span class="line">                                  shape=(<span class="built_in">int</span>(self.seq_len),),</span><br><span class="line">                                  initializer=<span class="string">&#x27;uniform&#x27;</span>,</span><br><span class="line">                                  trainable=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">call</span>(<span class="params">self, x</span>):</span></span><br><span class="line">      <span class="string">&#x27;&#x27;&#x27;ì£¼ê¸°ì„±, ì„ í˜• ì‹œê°„ë³„ íŠ¹ì§•ì„ ê³„ì‚°&#x27;&#x27;&#x27;</span></span><br><span class="line">      x = tf.math.reduce_mean(x[:,:,:], axis=<span class="number">-1</span>) <span class="comment"># ì…ë ¥ Feature ì°¨ì› ìŠ¬ë¼ì´ì‹±</span></span><br><span class="line">      time_linear = self.weights_linear * x + self.bias_linear <span class="comment"># ì„ í˜• ì‹œê°„ íŠ¹ì§•</span></span><br><span class="line">      time_linear = tf.expand_dims(time_linear, axis=<span class="number">-1</span>) <span class="comment"># ì°¨ì› ì¶”ê°€ (batch, seq_len, 1)</span></span><br><span class="line"></span><br><span class="line">      time_periodic = tf.math.sin(tf.multiply(x, self.weights_periodic) + self.bias_periodic)</span><br><span class="line">      time_periodic = tf.expand_dims(time_periodic, axis=<span class="number">-1</span>) <span class="comment"># ì°¨ì› ì¶”ê°€ (batch, seq_len, 1)</span></span><br><span class="line">      <span class="keyword">return</span> tf.concat([time_linear, time_periodic], axis=<span class="number">-1</span>) <span class="comment"># shape = (batch, seq_len, 2)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="íŠ¸ëœìŠ¤í¬ë¨¸ì˜-íŠ¹ì§•"><a href="#íŠ¸ëœìŠ¤í¬ë¨¸ì˜-íŠ¹ì§•" class="headerlink" title="íŠ¸ëœìŠ¤í¬ë¨¸ì˜ íŠ¹ì§•"></a>íŠ¸ëœìŠ¤í¬ë¨¸ì˜ íŠ¹ì§•</h3><p>  ì‹œê³„ì—´ ë°ì´í„° ë¶„ë¥˜, íšŒê·€ ë¬¸ì œì—ì„œëŠ”<br>  Decoderê°€ ë¹ ì ¸ìˆëŠ” Self Attentionì„ ì‚¬ìš©í•œë‹¤.  (Fine Tunning)</p><p>  DecoderëŠ” ì±—ë´‡ì´ë‚˜ Auto-Encoderê°™ì€ Encoder-Decoder êµ¬ì¡°ì— ì‚¬ìš©ë˜ëŠ” ê²½í–¥ì´ ìˆë‹¤.</p><p>  ì°¸ê³  ë…¼ë¬¸ : <a href="https://openreview.net/forum?id=lE1AB4stmX">https://openreview.net/forum?id=lE1AB4stmX</a></p><p>  ë…¼ë¬¸ì—ì„œëŠ” n_layer_num, padding_mask ë¥¼ ì“°ëŠ” íŠ¹ì§•ì´ ìˆë‹¤. ì´ íŒŒë¼ë¯¸í„°ê¹Œì§€ ì“¸ ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ì§€ë§Œ<br>  GPU ë©”ëª¨ë¦¬ê°€ 8ê¸°ê°€ë°–ì— ì•ˆë˜ì„œ ë…¼ë¬¸ íŒŒë¼ë¯¸í„°ë³´ë‹¤ëŠ” ì‘ê²Œ ì„¤ì •ì„ í•´ì•¼ ì›í™œì´ ê°€ëŠ¥í•˜ë‹¤.<br>  ê·¸ë¦¬ê³  datasetì„ window í•˜ë©´ GPU RAM ì‚¬ìš©ëŸ‰ì„ ë” ë‚®ì¶œ ìˆ˜ ìˆë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/Try/">Try</category>
      
      <category domain="https://ikarus-999.github.io/tags/Dev/">Dev</category>
      
      
      <comments>https://ikarus-999.github.io/2021/01/03/%EC%86%8C%EC%86%8C%ED%95%9C-%EC%97%B0%EA%B5%AC%EC%95%84%EB%8B%8C-%EC%97%B0%EA%B5%AC/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ì¹˜ì—´í•œ-ë°ì´ì½˜í›„ê¸°</title>
      <link>https://ikarus-999.github.io/2021/01/02/%EC%B9%98%EC%97%B4%ED%95%9C-%EB%8D%B0%EC%9D%B4%EC%BD%98%ED%9B%84%EA%B8%B0/</link>
      <guid>https://ikarus-999.github.io/2021/01/02/%EC%B9%98%EC%97%B4%ED%95%9C-%EB%8D%B0%EC%9D%B4%EC%BD%98%ED%9B%84%EA%B8%B0/</guid>
      <pubDate>Sat, 02 Jan 2021 12:56:29 GMT</pubDate>
      
      <description>ë°ì´ì½˜ ìµœê·¼ ëŒ€íšŒ í›„ê¸° - ë°ì´ì½˜ ì–´ë‚˜ë” ë²„ì „
 í¥ë¯¸ë¡­ì§€ë§Œ quantile lossâ€¦ ì •ë§ ë§Œë§Œì¹˜ ì•Šë‹¤.
loss function ìˆ˜ì‹êµ¬í˜„ì€ ì‰½ì§€ë§Œ lossë¥¼ ì¤„ì´ëŠ” ë°©ë²•ì´ ê´€ê±´ì´ë‹¤.
ì§„ì§œ 4.1ì—ì„œ ì¤„ì–´ë“¤ì§€ ì•ŠëŠ” lossâ€¦ ê³¼ì—° ì–´ë–»ê²Œ í•˜ë©´ ì¤„ì¼ìˆ˜ ìˆì„ê¹Œâ€¦

ë‹¤ë³€ëŸ‰ íšŒê·€ ì™œ ì´ë ‡ê²Œ ì–´ë ¤ìš¸ê¹Œìš”? - ë°ì´ì½˜ ëŒ€íšŒì—ì„œ ì–»ì€ ì—„ì²­ë‚œ êµí›ˆ
 loss ê³„ì‚°í• ë•Œ ë‹¤ë¥¸ target ê°’ê³¼ x_trainê°’ì´ ì•„ë‹Œ 

 ë‹¤ë¥¸ Element ë¼ë¦¬ ê³„ì‚°ë˜ì–´ì„œ ì˜¤íˆë ¤ lossê°€ í­ì¦í•˜ê¸°ë„ í•œë‹¤.

 Wandbë¡œ ì‹œê°í™” ì•ˆí–ˆìœ¼ë©´ í°ì¼ë‚¬ì—ˆì„ë“¯ ì‹¶ì—ˆë‹¤. 

 </description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë°ì´ì½˜-ìµœê·¼-ëŒ€íšŒ-í›„ê¸°-ë°ì´ì½˜-ì–´ë‚˜ë”-ë²„ì „"><a href="#ë°ì´ì½˜-ìµœê·¼-ëŒ€íšŒ-í›„ê¸°-ë°ì´ì½˜-ì–´ë‚˜ë”-ë²„ì „" class="headerlink" title="ë°ì´ì½˜ ìµœê·¼ ëŒ€íšŒ í›„ê¸° - ë°ì´ì½˜ ì–´ë‚˜ë” ë²„ì „"></a>ë°ì´ì½˜ ìµœê·¼ ëŒ€íšŒ í›„ê¸° - ë°ì´ì½˜ ì–´ë‚˜ë” ë²„ì „</h2><p>  í¥ë¯¸ë¡­ì§€ë§Œ quantile lossâ€¦ ì •ë§ ë§Œë§Œì¹˜ ì•Šë‹¤.<br>  loss function ìˆ˜ì‹êµ¬í˜„ì€ ì‰½ì§€ë§Œ lossë¥¼ ì¤„ì´ëŠ” ë°©ë²•ì´ ê´€ê±´ì´ë‹¤.<br>  ì§„ì§œ 4.1ì—ì„œ ì¤„ì–´ë“¤ì§€ ì•ŠëŠ” lossâ€¦ ê³¼ì—° ì–´ë–»ê²Œ í•˜ë©´ ì¤„ì¼ìˆ˜ ìˆì„ê¹Œâ€¦</p><h3 id="ë‹¤ë³€ëŸ‰-íšŒê·€-ì™œ-ì´ë ‡ê²Œ-ì–´ë ¤ìš¸ê¹Œìš”-ë°ì´ì½˜-ëŒ€íšŒì—ì„œ-ì–»ì€-ì—„ì²­ë‚œ-êµí›ˆ"><a href="#ë‹¤ë³€ëŸ‰-íšŒê·€-ì™œ-ì´ë ‡ê²Œ-ì–´ë ¤ìš¸ê¹Œìš”-ë°ì´ì½˜-ëŒ€íšŒì—ì„œ-ì–»ì€-ì—„ì²­ë‚œ-êµí›ˆ" class="headerlink" title="ë‹¤ë³€ëŸ‰ íšŒê·€ ì™œ ì´ë ‡ê²Œ ì–´ë ¤ìš¸ê¹Œìš”? - ë°ì´ì½˜ ëŒ€íšŒì—ì„œ ì–»ì€ ì—„ì²­ë‚œ êµí›ˆ"></a>ë‹¤ë³€ëŸ‰ íšŒê·€ ì™œ ì´ë ‡ê²Œ ì–´ë ¤ìš¸ê¹Œìš”? - ë°ì´ì½˜ ëŒ€íšŒì—ì„œ ì–»ì€ ì—„ì²­ë‚œ êµí›ˆ</h3><p>  loss ê³„ì‚°í• ë•Œ ë‹¤ë¥¸ target ê°’ê³¼ x_trainê°’ì´ ì•„ë‹Œ   </p><p>  ë‹¤ë¥¸ Element ë¼ë¦¬ ê³„ì‚°ë˜ì–´ì„œ ì˜¤íˆë ¤ lossê°€ í­ì¦í•˜ê¸°ë„ í•œë‹¤.</p><p>  Wandbë¡œ ì‹œê°í™” ì•ˆí–ˆìœ¼ë©´ í°ì¼ë‚¬ì—ˆì„ë“¯ ì‹¶ì—ˆë‹¤. </p><p>  Loss ì‹œê°í™” íˆ´ë¡œ ë³´ë‹ˆ ì´ˆë°˜ì—ì„œ ìˆ˜ë ´í•˜ì§€ ì•ŠëŠ” ë¬¸ì œë‚˜ ì•„ì˜ˆ uìë¡œ ë¶ˆê·œì¹™ì ìœ¼ë¡œ íŠ€ëŠ” í˜„ìƒë„ ë°œìƒâ€¦.</p><p>  <img src="/2021/01/02/%EC%B9%98%EC%97%B4%ED%95%9C-%EB%8D%B0%EC%9D%B4%EC%BD%98%ED%9B%84%EA%B8%B0/%EC%8B%A0%EA%B8%B0%ED%95%9C%EA%B7%B8%EB%9E%98%ED%94%84.PNG" alt="lossê°€ ì¤„ì–´ë“œëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ ì‹¤ì œëŠ” ..."></p><p>  ë¶„ëª… window datasetìœ¼ë¡œ ë¶€í•˜ë¶„ì‚°ì„ í•˜ë©´ ë°ì´í„° ì²˜ë¦¬ê°€ ìˆ˜ì›”í•  ê²ƒ ê°™ì§€ë§Œâ€¦</p><p>  ì±„ì ì„ í•´ë³´ë‹ˆ ê·¹ì•…ì˜ Lossê°€ ë‚˜ì˜¤ê¸°ë„ í•œë‹¤.</p><p>  ì´ ë–„ì—ëŠ” window_size, buffer sizeë¥¼ ì˜ ì¡°ì ˆí•´ì•¼ í•œë‹¤.</p><p>  window_sizeë¥¼ ë„ˆë¬´ ë‚®ì¶”ë©´ ìì¹«í•˜ë©´ GPU ì‚¬ìš©ë¥ ì€ í•œìë¦¬ì— ë¨¸ë¬¼ê³  ì‹œê°„ì€ ì˜¤ë˜ ê±¸ë¦°ë‹¤. </p><p>  í•˜ì§€ë§Œ GPU RAM ì‚¬ìš©ëŸ‰ì€ ì¤„ì–´ë“œëŠ” ì´ì ì€ ìˆë‹¤.</p><p>  window datasetì„ í•˜ë‹¤ë³´ë©´ ë°°ì¹˜ í¬ê¸°ê°€ ì•ˆ ë§ì•„ì„œ ì˜ˆì¸¡ì´ ì•ˆë ë•Œê°€ ìˆëŠ”ë° ì´ëŸ´ë•â€¦<br>  <img src="/2021/01/02/%EC%B9%98%EC%97%B4%ED%95%9C-%EB%8D%B0%EC%9D%B4%EC%BD%98%ED%9B%84%EA%B8%B0/%ED%9D%90%EC%9D%B5.PNG" alt="ë°°ì¹˜ í¬ê¸°ê°€ ì•ˆë§ì„ ë–„ëŠ” ì´ë ‡ê²Œ paddingì„ ì“´ë‹¤."></p><p>  Shuffle Buffer size ì¡°ì ˆì€ í•„ìˆ˜, batch Sizeì— ì£¼ì˜í•˜ì—¬ ì¡°ì ˆí•œë‹¤.<br>  ê·¸ë ‡ì§€ ì•Šìœ¼ë©´(BATCH SIZEê°€ êµ‰ì¥íˆ ë†’ë‹¤ë©´)<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WARNING:tensorflow:5 out of the last 5 calls to &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x7f2570221d30&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes&#x3D;True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https:&#x2F;&#x2F;www.tensorflow.org&#x2F;tutorials&#x2F;customization&#x2F;performance#python_or_tensor_args and https:&#x2F;&#x2F;www.tensorflow.org&#x2F;api_docs&#x2F;python&#x2F;tf&#x2F;function for  more details. </span><br></pre></td></tr></table></figure></p><p>  ì´ëŸ° ê²½ê³ ê°€ ë‚˜ì˜¨ë‹¤.. -&gt; batch sizeë¥¼ ë°˜ë“œì‹œ ì¡°ì ˆí•˜ê±°ë‚˜ batch paddingâ€¦</p>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/Kaggle-Dacon/">Kaggle, Dacon</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/Dacon/">Dacon</category>
      
      <category domain="https://ikarus-999.github.io/tags/Try/">Try</category>
      
      
      <comments>https://ikarus-999.github.io/2021/01/02/%EC%B9%98%EC%97%B4%ED%95%9C-%EB%8D%B0%EC%9D%B4%EC%BD%98%ED%9B%84%EA%B8%B0/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ì–´ë‚˜ë”Daconë„ì „ê¸°_2</title>
      <link>https://ikarus-999.github.io/2020/12/23/%EC%96%B4%EB%82%98%EB%8D%94Dacon%EB%8F%84%EC%A0%84%EA%B8%B0-2/</link>
      <guid>https://ikarus-999.github.io/2020/12/23/%EC%96%B4%EB%82%98%EB%8D%94Dacon%EB%8F%84%EC%A0%84%EA%B8%B0-2/</guid>
      <pubDate>Tue, 22 Dec 2020 15:13:20 GMT</pubDate>
      
      <description>ë°ì´ì½˜ ë˜ë‹¤ë¥¸ ëŒ€íšŒ í›„ê¸° - ë°ì´ì½˜ ì–´ë‚˜ë” ë²„ì „ğŸŒ ğŸŒ 
 ì—­ì‹œ í¥ë¯¸ë¡œìš´ ë°ì´í„° ì„¸ê³„ ğŸ±
Regression, íŠ¹íˆ CNN, LSTM ëª¨ë¸ì€ Epochë¥¼ ëŠ˜ë¦¬ë©´ ë”ìš± ì •í™•ë„ê°€ í–¥ìƒë˜ëŠ” íŠ¹ì§•ì´ ìˆë‹¤!! 

 ë„ˆë¬´ ë§ì´ ëŠ˜ë¦¬ë©´ Overfittingì´ ë‚  ìˆ˜ ìˆìœ¼ë‹ˆ LR ìŠ¤ì¼€ì¤„ëŸ¬ ë“± ë‹¤ì–‘í•œ ë°©ë²•ì„ ì‹œë„í•´ë´ì•¼ í•œë‹¤.

CNN-LSTM ë‹¤ë³€ëŸ‰ íšŒê·€ ëª¨ë¸ë§ í›„ê¸°ğŸŒ 
 ì²˜ìŒì—ëŠ” ì™œ ì´ë ‡ê²Œ lossê°€ ì¤„ì§€ ì•ŠëŠ”ì§€ ğŸš ì˜ë¬¸ì´ ë“¤ì—ˆë‹¤.ğŸŒ 

 
í—â€¦ 4.5 ë¼ë‹ˆ;;;ğŸ”Œ 20Epoch ê°€ì§€ê³ ëŠ” ì•„ì˜ˆ í•™ìŠµì´ ì•ˆë˜ë‚˜ë³´ë‹¤.

 ê·¸ëŸ¬ë©´ EpochğŸ•œë¥¼ ëŠ˜</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë°ì´ì½˜-ë˜ë‹¤ë¥¸-ëŒ€íšŒ-í›„ê¸°-ë°ì´ì½˜-ì–´ë‚˜ë”-ë²„ì „ğŸŒ ğŸŒ "><a href="#ë°ì´ì½˜-ë˜ë‹¤ë¥¸-ëŒ€íšŒ-í›„ê¸°-ë°ì´ì½˜-ì–´ë‚˜ë”-ë²„ì „ğŸŒ ğŸŒ " class="headerlink" title="ë°ì´ì½˜ ë˜ë‹¤ë¥¸ ëŒ€íšŒ í›„ê¸° - ë°ì´ì½˜ ì–´ë‚˜ë” ë²„ì „ğŸŒ ğŸŒ "></a>ë°ì´ì½˜ ë˜ë‹¤ë¥¸ ëŒ€íšŒ í›„ê¸° - ë°ì´ì½˜ ì–´ë‚˜ë” ë²„ì „ğŸŒ ğŸŒ </h2><p>  ì—­ì‹œ í¥ë¯¸ë¡œìš´ ë°ì´í„° ì„¸ê³„ ğŸ±<br>  Regression, íŠ¹íˆ CNN, LSTM ëª¨ë¸ì€ Epochë¥¼ ëŠ˜ë¦¬ë©´ ë”ìš± ì •í™•ë„ê°€ í–¥ìƒë˜ëŠ” íŠ¹ì§•ì´ ìˆë‹¤!!  </p><p>  ë„ˆë¬´ ë§ì´ ëŠ˜ë¦¬ë©´ Overfittingì´ ë‚  ìˆ˜ ìˆìœ¼ë‹ˆ LR ìŠ¤ì¼€ì¤„ëŸ¬ ë“± ë‹¤ì–‘í•œ ë°©ë²•ì„ ì‹œë„í•´ë´ì•¼ í•œë‹¤.</p><h3 id="CNN-LSTM-ë‹¤ë³€ëŸ‰-íšŒê·€-ëª¨ë¸ë§-í›„ê¸°ğŸŒ "><a href="#CNN-LSTM-ë‹¤ë³€ëŸ‰-íšŒê·€-ëª¨ë¸ë§-í›„ê¸°ğŸŒ " class="headerlink" title="CNN-LSTM ë‹¤ë³€ëŸ‰ íšŒê·€ ëª¨ë¸ë§ í›„ê¸°ğŸŒ "></a>CNN-LSTM ë‹¤ë³€ëŸ‰ íšŒê·€ ëª¨ë¸ë§ í›„ê¸°ğŸŒ </h3><p>  ì²˜ìŒì—ëŠ” ì™œ ì´ë ‡ê²Œ lossê°€ ì¤„ì§€ ì•ŠëŠ”ì§€ ğŸš ì˜ë¬¸ì´ ë“¤ì—ˆë‹¤.ğŸŒ </p><p>  <img src="/2020/12/23/%EC%96%B4%EB%82%98%EB%8D%94Dacon%EB%8F%84%EC%A0%84%EA%B8%B0-2/Multi_var_reg.PNG" alt="lossê°€ ì „í˜€ ì¤„ì§€ ì•ŠìŒ"><br>  í—â€¦ 4.5 ë¼ë‹ˆ;;;ğŸ”Œ 20Epoch ê°€ì§€ê³ ëŠ” ì•„ì˜ˆ í•™ìŠµì´ ì•ˆë˜ë‚˜ë³´ë‹¤.</p><p>  ê·¸ëŸ¬ë©´ EpochğŸ•œë¥¼ ëŠ˜ë¦¬ëŠ”ë° ê·¸ëƒ¥ ëŠ˜ë¦¬ë©´ ì•ˆëœë‹¤ğŸ’½</p><p>  ìì¹« ì˜ëª»í•˜ë©´ ì˜¤ë²„í”¼íŒ…ì´ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.ğŸ•œ</p><p>  ê·¸ë¦¬ê³  ì‹œê³„ì—´ ë¬¸ì œëŠ” ì‹œê°„, êµ¬ê°„ë‹¹ í‰ê· ì´ë‚˜ ì—¬ëŸ¬ í†µê³„ì  ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ì•¼ ì ìˆ˜ê°€ ë” ì˜ë‚˜ì˜¤ëŠ” íŠ¹ì§•ì´ ìˆë‹¤.â©</p><p>  <a href="https://github.com/sachinruk/KerasQuantileModel/blob/master/Keras%20Quantile%20Model.ipynb">ì°¸ê³ ë¬¸ì„œ1</a></p><p>  ì—­ì‹œë‚˜ ì˜ˆì¸¡ì´ ë§ì•˜ë‹¤. Epochì„ ì•½ê°„(?) ê²ë‚˜ê²Œ ëŠ˜ë¦¬ê³  optimizerë‚˜ ë‹¤ë¥¸ í•™ìŠµìœ¨ ìŠ¤ì¼€ì¤„ëŸ¬, sgdì— decay, momentum ì„ ì£¼ì–´ì•¼ í•˜ë‚˜ë³´ë‹¤.</p><p>  ê·¸ë¦¬ê³  ë‹¤ë³€ëŸ‰ íšŒê·€ì´ê¸° ë•Œë¬¸ì— validation loss ê³„ì‚°ì´ ì•½ê°„ ì‹ ì¤‘í•´ì•¼ ì •í™•í•œ lossê°’ì´ ê³„ì‚°ì´ ê°€ëŠ¥í•˜ë‹¤.</p><p>  test datasetì— element-wise ë°©ì‹ìœ¼ë¡œ ê³„ì‚°ë˜ëŠ”ê±°ë¼ test dataset shape ê·¸ëŒ€ë¡œ predictê°€ ì¶œë ¥ëœë‹¤.</p><p>  Reshape, Squeeze ë¥¼ ì¨ì„œ shapeì„ ë§ì¶°ì£¼ì–´ì•¼ í•œë‹¤.</p><p>  Quantile Regression ë¬¸ì œëŠ” ê·¸ëƒ¥ Regressionì— Quantileë³„ë¡œ ê°’ì„ ì¶”ì¶œí•´ì•¼ í•˜ëŠ” ì•½ê°„ì˜(?) ë‚œì œê°€ ì¡´ì¬í•œë‹¤.</p><p>  PytorchëŠ” PythonicğŸ í•˜ì§€ë§Œ ì–´ë–¤ ë©´ì—ì„œëŠ” TF2.x ë³´ë‹¤ ë” ê¹Œë‹¤ë¡œìš´ ê²ƒ ê°™ë‹¤.</p>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/Kaggle-Dacon/">Kaggle, Dacon</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/Dacon/">Dacon</category>
      
      <category domain="https://ikarus-999.github.io/tags/Try/">Try</category>
      
      
      <comments>https://ikarus-999.github.io/2020/12/23/%EC%96%B4%EB%82%98%EB%8D%94Dacon%EB%8F%84%EC%A0%84%EA%B8%B0-2/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ì¸ê³µì§€ëŠ¥ ê²½ì§„ëŒ€íšŒ í›„ê¸°</title>
      <link>https://ikarus-999.github.io/2020/12/09/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%ED%9B%84%EA%B8%B0/</link>
      <guid>https://ikarus-999.github.io/2020/12/09/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%ED%9B%84%EA%B8%B0/</guid>
      <pubDate>Tue, 08 Dec 2020 15:16:14 GMT</pubDate>
      
      <description>ì¸ê³µì§€ëŠ¥ ë¬¸ì œí•´ê²° ê²½ì§„ëŒ€íšŒ ì°¸ê°€í›„ê¸° ğŸ””
 ì •ë§ ì¹˜ì—´í–ˆë˜ ê²½ì§„ëŒ€íšŒì˜€ë‹¤. 

 ì²˜ìŒì—ëŠ” ì´ë¯¸ì§€ ë©€í‹°ë¼ë²¨ ë‹¤ì¤‘ ë¶„ë¥˜ ë¬¸ì œê°€ ë‚˜ì™”ì—ˆê³  

 ê·¸ ì´í›„ ë³¸ì„ ëŒ€íšŒì—ì„œëŠ” NLP, OCR, GAN ë“± ì—¬ëŸ¬ ë„ë©”ì¸ ë¬¸ì œê°€ ì¶œí˜„í–ˆì—ˆë‹¤ 

 ë² ì´ìŠ¤ë¼ì¸ ì½”ë“œ ê·¸ëŸ°ê±´ ì‚¬ì‹¤ìƒ ì—†ã…‹ìŒã…‹..ğŸ”

 ê·¸ëƒ¥ ë°ì´í„°ë¥¼ ë§ ê·¸ëŒ€ë¡œ í•´ì²´ ë¶„ì„ì„ í–ˆì–´ì•¼ í–ˆë‹¤.

 ì•„ë¬´ë¦¬ Data Clensingì„ í•´ë„ ê·¸ëŒ€ë¡œì¸ lossì™€ scoreâ€¦ 8:45ğŸ•›

 ê²°êµ­ ì•„ì˜ˆ ë¦¬ëª¨ë¸ë§, ë°ì´í„° Cleanize í•œ ë’¤ì— í•™ìŠµì„ ë‹¤ì‹œ ëŒë ¸ë‹¤.

 ì²œì‹ ë§Œê³  ëì—â€¦

 

 

 
ì°¸ê³ ë¡œ íŒ€ëª…</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ì¸ê³µì§€ëŠ¥-ë¬¸ì œí•´ê²°-ê²½ì§„ëŒ€íšŒ-ì°¸ê°€í›„ê¸°-ğŸ””"><a href="#ì¸ê³µì§€ëŠ¥-ë¬¸ì œí•´ê²°-ê²½ì§„ëŒ€íšŒ-ì°¸ê°€í›„ê¸°-ğŸ””" class="headerlink" title="ì¸ê³µì§€ëŠ¥ ë¬¸ì œí•´ê²° ê²½ì§„ëŒ€íšŒ ì°¸ê°€í›„ê¸° ğŸ””"></a>ì¸ê³µì§€ëŠ¥ ë¬¸ì œí•´ê²° ê²½ì§„ëŒ€íšŒ ì°¸ê°€í›„ê¸° ğŸ””</h2><p>  ì •ë§ ì¹˜ì—´í–ˆë˜ ê²½ì§„ëŒ€íšŒì˜€ë‹¤. </p><p>  ì²˜ìŒì—ëŠ” ì´ë¯¸ì§€ ë©€í‹°ë¼ë²¨ ë‹¤ì¤‘ ë¶„ë¥˜ ë¬¸ì œê°€ ë‚˜ì™”ì—ˆê³   </p><p>  ê·¸ ì´í›„ ë³¸ì„ ëŒ€íšŒì—ì„œëŠ” NLP, OCR, GAN ë“± ì—¬ëŸ¬ ë„ë©”ì¸ ë¬¸ì œê°€ ì¶œí˜„í–ˆì—ˆë‹¤  </p><p>  ë² ì´ìŠ¤ë¼ì¸ ì½”ë“œ ê·¸ëŸ°ê±´ ì‚¬ì‹¤ìƒ ì—†ã…‹ìŒã…‹..ğŸ”</p><p>  ê·¸ëƒ¥ ë°ì´í„°ë¥¼ ë§ ê·¸ëŒ€ë¡œ í•´ì²´ ë¶„ì„ì„ í–ˆì–´ì•¼ í–ˆë‹¤.</p><p>  ì•„ë¬´ë¦¬ Data Clensingì„ í•´ë„ ê·¸ëŒ€ë¡œì¸ lossì™€ scoreâ€¦ 8:45ğŸ•›</p><p>  ê²°êµ­ ì•„ì˜ˆ ë¦¬ëª¨ë¸ë§, ë°ì´í„° Cleanize í•œ ë’¤ì— í•™ìŠµì„ ë‹¤ì‹œ ëŒë ¸ë‹¤.</p><p>  ì²œì‹ ë§Œê³  ëì—â€¦</p><p>  <img src="/2020/12/09/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%ED%9B%84%EA%B8%B0/2222.PNG" alt="ìµœì¢…ìˆœìœ„...ã„·ã„·ã„·"></p><p>  <img src="/2020/12/09/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%ED%9B%84%EA%B8%B0/3333.PNG" alt="ìµœì¢…ìˆœìœ„ ã…ã„·ã„·"></p><p>  <img src="/2020/12/09/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%ED%9B%84%EA%B8%B0/4444.PNG" alt="ìµœì¢…ìˆœìœ„ ã„·ã„·ã„·;;"><br>    ì°¸ê³ ë¡œ íŒ€ëª…ì€ <del>í’ì„ ë„ìš°ê¸°</del> ;;</p><p>  ìµœì¢… ëª…ë‹¨ì— ë°œí‘œë˜ê¸°ê¹Œì§€ ì—„ì²­ë‚œ ê¸´ì¥ê°ì´â€¦ğŸŒ¡ğŸ“ˆ</p>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/Competition/">Competition</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/Try/">Try</category>
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      <category domain="https://ikarus-999.github.io/tags/competition/">competition</category>
      
      
      <comments>https://ikarus-999.github.io/2020/12/09/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%ED%9B%84%EA%B8%B0/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Daconë„ì „ê¸°</title>
      <link>https://ikarus-999.github.io/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/</link>
      <guid>https://ikarus-999.github.io/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/</guid>
      <pubDate>Sun, 06 Dec 2020 12:48:20 GMT</pubDate>
      
      <description>ë°ì´ì½˜ ë„ì „ í›„ê¸°
 í¥ë¯¸ë¡­ì§€ë§Œ ì‰½ì§€ëŠ” ì•Šë‹¤.
ë§ ê·¸ëŒ€ë¡œ ìƒˆë¡œìš´ íŒŒìƒë³€ìˆ˜, ëª¨ë¸ì„ ë§ì´ ë§Œë“¤ë©´ ì ìˆ˜ê°€ ì˜¤ë¥´ê¸´ í•œë‹¤.

 ë°ì´ì½˜_ì—°ìŠµë¬¸ì œ

 ì—°ìŠµìš©ì´ê¸´ í•œë° BERTëª¨ë¸ í­ê²©ìœ¼ë¡œ ì–‘ë¯¼í•™ì‚´ ì´ ë²Œì¨ë¶€í„° ì‹œì‘ë˜ì—ˆâ€¦ã…ã„·ã„·

 ë²„íŠ¸ëª¨ë¸ ì•ˆì“°ê³ ë„ ìˆœìœ„ ì˜¬ë¦´ìˆ˜ëŠ” ìˆë‹¤. 

 ì§€ê¸ˆë¶€í„° ê·¸ ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.

ë°ì´ì½˜ ìˆœìœ„ë¥¼ ì˜¬ë¦´ìˆ˜ ìˆëŠ” ë°©ë²• - ì°½ì˜ì ì¸ modeling, K-cross Validation, parameter searching
 

 VDCNNì€ GPUê°€ ì˜ ë²„í…¨ì£¼ë©´
0.86ê¹Œì§€ëŠ” ë§ˆêµ¬ë§ˆêµ¬ ì˜¬ë¦´ìˆ˜ ìˆìŒ. 

 ì´ê²ƒì´ ë°”ë¡œ VDCNNì´</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë°ì´ì½˜-ë„ì „-í›„ê¸°"><a href="#ë°ì´ì½˜-ë„ì „-í›„ê¸°" class="headerlink" title="ë°ì´ì½˜ ë„ì „ í›„ê¸°"></a>ë°ì´ì½˜ ë„ì „ í›„ê¸°</h2><p>  í¥ë¯¸ë¡­ì§€ë§Œ ì‰½ì§€ëŠ” ì•Šë‹¤.<br>  ë§ ê·¸ëŒ€ë¡œ ìƒˆë¡œìš´ íŒŒìƒë³€ìˆ˜, ëª¨ë¸ì„ ë§ì´ ë§Œë“¤ë©´ ì ìˆ˜ê°€ ì˜¤ë¥´ê¸´ í•œë‹¤.</p><p>  <a href="https://dacon.io/competitions/open/235597/leaderboard/">ë°ì´ì½˜_ì—°ìŠµë¬¸ì œ</a></p><p>  ì—°ìŠµìš©ì´ê¸´ í•œë° BERTëª¨ë¸ í­ê²©ìœ¼ë¡œ <del>ì–‘ë¯¼í•™ì‚´</del> ì´ ë²Œì¨ë¶€í„° ì‹œì‘ë˜ì—ˆâ€¦ã…ã„·ã„·</p><p>  ë²„íŠ¸ëª¨ë¸ ì•ˆì“°ê³ ë„ ìˆœìœ„ ì˜¬ë¦´ìˆ˜ëŠ” ìˆë‹¤. </p><p>  ì§€ê¸ˆë¶€í„° ê·¸ ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.</p><h3 id="ë°ì´ì½˜-ìˆœìœ„ë¥¼-ì˜¬ë¦´ìˆ˜-ìˆëŠ”-ë°©ë²•-ì°½ì˜ì ì¸-modeling-K-cross-Validation-parameter-searching"><a href="#ë°ì´ì½˜-ìˆœìœ„ë¥¼-ì˜¬ë¦´ìˆ˜-ìˆëŠ”-ë°©ë²•-ì°½ì˜ì ì¸-modeling-K-cross-Validation-parameter-searching" class="headerlink" title="ë°ì´ì½˜ ìˆœìœ„ë¥¼ ì˜¬ë¦´ìˆ˜ ìˆëŠ” ë°©ë²• - ì°½ì˜ì ì¸ modeling, K-cross Validation, parameter searching"></a>ë°ì´ì½˜ ìˆœìœ„ë¥¼ ì˜¬ë¦´ìˆ˜ ìˆëŠ” ë°©ë²• - ì°½ì˜ì ì¸ modeling, K-cross Validation, parameter searching</h3><p>  <img src="/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/vdcnn_1.PNG" alt="ì´ê²ƒì´ ë°”ë¡œ VDCNN">  </p><p>  VDCNNì€ GPUê°€ ì˜ ë²„í…¨ì£¼ë©´<br>  0.86ê¹Œì§€ëŠ” ë§ˆêµ¬ë§ˆêµ¬ ì˜¬ë¦´ìˆ˜ ìˆìŒ.  </p><p>  ì´ê²ƒì´ ë°”ë¡œ VDCNNì´ë‹¹!<br>  <a href="https://github.com/ikarus-999/VDCNN_kor"><img src="/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/vdcnn_5.PNG" alt="VDCNN code"></a></p><p>  <img src="/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/vdcnn_9.PNG" alt="VDCNN í•™ìŠµì¥ë©´"></p><p>  í•™ìŠµ ëª¨ë¸ì„ ê·¸ë¦¼ìœ¼ë¡œ ë³´ê¸°</p><p>  <img src="/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/output_36_0.png" alt="VDCNN ê·¸ë¦¼1"></p><p>  <img src="/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/Dacon01.PNG" alt="ë°ì´ì½˜ ê²°ê³¼"><br>  ì—¬ê¸°ì— ì—¬ëŸ¬ ê°€ì§€ ëª¨ë¸ Ensemble í•´ë³´ë©´ 0.88ì€ ê°€ëŠ¥í•´ë³´ì¼ ê²ƒ ê°™ë„¤ìš”.</p><blockquote><p>ì¶”ê°€ë¡œ ëª¨ë¸ Ensemble ì„ ì‹œë„<br>  <img src="/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/output_43_0.png" alt="ì¶”ê°€í–ˆë˜ ëª¨ë¸1"><br>  <img src="/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/output_50_0.png" alt="ì¶”ê°€í–ˆë˜ ëª¨ë¸2"><br>  <img src="/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/output_57_0.png" alt="ì¶”ê°€í–ˆë˜ ëª¨ë¸3"></p></blockquote><blockquote><p>ì¶”ê°€ì ìœ¼ë¡œ íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ë§..(2020-12-09 ì¶”ê°€â€¦)<br>  <a href="https://github.com/ikarus-999/VDCNN_kor/blob/master/TF2_kor_2.0.ipynb">Transformer</a></p></blockquote>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/Kaggle-Dacon/">Kaggle, Dacon</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/Dacon/">Dacon</category>
      
      <category domain="https://ikarus-999.github.io/tags/Try/">Try</category>
      
      
      <comments>https://ikarus-999.github.io/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>kaggle_try</title>
      <link>https://ikarus-999.github.io/2020/12/06/kaggle-try/</link>
      <guid>https://ikarus-999.github.io/2020/12/06/kaggle-try/</guid>
      <pubDate>Sun, 06 Dec 2020 06:56:21 GMT</pubDate>
      
      <description>ë‚¨ë“¤ì´ ì˜ ì•ˆí•˜ëŠ” ë°ì´í„°ì…‹ìœ¼ë¡œ ìºê¸€ ë„ì „ í›„ê¸°
 ë°ì´í„°ì…‹ ë§í¬ :
https://www.kaggle.com/c/LANL-Earthquake-Prediction

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16


from tqdm import tqdm
import pandas as pd
import numpy as np

import tensorflow as tf
import tensorflow.keras.backend as K
from tensorflow.keras import metrics
from tens</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë‚¨ë“¤ì´-ì˜-ì•ˆí•˜ëŠ”-ë°ì´í„°ì…‹ìœ¼ë¡œ-ìºê¸€-ë„ì „-í›„ê¸°"><a href="#ë‚¨ë“¤ì´-ì˜-ì•ˆí•˜ëŠ”-ë°ì´í„°ì…‹ìœ¼ë¡œ-ìºê¸€-ë„ì „-í›„ê¸°" class="headerlink" title="ë‚¨ë“¤ì´ ì˜ ì•ˆí•˜ëŠ” ë°ì´í„°ì…‹ìœ¼ë¡œ ìºê¸€ ë„ì „ í›„ê¸°"></a>ë‚¨ë“¤ì´ ì˜ ì•ˆí•˜ëŠ” ë°ì´í„°ì…‹ìœ¼ë¡œ ìºê¸€ ë„ì „ í›„ê¸°</h2><p>  ë°ì´í„°ì…‹ ë§í¬ :<br>  <a href="https://www.kaggle.com/c/LANL-Earthquake-Prediction">https://www.kaggle.com/c/LANL-Earthquake-Prediction</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> tensorflow.keras.backend <span class="keyword">as</span> K</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> metrics</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.callbacks <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.initializers <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> random, sys</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pd.set_option(<span class="string">&#x27;precision&#x27;</span>, <span class="number">30</span>)</span><br><span class="line">np.set_printoptions(precision = <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">np.random.seed(<span class="number">47</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%%time</span><br><span class="line">train_df = pd.read_csv(<span class="string">&#x27;./train.csv&#x27;</span>, dtype=&#123;<span class="string">&#x27;acoustic_data&#x27;</span>: np.int8, <span class="string">&#x27;time_to_failure&#x27;</span>: np.float32&#125;)</span><br></pre></td></tr></table></figure><pre><code>CPU times: user 1min 30s, sys: 19.1 s, total: 1min 49sWall time: 1min 49s</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X_train = train_df[<span class="string">&#x27;acoustic_data&#x27;</span>].values</span><br><span class="line">y_train = train_df[<span class="string">&#x27;time_to_failure&#x27;</span>].values</span><br></pre></td></tr></table></figure><h3 id="Training-dataì—ì„œ-ì™„ì „í•œ-ë°ì´í„°-êµ¬ê°„-ì°¾ê¸°-0ì—-ê·¼ì ‘í•œ-failure-time-ì°¾ê¸°"><a href="#Training-dataì—ì„œ-ì™„ì „í•œ-ë°ì´í„°-êµ¬ê°„-ì°¾ê¸°-0ì—-ê·¼ì ‘í•œ-failure-time-ì°¾ê¸°" class="headerlink" title="Training dataì—ì„œ ì™„ì „í•œ ë°ì´í„° êµ¬ê°„ ì°¾ê¸°(0ì— ê·¼ì ‘í•œ  failure time ì°¾ê¸°)"></a>Training dataì—ì„œ ì™„ì „í•œ ë°ì´í„° êµ¬ê°„ ì°¾ê¸°(0ì— ê·¼ì ‘í•œ  failure time ì°¾ê¸°)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ends_mask = np.less(y_train[:<span class="number">-1</span>], y_train[<span class="number">1</span>:])</span><br><span class="line">segment_ends = np.nonzero(ends_mask)</span><br><span class="line"></span><br><span class="line">train_segments = []</span><br><span class="line">start = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> end <span class="keyword">in</span> segment_ends[<span class="number">0</span>]:</span><br><span class="line">    train_segments.append((start, end))</span><br><span class="line">    start = end</span><br><span class="line">    </span><br><span class="line">print(train_segments)</span><br></pre></td></tr></table></figure><pre><code>[(0, 5656573), (5656573, 50085877), (50085877, 104677355), (104677355, 138772452), (138772452, 187641819), (187641819, 218652629), (218652629, 245829584), (245829584, 307838916), (307838916, 338276286), (338276286, 375377847), (375377847, 419368879), (419368879, 461811622), (461811622, 495800224), (495800224, 528777114), (528777114, 585568143), (585568143, 621985672)]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.set_title(<span class="string">&#x27;segment size&#x27;</span>)</span><br><span class="line">ax.bar(np.arange(<span class="built_in">len</span>(train_segments)), [ s[<span class="number">1</span>] - s[<span class="number">0</span>] <span class="keyword">for</span> s <span class="keyword">in</span> train_segments])</span><br></pre></td></tr></table></figure><pre><code>&lt;BarContainer object of 16 artists&gt;</code></pre><p><img src="/2020/12/06/kaggle-try/output_6_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EarthQuakeRandom</span>(<span class="params">tf.keras.utils.Sequence</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x, y, x_mean, x_std, segments, ts_length, batch_size, steps_per_epoch</span>):</span></span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line">        self.segments = segments</span><br><span class="line">        self.ts_length = ts_length</span><br><span class="line">        self.batch_size = batch_size</span><br><span class="line">        self.steps_per_epoch = steps_per_epoch</span><br><span class="line">        self.segments_size = np.array([s[<span class="number">1</span>] - s[<span class="number">0</span>] <span class="keyword">for</span> s <span class="keyword">in</span> segments])</span><br><span class="line">        self.segments_p = self.segments_size / self.segments_size.<span class="built_in">sum</span>()</span><br><span class="line">        self.x_mean = x_mean</span><br><span class="line">        self.x_std = x_std</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_batch_size</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.batch_size</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_ts_length</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.ts_length</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_segments</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.segments</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_segments_p</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.segments_p</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_segments_size</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.segments_size</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__len__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.steps_per_epoch</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span>(<span class="params">self, idx</span>):</span></span><br><span class="line">        segment_index = np.random.choice(<span class="built_in">range</span>(<span class="built_in">len</span>(self.segments)), p=self.segments_p)</span><br><span class="line">        segment = self.segments[segment_index]</span><br><span class="line">        end_indexes = np.random.randint(segment[<span class="number">0</span>] + self.ts_length, segment[<span class="number">1</span>], size=self.batch_size)</span><br><span class="line"></span><br><span class="line">        x_batch = np.empty((self.batch_size, self.ts_length))</span><br><span class="line">        y_batch = np.empty(self.batch_size, )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i, end <span class="keyword">in</span> <span class="built_in">enumerate</span>(end_indexes):</span><br><span class="line">            x_batch[i, :] = self.x[end - self.ts_length: end]</span><br><span class="line">            y_batch[i] = self.y[end - <span class="number">1</span>]</span><br><span class="line">            </span><br><span class="line">        <span class="comment">#x_batch = (x_batch - self.x_mean)/self.x_std</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> np.expand_dims(x_batch, axis=<span class="number">2</span>), y_batch</span><br></pre></td></tr></table></figure><h3 id="train-validation-ë‚˜ëˆ„ê¸°-segments"><a href="#train-validation-ë‚˜ëˆ„ê¸°-segments" class="headerlink" title="train / validation ë‚˜ëˆ„ê¸°(segments)"></a>train / validation ë‚˜ëˆ„ê¸°(segments)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">t_segments = [train_segments[i] <span class="keyword">for</span> i <span class="keyword">in</span> [ <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]]</span><br><span class="line">v_segments = [train_segments[i] <span class="keyword">for</span> i <span class="keyword">in</span> [ <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]]</span><br></pre></td></tr></table></figure><h3 id="training-dataì—-ëŒ€í•´ì„œë§Œ-í‰ê· ê³¼-í‘œì¤€í¸ì°¨-ê³„ì‚°"><a href="#training-dataì—-ëŒ€í•´ì„œë§Œ-í‰ê· ê³¼-í‘œì¤€í¸ì°¨-ê³„ì‚°" class="headerlink" title="training dataì— ëŒ€í•´ì„œë§Œ í‰ê· ê³¼ í‘œì¤€í¸ì°¨ ê³„ì‚°"></a>training dataì— ëŒ€í•´ì„œë§Œ í‰ê· ê³¼ í‘œì¤€í¸ì°¨ ê³„ì‚°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">x_sum = <span class="number">0.</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> t_segments:</span><br><span class="line">    x_sum += X_train[s[<span class="number">0</span>]:s[<span class="number">1</span>]].<span class="built_in">sum</span>()</span><br><span class="line">    count += (s[<span class="number">1</span>] - s[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">X_train_mean = x_sum/count</span><br><span class="line"></span><br><span class="line">x2_sum = <span class="number">0.</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> t_segments:</span><br><span class="line">    x2_sum += np.power(X_train[s[<span class="number">0</span>]:s[<span class="number">1</span>]] - X_train_mean, <span class="number">2</span>).<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line">X_train_std =  np.sqrt(x2_sum/count)</span><br><span class="line"></span><br><span class="line">print(X_train_mean, X_train_std)</span><br></pre></td></tr></table></figure><pre><code>4.472289301190891 6.189013535612676</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">train_gen = EarthQuakeRandom(</span><br><span class="line">    x = X_train, </span><br><span class="line">    y = y_train,</span><br><span class="line">    x_mean = X_train_mean, </span><br><span class="line">    x_std = X_train_std,</span><br><span class="line">    segments = t_segments,</span><br><span class="line">    ts_length = <span class="number">150000</span>,</span><br><span class="line">    batch_size = <span class="number">64</span>,</span><br><span class="line">    steps_per_epoch = <span class="number">400</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">valid_gen = EarthQuakeRandom(</span><br><span class="line">    x = X_train, </span><br><span class="line">    y = y_train,</span><br><span class="line">    x_mean = X_train_mean, </span><br><span class="line">    x_std = X_train_std,</span><br><span class="line">    segments = v_segments,</span><br><span class="line">    ts_length = <span class="number">150000</span>,</span><br><span class="line">    batch_size = <span class="number">64</span>,</span><br><span class="line">    steps_per_epoch = <span class="number">400</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://www.kaggle.com/shujian/transformer-with-lstm</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">from</span> dataloader <span class="keyword">import</span> TokenList, pad_to_longest</span><br><span class="line">    <span class="comment"># for transformer</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">embed_size = <span class="number">60</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LayerNormalization</span>(<span class="params">Layer</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, eps=<span class="number">1e-6</span>, **kwargs</span>):</span></span><br><span class="line">        self.eps = eps</span><br><span class="line">        <span class="built_in">super</span>(LayerNormalization, self).__init__(**kwargs)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build</span>(<span class="params">self, input_shape</span>):</span></span><br><span class="line">        self.gamma = self.add_weight(name=<span class="string">&#x27;gamma&#x27;</span>, shape=input_shape[<span class="number">-1</span>:],</span><br><span class="line">                                     initializer=Ones(), trainable=<span class="literal">True</span>)</span><br><span class="line">        self.beta = self.add_weight(name=<span class="string">&#x27;beta&#x27;</span>, shape=input_shape[<span class="number">-1</span>:],</span><br><span class="line">                                    initializer=Zeros(), trainable=<span class="literal">True</span>)</span><br><span class="line">        <span class="built_in">super</span>(LayerNormalization, self).build(input_shape)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        mean = K.mean(x, axis=<span class="number">-1</span>, keepdims=<span class="literal">True</span>)</span><br><span class="line">        std = K.std(x, axis=<span class="number">-1</span>, keepdims=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> self.gamma * (x - mean) / (std + self.eps) + self.beta</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">compute_output_shape</span>(<span class="params">self, input_shape</span>):</span></span><br><span class="line">        <span class="keyword">return</span> input_shape</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ScaledDotProductAttention</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, d_model, attn_dropout=<span class="number">0.1</span></span>):</span></span><br><span class="line">        self.temper = np.sqrt(d_model)</span><br><span class="line">        self.dropout = Dropout(attn_dropout)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, q, k, v, mask</span>):</span></span><br><span class="line">        attn = Lambda(<span class="keyword">lambda</span> x:K.batch_dot(x[<span class="number">0</span>],x[<span class="number">1</span>],axes=[<span class="number">2</span>,<span class="number">2</span>])/self.temper)([q, k])</span><br><span class="line">        <span class="keyword">if</span> mask <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            mmask = Lambda(<span class="keyword">lambda</span> x:(<span class="number">-1e+10</span>)*(<span class="number">1</span>-x))(mask)</span><br><span class="line">            attn = Add()([attn, mmask])</span><br><span class="line">        attn = Activation(<span class="string">&#x27;softmax&#x27;</span>)(attn)</span><br><span class="line">        attn = self.dropout(attn)</span><br><span class="line">        output = Lambda(<span class="keyword">lambda</span> x:K.batch_dot(x[<span class="number">0</span>], x[<span class="number">1</span>]))([attn, v])</span><br><span class="line">        <span class="keyword">return</span> output, attn</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MultiHeadAttention</span>():</span></span><br><span class="line">    <span class="comment"># mode 0 - big martixes, faster; mode 1 - more clear implementation</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, n_head, d_model, d_k, d_v, dropout, mode=<span class="number">0</span>, use_norm=<span class="literal">True</span></span>):</span></span><br><span class="line">        self.mode = mode</span><br><span class="line">        self.n_head = n_head</span><br><span class="line">        self.d_k = d_k</span><br><span class="line">        self.d_v = d_v</span><br><span class="line">        self.dropout = dropout</span><br><span class="line">        <span class="keyword">if</span> mode == <span class="number">0</span>:</span><br><span class="line">            self.qs_layer = Dense(n_head*d_k, use_bias=<span class="literal">False</span>)</span><br><span class="line">            self.ks_layer = Dense(n_head*d_k, use_bias=<span class="literal">False</span>)</span><br><span class="line">            self.vs_layer = Dense(n_head*d_v, use_bias=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">elif</span> mode == <span class="number">1</span>:</span><br><span class="line">            self.qs_layers = []</span><br><span class="line">            self.ks_layers = []</span><br><span class="line">            self.vs_layers = []</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n_head):</span><br><span class="line">                self.qs_layers.append(TimeDistributed(Dense(d_k, use_bias=<span class="literal">False</span>)))</span><br><span class="line">                self.ks_layers.append(TimeDistributed(Dense(d_k, use_bias=<span class="literal">False</span>)))</span><br><span class="line">                self.vs_layers.append(TimeDistributed(Dense(d_v, use_bias=<span class="literal">False</span>)))</span><br><span class="line">        self.attention = ScaledDotProductAttention(d_model)</span><br><span class="line">        self.layer_norm = LayerNormalization() <span class="keyword">if</span> use_norm <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">        self.w_o = TimeDistributed(Dense(d_model))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, q, k, v, mask=<span class="literal">None</span></span>):</span></span><br><span class="line">        d_k, d_v = self.d_k, self.d_v</span><br><span class="line">        n_head = self.n_head</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.mode == <span class="number">0</span>:</span><br><span class="line">            qs = self.qs_layer(q)  <span class="comment"># [batch_size, len_q, n_head*d_k]</span></span><br><span class="line">            ks = self.ks_layer(k)</span><br><span class="line">            vs = self.vs_layer(v)</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">reshape1</span>(<span class="params">x</span>):</span></span><br><span class="line">                s = tf.shape(x)   <span class="comment"># [batch_size, len_q, n_head * d_k]</span></span><br><span class="line">                x = tf.reshape(x, [s[<span class="number">0</span>], s[<span class="number">1</span>], n_head, d_k])</span><br><span class="line">                x = tf.transpose(x, [<span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>])  </span><br><span class="line">                x = tf.reshape(x, [<span class="number">-1</span>, s[<span class="number">1</span>], d_k])  <span class="comment"># [n_head * batch_size, len_q, d_k]</span></span><br><span class="line">                <span class="keyword">return</span> x</span><br><span class="line">            qs = Lambda(reshape1)(qs)</span><br><span class="line">            ks = Lambda(reshape1)(ks)</span><br><span class="line">            vs = Lambda(reshape1)(vs)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> mask <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                mask = Lambda(<span class="keyword">lambda</span> x:K.repeat_elements(x, n_head, <span class="number">0</span>))(mask)</span><br><span class="line">            head, attn = self.attention(qs, ks, vs, mask=mask)  </span><br><span class="line">                </span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">reshape2</span>(<span class="params">x</span>):</span></span><br><span class="line">                s = tf.shape(x)   <span class="comment"># [n_head * batch_size, len_v, d_v]</span></span><br><span class="line">                x = tf.reshape(x, [n_head, <span class="number">-1</span>, s[<span class="number">1</span>], s[<span class="number">2</span>]]) </span><br><span class="line">                x = tf.transpose(x, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">3</span>])</span><br><span class="line">                x = tf.reshape(x, [<span class="number">-1</span>, s[<span class="number">1</span>], n_head*d_v])  <span class="comment"># [batch_size, len_v, n_head * d_v]</span></span><br><span class="line">                <span class="keyword">return</span> x</span><br><span class="line">            head = Lambda(reshape2)(head)</span><br><span class="line">        <span class="keyword">elif</span> self.mode == <span class="number">1</span>:</span><br><span class="line">            heads = []; attns = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n_head):</span><br><span class="line">                qs = self.qs_layers[i](q)   </span><br><span class="line">                ks = self.ks_layers[i](k) </span><br><span class="line">                vs = self.vs_layers[i](v) </span><br><span class="line">                head, attn = self.attention(qs, ks, vs, mask)</span><br><span class="line">                heads.append(head); attns.append(attn)</span><br><span class="line">            head = Concatenate()(heads) <span class="keyword">if</span> n_head &gt; <span class="number">1</span> <span class="keyword">else</span> heads[<span class="number">0</span>]</span><br><span class="line">            attn = Concatenate()(attns) <span class="keyword">if</span> n_head &gt; <span class="number">1</span> <span class="keyword">else</span> attns[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        outputs = self.w_o(head)</span><br><span class="line">        outputs = Dropout(self.dropout)(outputs)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.layer_norm: <span class="keyword">return</span> outputs, attn</span><br><span class="line">        <span class="comment"># outputs = Add()([outputs, q]) # sl: fix</span></span><br><span class="line">        <span class="keyword">return</span> self.layer_norm(outputs), attn</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PositionwiseFeedForward</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, d_hid, d_inner_hid, dropout=<span class="number">0.1</span></span>):</span></span><br><span class="line">        self.w_1 = Conv1D(d_inner_hid, <span class="number">1</span>, activation=<span class="string">&#x27;relu&#x27;</span>)</span><br><span class="line">        self.w_2 = Conv1D(d_hid, <span class="number">1</span>)</span><br><span class="line">        self.layer_norm = LayerNormalization()</span><br><span class="line">        self.dropout = Dropout(dropout)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        output = self.w_1(x) </span><br><span class="line">        output = self.w_2(output)</span><br><span class="line">        output = self.dropout(output)</span><br><span class="line">        output = Add()([output, x])</span><br><span class="line">        <span class="keyword">return</span> self.layer_norm(output)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EncoderLayer</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, d_model, d_inner_hid, n_head, d_k, d_v, dropout=<span class="number">0.1</span></span>):</span></span><br><span class="line">        self.self_att_layer = MultiHeadAttention(n_head, d_model, d_k, d_v, dropout=dropout)</span><br><span class="line">        self.pos_ffn_layer  = PositionwiseFeedForward(d_model, d_inner_hid, dropout=dropout)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, enc_input, mask=<span class="literal">None</span></span>):</span></span><br><span class="line">        output, slf_attn = self.self_att_layer(enc_input, enc_input, enc_input, mask=mask)</span><br><span class="line">        output = self.pos_ffn_layer(output)</span><br><span class="line">        <span class="keyword">return</span> output, slf_attn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetPosEncodingMatrix</span>(<span class="params">max_len, d_emb</span>):</span></span><br><span class="line">    pos_enc = np.array([</span><br><span class="line">        [pos / np.power(<span class="number">10000</span>, <span class="number">2</span> * (j // <span class="number">2</span>) / d_emb) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(d_emb)] </span><br><span class="line">        <span class="keyword">if</span> pos != <span class="number">0</span> <span class="keyword">else</span> np.zeros(d_emb) </span><br><span class="line">            <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(max_len)</span><br><span class="line">            ])</span><br><span class="line">    pos_enc[<span class="number">1</span>:, <span class="number">0</span>::<span class="number">2</span>] = np.sin(pos_enc[<span class="number">1</span>:, <span class="number">0</span>::<span class="number">2</span>]) <span class="comment"># dim 2i</span></span><br><span class="line">    pos_enc[<span class="number">1</span>:, <span class="number">1</span>::<span class="number">2</span>] = np.cos(pos_enc[<span class="number">1</span>:, <span class="number">1</span>::<span class="number">2</span>]) <span class="comment"># dim 2i+1</span></span><br><span class="line">    <span class="keyword">return</span> pos_enc</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetPadMask</span>(<span class="params">q, k</span>):</span></span><br><span class="line">    ones = K.expand_dims(K.ones_like(q, <span class="string">&#x27;float32&#x27;</span>), <span class="number">-1</span>)</span><br><span class="line">    mask = K.cast(K.expand_dims(K.not_equal(k, <span class="number">0</span>), <span class="number">1</span>), <span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line">    mask = K.batch_dot(ones, mask, axes=[<span class="number">2</span>,<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> mask</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetSubMask</span>(<span class="params">s</span>):</span></span><br><span class="line">    len_s = tf.shape(s)[<span class="number">1</span>]</span><br><span class="line">    bs = tf.shape(s)[:<span class="number">1</span>]</span><br><span class="line">    mask = K.cumsum(tf.eye(len_s, batch_shape=bs), <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> mask</span><br></pre></td></tr></table></figure><pre><code>No module named &#39;dataloader&#39;</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CnnTransformerModel</span>():</span></span><br><span class="line">    i = Input(shape = (<span class="number">150000</span>, <span class="number">1</span>))</span><br><span class="line">    </span><br><span class="line">    x = BatchNormalization(axis=<span class="number">-1</span>, momentum=<span class="number">0.99</span>, epsilon=<span class="number">0.001</span>, center=<span class="literal">True</span>, scale=<span class="literal">True</span>, beta_initializer=<span class="string">&#x27;zeros&#x27;</span>, gamma_initializer=<span class="string">&#x27;ones&#x27;</span>, moving_mean_initializer=<span class="string">&#x27;zeros&#x27;</span>, moving_variance_initializer=<span class="string">&#x27;ones&#x27;</span>, beta_regularizer=<span class="literal">None</span>, gamma_regularizer=<span class="literal">None</span>, beta_constraint=<span class="literal">None</span>, gamma_constraint=<span class="literal">None</span>)(i)</span><br><span class="line"></span><br><span class="line">    x = Convolution1D( <span class="number">8</span>, kernel_size = <span class="number">10</span>, strides = <span class="number">10</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">    </span><br><span class="line">    x = BatchNormalization(axis=<span class="number">-1</span>, momentum=<span class="number">0.99</span>, epsilon=<span class="number">0.001</span>, center=<span class="literal">True</span>, scale=<span class="literal">True</span>, beta_initializer=<span class="string">&#x27;zeros&#x27;</span>, gamma_initializer=<span class="string">&#x27;ones&#x27;</span>, moving_mean_initializer=<span class="string">&#x27;zeros&#x27;</span>, moving_variance_initializer=<span class="string">&#x27;ones&#x27;</span>, beta_regularizer=<span class="literal">None</span>, gamma_regularizer=<span class="literal">None</span>, beta_constraint=<span class="literal">None</span>, gamma_constraint=<span class="literal">None</span>)(x)</span><br><span class="line"></span><br><span class="line">    x = Convolution1D(<span class="number">16</span>, kernel_size = <span class="number">10</span>, strides = <span class="number">10</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">    </span><br><span class="line">    x = BatchNormalization(axis=<span class="number">-1</span>, momentum=<span class="number">0.99</span>, epsilon=<span class="number">0.001</span>, center=<span class="literal">True</span>, scale=<span class="literal">True</span>, beta_initializer=<span class="string">&#x27;zeros&#x27;</span>, gamma_initializer=<span class="string">&#x27;ones&#x27;</span>, moving_mean_initializer=<span class="string">&#x27;zeros&#x27;</span>, moving_variance_initializer=<span class="string">&#x27;ones&#x27;</span>, beta_regularizer=<span class="literal">None</span>, gamma_regularizer=<span class="literal">None</span>, beta_constraint=<span class="literal">None</span>, gamma_constraint=<span class="literal">None</span>)(x)</span><br><span class="line"></span><br><span class="line">    x = Convolution1D(<span class="number">32</span>, kernel_size = <span class="number">10</span>, strides = <span class="number">10</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">    </span><br><span class="line">    x = BatchNormalization(axis=<span class="number">-1</span>, momentum=<span class="number">0.99</span>, epsilon=<span class="number">0.001</span>, center=<span class="literal">True</span>, scale=<span class="literal">True</span>, beta_initializer=<span class="string">&#x27;zeros&#x27;</span>, gamma_initializer=<span class="string">&#x27;ones&#x27;</span>, moving_mean_initializer=<span class="string">&#x27;zeros&#x27;</span>, moving_variance_initializer=<span class="string">&#x27;ones&#x27;</span>, beta_regularizer=<span class="literal">None</span>, gamma_regularizer=<span class="literal">None</span>, beta_constraint=<span class="literal">None</span>, gamma_constraint=<span class="literal">None</span>)(x)</span><br><span class="line"></span><br><span class="line">    x = Convolution1D(<span class="number">64</span>, kernel_size = <span class="number">10</span>, strides = <span class="number">10</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line"></span><br><span class="line">    x = Bidirectional(LSTM(<span class="number">128</span>, return_sequences = <span class="literal">True</span>, return_state = <span class="literal">False</span>))(x)</span><br><span class="line">    </span><br><span class="line">    x = Bidirectional(LSTM(<span class="number">64</span>, return_sequences = <span class="literal">True</span>, return_state = <span class="literal">False</span>))(x)</span><br><span class="line">    </span><br><span class="line">    x, slf_attn = MultiHeadAttention(n_head=<span class="number">5</span>, d_model=<span class="number">300</span>, d_k=<span class="number">64</span>, d_v=<span class="number">64</span>, dropout=<span class="number">0.3</span>)(x, x, x)</span><br><span class="line">    </span><br><span class="line">    avg_pool = GlobalAveragePooling1D()(x)</span><br><span class="line">    </span><br><span class="line">    avg_pool = Dense(<span class="number">60</span>,activation = <span class="string">&#x27;relu&#x27;</span>)(avg_pool)</span><br><span class="line">    </span><br><span class="line">    y = Dense(<span class="number">1</span>,activation = <span class="string">&#x27;relu&#x27;</span>)(avg_pool)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Model(inputs = [i], outputs = [y])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">model = CnnTransformerModel()</span><br><span class="line">model.<span class="built_in">compile</span>(loss=<span class="string">&#x27;mean_squared_error&#x27;</span>, optimizer=<span class="string">&#x27;adam&#x27;</span>,metrics = [<span class="string">&#x27;mean_absolute_error&#x27;</span>])</span><br><span class="line">model.summary()</span><br></pre></td></tr></table></figure><pre><code>Model: &quot;model&quot;__________________________________________________________________________________________________Layer (type)                    Output Shape         Param #     Connected to                     ==================================================================================================input_1 (InputLayer)            [(None, 150000, 1)]  0                                            __________________________________________________________________________________________________batch_normalization (BatchNorma (None, 150000, 1)    4           input_1[0][0]                    __________________________________________________________________________________________________conv1d (Conv1D)                 (None, 15000, 8)     88          batch_normalization[0][0]        __________________________________________________________________________________________________batch_normalization_1 (BatchNor (None, 15000, 8)     32          conv1d[0][0]                     __________________________________________________________________________________________________conv1d_1 (Conv1D)               (None, 1500, 16)     1296        batch_normalization_1[0][0]      __________________________________________________________________________________________________batch_normalization_2 (BatchNor (None, 1500, 16)     64          conv1d_1[0][0]                   __________________________________________________________________________________________________conv1d_2 (Conv1D)               (None, 150, 32)      5152        batch_normalization_2[0][0]      __________________________________________________________________________________________________batch_normalization_3 (BatchNor (None, 150, 32)      128         conv1d_2[0][0]                   __________________________________________________________________________________________________conv1d_3 (Conv1D)               (None, 15, 64)       20544       batch_normalization_3[0][0]      __________________________________________________________________________________________________bidirectional (Bidirectional)   (None, 15, 256)      197632      conv1d_3[0][0]                   __________________________________________________________________________________________________bidirectional_1 (Bidirectional) (None, 15, 128)      164352      bidirectional[0][0]              __________________________________________________________________________________________________dense (Dense)                   (None, 15, 320)      40960       bidirectional_1[0][0]            __________________________________________________________________________________________________dense_1 (Dense)                 (None, 15, 320)      40960       bidirectional_1[0][0]            __________________________________________________________________________________________________lambda (Lambda)                 (None, None, 64)     0           dense[0][0]                      __________________________________________________________________________________________________lambda_1 (Lambda)               (None, None, 64)     0           dense_1[0][0]                    __________________________________________________________________________________________________lambda_3 (Lambda)               (None, None, None)   0           lambda[0][0]                                                                                      lambda_1[0][0]                   __________________________________________________________________________________________________activation (Activation)         (None, None, None)   0           lambda_3[0][0]                   __________________________________________________________________________________________________dense_2 (Dense)                 (None, 15, 320)      40960       bidirectional_1[0][0]            __________________________________________________________________________________________________dropout (Dropout)               (None, None, None)   0           activation[0][0]                 __________________________________________________________________________________________________lambda_2 (Lambda)               (None, None, 64)     0           dense_2[0][0]                    __________________________________________________________________________________________________lambda_4 (Lambda)               (None, None, 64)     0           dropout[0][0]                                                                                     lambda_2[0][0]                   __________________________________________________________________________________________________lambda_5 (Lambda)               (None, None, 320)    0           lambda_4[0][0]                   __________________________________________________________________________________________________time_distributed (TimeDistribut (None, None, 300)    96300       lambda_5[0][0]                   __________________________________________________________________________________________________dropout_1 (Dropout)             (None, None, 300)    0           time_distributed[0][0]           __________________________________________________________________________________________________layer_normalization (LayerNorma (None, None, 300)    600         dropout_1[0][0]                  __________________________________________________________________________________________________global_average_pooling1d (Globa (None, 300)          0           layer_normalization[0][0]        __________________________________________________________________________________________________dense_4 (Dense)                 (None, 60)           18060       global_average_pooling1d[0][0]   __________________________________________________________________________________________________dense_5 (Dense)                 (None, 1)            61          dense_4[0][0]                    ==================================================================================================Total params: 627,193Trainable params: 627,079Non-trainable params: 114__________________________________________________________________________________________________</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from IPython.display import SVG</span></span><br><span class="line"><span class="comment"># from keras.utils.vis_utils import model_to_dot</span></span><br><span class="line"><span class="comment"># SVG(model_to_dot(model,show_shapes = True).create(prog=&#x27;dot&#x27;, format=&#x27;svg&#x27;))</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">start_time = time.time()</span><br><span class="line">hist = model.fit(</span><br><span class="line">    train_gen,</span><br><span class="line">    epochs = <span class="number">25</span>, </span><br><span class="line">    verbose = <span class="number">1</span>,validation_data= valid_gen</span><br><span class="line">)</span><br><span class="line">print(<span class="string">&quot;--- %s seconds ---&quot;</span> % (time.time() - start_time))</span><br></pre></td></tr></table></figure><pre><code>Epoch 1/25400/400 [==============================] - 92s 230ms/step - loss: 8.1259 - mean_absolute_error: 2.1690 - val_loss: 8.6962 - val_mean_absolute_error: 2.2990Epoch 2/25400/400 [==============================] - 93s 232ms/step - loss: 6.8734 - mean_absolute_error: 1.9745 - val_loss: 10.5941 - val_mean_absolute_error: 2.5199Epoch 3/25400/400 [==============================] - 92s 231ms/step - loss: 6.2273 - mean_absolute_error: 1.8582 - val_loss: 8.3263 - val_mean_absolute_error: 2.1892Epoch 4/25400/400 [==============================] - 93s 232ms/step - loss: 6.3129 - mean_absolute_error: 1.8750 - val_loss: 7.2582 - val_mean_absolute_error: 2.1842Epoch 5/25400/400 [==============================] - 93s 232ms/step - loss: 6.1699 - mean_absolute_error: 1.8555 - val_loss: 10.6914 - val_mean_absolute_error: 2.5315Epoch 6/25400/400 [==============================] - 93s 232ms/step - loss: 6.3945 - mean_absolute_error: 1.8601 - val_loss: 17.6278 - val_mean_absolute_error: 3.4488Epoch 7/25400/400 [==============================] - 91s 228ms/step - loss: 5.9358 - mean_absolute_error: 1.7905 - val_loss: 7.1590 - val_mean_absolute_error: 2.0332Epoch 8/25400/400 [==============================] - 91s 227ms/step - loss: 5.8317 - mean_absolute_error: 1.7861 - val_loss: 7.4188 - val_mean_absolute_error: 2.0401Epoch 9/25400/400 [==============================] - 90s 226ms/step - loss: 6.0664 - mean_absolute_error: 1.8154 - val_loss: 11.4744 - val_mean_absolute_error: 2.6900Epoch 10/25400/400 [==============================] - 91s 228ms/step - loss: 5.6385 - mean_absolute_error: 1.7225 - val_loss: 6.3991 - val_mean_absolute_error: 1.9165Epoch 11/25400/400 [==============================] - 91s 228ms/step - loss: 5.7589 - mean_absolute_error: 1.7666 - val_loss: 14.0191 - val_mean_absolute_error: 2.8988Epoch 12/25400/400 [==============================] - 92s 229ms/step - loss: 5.3819 - mean_absolute_error: 1.6724 - val_loss: 7.1035 - val_mean_absolute_error: 2.1311Epoch 13/25400/400 [==============================] - 91s 227ms/step - loss: 5.5961 - mean_absolute_error: 1.7425 - val_loss: 14.4304 - val_mean_absolute_error: 2.9596Epoch 14/25400/400 [==============================] - 91s 227ms/step - loss: 5.3910 - mean_absolute_error: 1.6667 - val_loss: 7.3332 - val_mean_absolute_error: 2.1058Epoch 15/25400/400 [==============================] - 91s 228ms/step - loss: 5.3278 - mean_absolute_error: 1.6476 - val_loss: 8.5243 - val_mean_absolute_error: 2.1570Epoch 16/25400/400 [==============================] - 91s 227ms/step - loss: 5.1909 - mean_absolute_error: 1.6277 - val_loss: 10.1045 - val_mean_absolute_error: 2.4271Epoch 17/25400/400 [==============================] - 91s 228ms/step - loss: 5.5173 - mean_absolute_error: 1.6810 - val_loss: 7.0249 - val_mean_absolute_error: 2.0507Epoch 18/25400/400 [==============================] - 91s 228ms/step - loss: 4.8198 - mean_absolute_error: 1.5651 - val_loss: 9.4390 - val_mean_absolute_error: 2.4027Epoch 19/25400/400 [==============================] - 91s 228ms/step - loss: 5.0561 - mean_absolute_error: 1.6042 - val_loss: 6.4782 - val_mean_absolute_error: 1.9549Epoch 20/25400/400 [==============================] - 91s 227ms/step - loss: 4.9979 - mean_absolute_error: 1.5990 - val_loss: 7.7401 - val_mean_absolute_error: 2.0900Epoch 21/25400/400 [==============================] - 91s 227ms/step - loss: 5.0527 - mean_absolute_error: 1.6058 - val_loss: 12.2271 - val_mean_absolute_error: 2.7062Epoch 22/25400/400 [==============================] - 91s 227ms/step - loss: 4.1005 - mean_absolute_error: 1.4261 - val_loss: 7.2351 - val_mean_absolute_error: 2.0184Epoch 23/25400/400 [==============================] - 91s 227ms/step - loss: 5.1156 - mean_absolute_error: 1.6122 - val_loss: 6.6283 - val_mean_absolute_error: 1.9421Epoch 24/25400/400 [==============================] - 91s 228ms/step - loss: 5.0533 - mean_absolute_error: 1.6155 - val_loss: 14.7405 - val_mean_absolute_error: 3.0259Epoch 25/25400/400 [==============================] - 91s 228ms/step - loss: 5.0501 - mean_absolute_error: 1.6213 - val_loss: 12.0591 - val_mean_absolute_error: 2.6012--- 2297.5507295131683 seconds ---</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(hist.history[<span class="string">&#x27;loss&#x27;</span>])</span><br><span class="line">plt.plot(hist.history[<span class="string">&#x27;val_loss&#x27;</span>])</span><br><span class="line">plt.title(<span class="string">&#x27;Model MSE / Loss&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;MSE/Loss&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Epoch&#x27;</span>)</span><br><span class="line">plt.legend([<span class="string">&#x27;Train&#x27;</span>, <span class="string">&#x27;Test&#x27;</span>], loc=<span class="string">&#x27;upper left&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="/2020/12/06/kaggle-try/output_18_0.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(hist.history[<span class="string">&#x27;mean_absolute_error&#x27;</span>])</span><br><span class="line">plt.plot(hist.history[<span class="string">&#x27;val_mean_absolute_error&#x27;</span>])</span><br><span class="line">plt.title(<span class="string">&#x27;Model Mean Absolute Error&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;MAE&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Epoch&#x27;</span>)</span><br><span class="line">plt.legend([<span class="string">&#x27;Train&#x27;</span>, <span class="string">&#x27;Test&#x27;</span>], loc=<span class="string">&#x27;upper left&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="/2020/12/06/kaggle-try/output_19_0.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gc</span><br><span class="line"><span class="keyword">del</span> train_gen</span><br><span class="line"><span class="keyword">del</span> valid_gen</span><br><span class="line"><span class="keyword">del</span> X_train</span><br><span class="line"><span class="keyword">del</span> y_train</span><br><span class="line"><span class="keyword">del</span> train_df</span><br><span class="line">gc.collect()</span><br></pre></td></tr></table></figure><pre><code>6378</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.save_weights(<span class="string">&#x27;./trained_model.h5&#x27;</span>, overwrite=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> listdir, makedirs</span><br><span class="line"><span class="keyword">from</span> os.path <span class="keyword">import</span> isfile, join, basename, splitext, isfile, exists</span><br></pre></td></tr></table></figure><h2 id="Test-data-Normalize"><a href="#Test-data-Normalize" class="headerlink" title="Test data Normalize"></a>Test data Normalize</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_test</span>(<span class="params">ts_length = <span class="number">150000</span></span>):</span></span><br><span class="line">    base_dir = <span class="string">&#x27;./test/&#x27;</span></span><br><span class="line">    test_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> listdir(base_dir) <span class="keyword">if</span> isfile(join(base_dir, f))]</span><br><span class="line"></span><br><span class="line">    ts = np.empty([<span class="built_in">len</span>(test_files), ts_length])</span><br><span class="line">    ids = []</span><br><span class="line">    </span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> tqdm(test_files):</span><br><span class="line">        ids.append(splitext(f)[<span class="number">0</span>])</span><br><span class="line">        t_df = pd.read_csv(base_dir + f, dtype=&#123;<span class="string">&quot;acoustic_data&quot;</span>: np.int8&#125;)</span><br><span class="line">        ts[i, :] = t_df[<span class="string">&#x27;acoustic_data&#x27;</span>].values</span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ts, ids</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test_data, test_ids = load_test()</span><br></pre></td></tr></table></figure><pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2624/2624 [00:27&lt;00:00, 97.07it/s]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X_test = test_data</span><br><span class="line">X_test = np.expand_dims(X_test, <span class="number">2</span>)</span><br><span class="line">X_test.shape</span><br></pre></td></tr></table></figure><pre><code>(2624, 150000, 1)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_pred = model.predict(X_test)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">submission_df = pd.DataFrame(&#123;<span class="string">&#x27;seg_id&#x27;</span>: test_ids, <span class="string">&#x27;time_to_failure&#x27;</span>: y_pred[:, <span class="number">0</span>]&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">submission_df.to_csv(<span class="string">&quot;submission.csv&quot;</span>, index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h2 id="í›„ê¸°"><a href="#í›„ê¸°" class="headerlink" title="í›„ê¸°"></a>í›„ê¸°</h2><p>  <img src="/2020/12/06/kaggle-try/kaggle_1.PNG" alt="greem"></p><blockquote><p>ì‹œê³„ì—´ ë°ì´í„°ì…‹ì—ë‹¤ ë„ë€ìŠ¤í¬ë¨¸ í•´ë³´ë‹ˆ í• ë§Œ í•˜ì§€ë§Œ GPUê°€ ë²„í‹°ì§ˆ ëª»í•¨..</p></blockquote>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/Kaggle-Dacon/">Kaggle, Dacon</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/Try/">Try</category>
      
      <category domain="https://ikarus-999.github.io/tags/Kaggle/">Kaggle</category>
      
      
      <comments>https://ikarus-999.github.io/2020/12/06/kaggle-try/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ì°¸ê³ ë¦¬ìŠ¤íŠ¸</title>
      <link>https://ikarus-999.github.io/2020/12/06/%EC%B0%B8%EA%B3%A0%EB%A6%AC%EC%8A%A4%ED%8A%B8/</link>
      <guid>https://ikarus-999.github.io/2020/12/06/%EC%B0%B8%EA%B3%A0%EB%A6%AC%EC%8A%A4%ED%8A%B8/</guid>
      <pubDate>Sun, 06 Dec 2020 01:08:33 GMT</pubDate>
      
      <description>í…ì„œí”Œë¡œìš° ê°œë°œì— ì°¸ê³ í•  ë§Œí•œ ë¬¸ì„œë“¤(References)
Tensorflow Tutorial
 í…ì„œí”Œë¡œìš° íŠœí† ë¦¬ì–¼

ì‹œê³„ì—´ë°ì´í„° ìŠ¤í„°ë””ìë£Œ ëª¨ìŒ(Transformer)
 ì°¸ê³ ë…¼ë¬¸1
ë‘˜ëŸ¬ë³¼ë§Œí•œ ê¹ƒí—™
ë‘˜ëŸ¬ë³¼ë§Œí•œ ê¹ƒí—™2
ê¹ƒí—™ ë§í¬2

ìŒì„± ìì—°ì–´ì²˜ë¦¬ ìŠ¤í„°ë””ìë£Œ ëª¨ìŒ
 TacoTron Tensorflow
ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ ì°¸ê³ ìë£Œ best
VGGish
kaggle Dataset

ê³„ì† ì—…ë°ì´íŠ¸ ì˜ˆì • ì…ë‹ˆë‹¤.</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="í…ì„œí”Œë¡œìš°-ê°œë°œì—-ì°¸ê³ í• -ë§Œí•œ-ë¬¸ì„œë“¤-References"><a href="#í…ì„œí”Œë¡œìš°-ê°œë°œì—-ì°¸ê³ í• -ë§Œí•œ-ë¬¸ì„œë“¤-References" class="headerlink" title="í…ì„œí”Œë¡œìš° ê°œë°œì— ì°¸ê³ í•  ë§Œí•œ ë¬¸ì„œë“¤(References)"></a>í…ì„œí”Œë¡œìš° ê°œë°œì— ì°¸ê³ í•  ë§Œí•œ ë¬¸ì„œë“¤(References)</h2><h3 id="Tensorflow-Tutorial"><a href="#Tensorflow-Tutorial" class="headerlink" title="Tensorflow Tutorial"></a>Tensorflow Tutorial</h3><p>  <a href="https://github.com/Hvass-Labs/TensorFlow-Tutorials">í…ì„œí”Œë¡œìš° íŠœí† ë¦¬ì–¼</a></p><h3 id="ì‹œê³„ì—´ë°ì´í„°-ìŠ¤í„°ë””ìë£Œ-ëª¨ìŒ-Transformer"><a href="#ì‹œê³„ì—´ë°ì´í„°-ìŠ¤í„°ë””ìë£Œ-ëª¨ìŒ-Transformer" class="headerlink" title="ì‹œê³„ì—´ë°ì´í„° ìŠ¤í„°ë””ìë£Œ ëª¨ìŒ(Transformer)"></a>ì‹œê³„ì—´ë°ì´í„° ìŠ¤í„°ë””ìë£Œ ëª¨ìŒ(Transformer)</h3><p>  <a href="https://paperswithcode.com/task/time-series-forecasting">ì°¸ê³ ë…¼ë¬¸1</a><br>  <a href="https://github.com/LongxingTan/Time-series-prediction">ë‘˜ëŸ¬ë³¼ë§Œí•œ ê¹ƒí—™</a><br>  <a href="https://github.com/allen-chiang/Time-Series-Transformer">ë‘˜ëŸ¬ë³¼ë§Œí•œ ê¹ƒí—™2</a><br>  <a href="https://github.com/fengyang95/Awesome-Deep-Learning-Based-Time-Series-Forecasting">ê¹ƒí—™ ë§í¬2</a></p><h3 id="ìŒì„±-ìì—°ì–´ì²˜ë¦¬-ìŠ¤í„°ë””ìë£Œ-ëª¨ìŒ"><a href="#ìŒì„±-ìì—°ì–´ì²˜ë¦¬-ìŠ¤í„°ë””ìë£Œ-ëª¨ìŒ" class="headerlink" title="ìŒì„± ìì—°ì–´ì²˜ë¦¬ ìŠ¤í„°ë””ìë£Œ ëª¨ìŒ"></a>ìŒì„± ìì—°ì–´ì²˜ë¦¬ ìŠ¤í„°ë””ìë£Œ ëª¨ìŒ</h3><p>  <a href="https://github.com/carpedm20/multi-speaker-tacotron-tensorflow">TacoTron Tensorflow</a><br>  <a href="https://github.com/musikalkemist/DeepLearningForAudioWithPython">ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ ì°¸ê³ ìë£Œ best</a><br>  <a href="https://github.com/luuil/Tensorflow-Audio-Classification">VGGish</a><br>  <a href="https://www.kaggle.com/andradaolteanu/gtzan-dataset-music-genre-classification">kaggle Dataset</a></p><blockquote><p>ê³„ì† ì—…ë°ì´íŠ¸ ì˜ˆì • ì…ë‹ˆë‹¤.</p></blockquote>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/Papers/">Papers</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/Paper/">Paper</category>
      
      
      <comments>https://ikarus-999.github.io/2020/12/06/%EC%B0%B8%EA%B3%A0%EB%A6%AC%EC%8A%A4%ED%8A%B8/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ë”¥ëŸ¬ë‹-ì…ë¬¸í•˜ê¸°-9</title>
      <link>https://ikarus-999.github.io/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/</link>
      <guid>https://ikarus-999.github.io/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/</guid>
      <pubDate>Thu, 03 Dec 2020 09:41:05 GMT</pubDate>
      
      <description>ì§€ë‚œë²ˆì— ì´ì–´ì„œ ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ 2ë²ˆì§¸
2. Sound Representation
ìœ„ì—ì„œ Samplingëœ discreteí•œ ë°ì´í„°ë¥¼ ì´ì œ ìš°ë¦¬ëŠ” í‘œí˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì–´ë–¤ ìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì €í¬ê°€ ë°ì´í„°ë¥¼ í‘œí˜„í•´ì•¼í• ê¹Œìš”?, ì²«ë²ˆì§¸ëŠ” ì‹œê°„ì˜ íë¦„ì— ë”°ë¼, ê³µê¸°ì˜ íŒŒë™ì˜ í¬ê¸°ë¡œ ë³´ëŠ” Time-domain Representation ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ë‘ë²ˆì§¸ëŠ” ì‹œê°„ì— ë”°ë¼ì„œ frequencyì˜ ë³€í™”ë¥¼ ë³´ëŠ” Time-Frequency representationì´ ìˆìŠµë‹ˆë‹¤. 

2.1. Time domain - Waveform
Wavef</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ì§€ë‚œë²ˆì—-ì´ì–´ì„œ-ì˜¤ë””ì˜¤-ë”¥ëŸ¬ë‹-2ë²ˆì§¸"><a href="#ì§€ë‚œë²ˆì—-ì´ì–´ì„œ-ì˜¤ë””ì˜¤-ë”¥ëŸ¬ë‹-2ë²ˆì§¸" class="headerlink" title="ì§€ë‚œë²ˆì— ì´ì–´ì„œ ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ 2ë²ˆì§¸"></a>ì§€ë‚œë²ˆì— ì´ì–´ì„œ ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ 2ë²ˆì§¸</h2><h2 id="2-Sound-Representation"><a href="#2-Sound-Representation" class="headerlink" title="2. Sound Representation"></a>2. Sound Representation</h2><p>ìœ„ì—ì„œ Samplingëœ discreteí•œ ë°ì´í„°ë¥¼ ì´ì œ ìš°ë¦¬ëŠ” í‘œí˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì–´ë–¤ ìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì €í¬ê°€ ë°ì´í„°ë¥¼ í‘œí˜„í•´ì•¼í• ê¹Œìš”?, ì²«ë²ˆì§¸ëŠ” ì‹œê°„ì˜ íë¦„ì— ë”°ë¼, ê³µê¸°ì˜ íŒŒë™ì˜ í¬ê¸°ë¡œ ë³´ëŠ” Time-domain Representation ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ë‘ë²ˆì§¸ëŠ” ì‹œê°„ì— ë”°ë¼ì„œ frequencyì˜ ë³€í™”ë¥¼ ë³´ëŠ” Time-Frequency representationì´ ìˆìŠµë‹ˆë‹¤. </p><h3 id="2-1-Time-domain-Waveform"><a href="#2-1-Time-domain-Waveform" class="headerlink" title="2.1. Time domain - Waveform"></a>2.1. Time domain - Waveform</h3><p>Waveformì˜ ê²½ìš°ì—ëŠ” ì˜¤ë””ì˜¤ì˜ ìì—°ì ì´ í‘œí˜„ì…ë‹ˆë‹¤. ì‹œê°„ì´ xì¶•ìœ¼ë¡œ ê·¸ë¦¬ê³  amplitudeê°€ yì¶•ìœ¼ë¡œ í‘œí˜„ì´ ë©ë‹ˆë‹¤.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> librosa.display</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize = (<span class="number">14</span>,<span class="number">5</span>))</span><br><span class="line">librosa.display.waveplot(y[<span class="number">0</span>:<span class="number">10000</span>], sr=sr)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.collections.PolyCollection at 0x7fa325708d50&gt;</code></pre><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_21_1.png" alt="png"></p><h3 id="ì •í˜„íŒŒ-Sinusoid"><a href="#ì •í˜„íŒŒ-Sinusoid" class="headerlink" title="ì •í˜„íŒŒ (Sinusoid)"></a>ì •í˜„íŒŒ (Sinusoid)</h3><p>ëª¨ë“  ì‹ í˜¸ëŠ” ì£¼íŒŒìˆ˜(frequency)ì™€ í¬ê¸°(magnitude), ìœ„ìƒ(phase)ì´ ë‹¤ë¥¸ ì •í˜„íŒŒ(sinusolida signal)ì˜ ì¡°í•©ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤. í“¨ë¦¬ì— ë³€í™˜ì€ ì¡°í•©ëœ ì •í˜„íŒŒì˜ í•©(í•˜ëª¨ë‹ˆ) ì‹ í˜¸ì—ì„œ ê·¸ ì‹ í˜¸ë¥¼ êµ¬ì„±í•˜ëŠ” ì •í˜„íŒŒë“¤ì„ ê°ê° ë¶„ë¦¬í•´ë‚´ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sr = <span class="number">16000</span> <span class="comment"># sample rate</span></span><br><span class="line">T = <span class="number">2.0</span>    <span class="comment"># seconds</span></span><br><span class="line">t = np.linspace(<span class="number">0</span>, T, <span class="built_in">int</span>(T*sr), endpoint=<span class="literal">False</span>) <span class="comment"># time variable</span></span><br><span class="line">x = <span class="number">0.5</span>*np.sin(<span class="number">2</span>*np.pi*<span class="number">440</span>*t)                <span class="comment"># pure sine wave at 440 Hz</span></span><br><span class="line"><span class="comment"># y = 0.5*numpy.sin(2*numpy.pi*400*t)</span></span><br><span class="line"></span><br><span class="line">ipd.Audio(x, rate=sr) <span class="comment"># load a NumPy array</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">librosa.display.waveplot(x[:<span class="number">50</span>], sr=sr)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.collections.PolyCollection at 0x7fa327a01550&gt;</code></pre><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_24_1.png" alt="png"></p><h3 id="í‘¸ë¦¬ì—-ë³€í™˜-Fourier-transform"><a href="#í‘¸ë¦¬ì—-ë³€í™˜-Fourier-transform" class="headerlink" title="í‘¸ë¦¬ì— ë³€í™˜ (Fourier transform)"></a>í‘¸ë¦¬ì— ë³€í™˜ (Fourier transform)</h3><p>í‘¸ë¦¬ì— ë³€í™˜(Fourier transform)ì„ ì§ê´€ì ìœ¼ë¡œ ì„¤ëª…í•˜ë©´ í‘¸ë¦¬ì— ë³€í™˜ì€ ì„ì˜ì˜ ì…ë ¥ ì‹ í˜¸ë¥¼ ë‹¤ì–‘í•œ ì£¼íŒŒìˆ˜ë¥¼ ê°–ëŠ” ì£¼ê¸°í•¨ìˆ˜(ë³µìˆ˜ ì§€ìˆ˜í•¨ìˆ˜)ë“¤ì˜ í•©ìœ¼ë¡œ ë¶„í•´í•˜ì—¬ í‘œí˜„í•˜ëŠ” ê²ƒ ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ê° ì£¼ê¸°í•¨ìˆ˜ë“¤ì˜ ì§„í­ì„ êµ¬í•˜ëŠ” ê³¼ì •ì„ í“¨ë¦¬ì— ë³€í™˜ì´ë¼ê³  í•©ë‹ˆë‹¤.</p><ul><li>ì£¼ê¸°(period): íŒŒë™ì´ í•œë²ˆ ì§„ë™í•˜ëŠ”ë° ê±¸ë¦¬ëŠ” ì‹œê°„, ë˜ëŠ” ê·¸ ê¸¸ì´, ì¼ë°˜ì ìœ¼ë¡œ siní•¨ìˆ˜ì˜ ì£¼ê¸°ëŠ” \(2\pi /w\)ì…ë‹ˆë‹¤</li><li>ì£¼íŒŒìˆ˜(frequency): 1ì´ˆë™ì•ˆì˜ ì§„ë™íšŸìˆ˜ì…ë‹ˆë‹¤.</li></ul><p>í“¨ë¦¬ì— ë³€í™˜ì˜ ì‹ì„ ì‚´í´ë´…ì‹œë‹¤.</p><p>$$y(t)=\sum_{k=-\infty}^\infty A_k , \exp \left( i\cdot 2\pi\frac{k}{T} t \right)$$</p><p>ì´ ì‹ì„ í•˜ë‚˜ì‹ í•´ì„í•´ë´…ì‹œë‹¤.<br>\(k\)ëŠ” \(-\infty\) ~ \(\infty\)ì˜ ë²”ìœ„ë¥¼ ê°€ì§€ê³  ì›€ì§ì…ë‹ˆë‹¤.<br>ì´ê²ƒì€ ì£¼ê¸°í•¨ìˆ˜ë“¤ì˜ ê°¯ìˆ˜ì…ë‹ˆë‹¤. ì–´ë– í•œ ì‹ í˜¸ê°€ ë‹¤ë¥¸ ì£¼ê¸°í•¨ìˆ˜ë“¤ì˜ í•©ìœ¼ë¡œ í‘œí˜„ë˜ëŠ”ë°, ê·¸ ì£¼ê¸°í•¨ìˆ˜ëŠ” ë¬´í•œëŒ€ì˜ ë²”ìœ„ì— ìˆêµ°ìš”.</p><p>ê·¸ë ‡ë‹¤ë©´ \(A_k\)ì€ ê·¸ ì‚¬ì¸í•¨ìˆ˜ì˜ ì§„í­ì´ë¼ê³  í•©ë‹ˆë‹¤. ì´ ì‹ì€ ì‹œê°„ì— ëŒ€í•œ ì…ë ¥ì‹ í˜¸ \(y_{t}\)ê°€  \(\exp \left( i\cdot 2\pi\frac{k}{T} t \right)\) ì™€ ì§„í­(\(A_k\))ì˜ ì„ í˜•ê²°í•©ìœ¼ë¡œ í‘œí˜„ë¨ì„ ë§í•˜ê³  ìˆêµ°ìš”.</p><p>ìœ„ ê·¸ë¦¼ì„ ë³¸ë‹¤ë©´ ì¡°ê¸ˆ ë” ëª…í™•íˆ ì•Œìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë¶‰ì€ìƒ‰ ë¼ì¸ì´ ì…ë ¥ì‹ í˜¸ \(y_{t}\) ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ìš°ë¦¬ê°€ ë‹¤ë£¨ê²Œ ë˜ëŠ” ë°ì´í„°ì¸ ìŒì•…ì´ë‚˜ ëª©ì†Œë¦¬ ê°™ì€ ë°ì´í„° ì—­ì‹œ complex toneì…ë‹ˆë‹¤. ì—¬ë ¤ê°œì˜ ì£¼íŒŒìˆ˜ì˜ì—­ì´ í•©ì³ì§„ ê²ƒì´ì£ . ì´ëŸ¬í•œ ì—¬ëŸ¬ê°œì˜ ì£¼íŒŒìˆ˜ ì˜ì—­ì„ ë¶„ë¦¬í•˜ì!ê°€ ì£¼ìš”í•œ ì•„ì´ë””ì–´ì…ë‹ˆë‹¤. íŒŒë€ìƒ‰ ì£¼ê¸°í•¨ìˆ˜ë“¤ì„ ë³´ì‹ ë‹¤ë©´ ì—¬ëŸ¬ê°œì˜ ì£¼ê¸°í•¨ìˆ˜ë“¤ì„ ì°¾ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ ì£¼ê¸°í•¨ìˆ˜ë“¤ì€ ê³ ìœ ì˜ ì£¼íŒŒìˆ˜(frequency)ì™€ ê°•ë„(amplitude)ë¥¼ ê°€ì§€ê³  ìˆê³  ê·¸ê²ƒì´ íŒŒë€ìƒ‰ì˜ ë¼ì¸ë“¤ë¡œ í‘œí˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p><p>ì§„í­ì— ëŒ€í•œ ìˆ˜ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.<br>$$A_k = \frac{1}{T} \int_{-\frac{T}{2}}^\frac{T}{2} f(t) , \exp \left( -i\cdot 2\pi \frac{k}{T} t \right) , dt$$<br>ì—¬ê¸°ì„œ í•˜ë‚˜ì˜ ì˜ë¬¸ì ì´ ë“œì‹¤ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì£¼ê¸°í•¨ìˆ˜ì˜ í•©ìœ¼ë¡œ í‘œí˜„ëœë‹¤ê³  í–ˆëŠ”ë° ì €í¬ê°€ ë³´ê³  ìˆëŠ”ê²ƒì€ \(\exp \left( i\cdot 2\pi\frac{k}{T} t \right)\) ì§€ìˆ˜í•¨ìˆ˜ì˜ í˜•íƒœì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p><p>ì§€ìˆ˜í•¨ìˆ˜ì™€ ì£¼ê¸°í•¨ìˆ˜ ì‚¬ì´ì˜ ì—°ê´€ê´€ê³„ëŠ” ë¬´ì—‡ì¼ê¹Œìš”? ê·¸ ê´€ê³„ë¥¼ ì°¾ì€ ê²ƒì´ ë°”ë¡œ ì˜¤ì¼ëŸ¬ ê³µì‹ì…ë‹ˆë‹¤.</p><p>$$e^{i\theta} = \cos{\theta} + i\sin{\theta}$$</p><p>ì´ ì‹ì„ ìœ„ ì‹ì²˜ëŸ¼ í‘œí˜„í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤<br>$$\exp \left( i\cdot 2\pi\frac{k}{T} t \right) = \cos\left({2\pi\frac{k}{T}}\right) + i\sin\left({2\pi\frac{k}{T}}\right)$$</p><p>ì—¬ê¸°ì„œ \(\cos{2\pi\frac{k}{T}}\), \(i\sin{2\pi\frac{k}{T}}\) í•¨ìˆ˜ëŠ” ì£¼ê¸°ì™€ ì£¼íŒŒìˆ˜ë¥¼ ê°€ì§€ëŠ” ì£¼ê¸°í•¨ìˆ˜ì…ë‹ˆë‹¤. </p><p>ì¦‰ í“¨ë¦¬ì— ë³€í™˜ì€ ì…ë ¥ singalì´ ì–´ë–¤ê²ƒì¸ì§€ ìƒê´€ì—†ì´ sin, cosê³¼ ê°™ì€ ì£¼ê¸°í•¨ìˆ˜ë“¤ì˜ í•©ìœ¼ë¡œ í•­ìƒ ë¶„í•´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. </p><h3 id="Fourier-Transformì˜-Orthogonal"><a href="#Fourier-Transformì˜-Orthogonal" class="headerlink" title="Fourier Transformì˜ Orthogonal"></a>Fourier Transformì˜ Orthogonal</h3><p>$$y(t)=\sum_{k=-\infty}^\infty A_k , \exp \left( i\cdot 2\pi\frac{k}{T} t \right)$$</p><p>ì–´ë– í•œ ì£¼ê¸°í•¨ìˆ˜ë¥¼ ìš°ë¦¬ëŠ” cosê³¼ siní•¨ìˆ˜ë¡œ í‘œí˜„í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ í•œê°€ì§€ ì¬ë°ŒëŠ” ì ì€, ì´ í•¨ìˆ˜ë“¤ì´ ì§êµí•˜ëŠ” í•¨ìˆ˜(orthogonal)ë¼ëŠ” ì ì´ë‹¤.<br>$${ \exp \left(i\cdot 2\pi\frac{k}{T} t\right) } = orthogonal$$</p><p>ë²¡í„°ì˜ ì§êµëŠ” í•´ë‹¹ ë²¡í„°ë¥¼ í†µí•´ í‰ë©´ì˜ ëª¨ë“  ì¢Œí‘œë¥¼ í‘œí˜„í• ìˆ˜ ìˆì—ˆë‹¤. í•¨ìˆ˜ì˜ ë‚´ì ì€ ì ë¶„ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆëŠ”ë°, ë§Œì•½ êµ¬ê°„ [a,b]ì—ì„œ ì§êµí•˜ëŠ” í•¨ìˆ˜ëŠ” êµ¬ê°„ [a,b]ì˜ ëª¨ë“  í•¨ìˆ˜ë¥¼ í‘œí˜„í• ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ìœ„ ì¼€ì´ìŠ¤ì—ì„œëŠ” cos, sin í•¨ìˆ˜ê°€ ì‚¬ì‹¤ìƒ ìš°ë¦¬ ì…ë ¥ì‹ í˜¸ì— ëŒ€í•´ì„œ ê¸°ì €ê°€ ë˜ì–´ì£¼ëŠ” í•¨ìˆ˜ë¼ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h3 id="DFT-Discrete-Fourier-Transform"><a href="#DFT-Discrete-Fourier-Transform" class="headerlink" title="DFT (Discrete Fourier Transform)"></a>DFT (Discrete Fourier Transform)</h3><p>í•œê°€ì§€ ì˜ë¬¸ì ì´ ë“­ë‹ˆë‹¤. ë°”ë¡œ, ìš°ë¦¬ê°€ samplingìœ¼ë¡œ ë“¤ì–´ì˜¨ ë°ì´í„°ëŠ” ë°”ë¡œ ì‹œê°„ì˜ ê°„ê²©ì— ë”°ë¥¸ ì†Œë¦¬ì˜ amplitudeì˜ discreteí•œ ë°ì´í„°ì´ê¸° ë•Œë¬¸ì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ ìœ„ í‘¸ë¦¬ì— ë³€í™˜ ì‹ì„ Discreteí•œ ì˜ì—­ìœ¼ë¡œ ìƒê°í•´ë´…ì‹œë‹¤.</p><p>ë§Œì•½ì— ìš°ë¦¬ê°€ ìˆ˜ì§‘í•œ ë°ì´í„° \(y_{n}\)ì—ì„œ, ì´ì‚° ì‹œê³„ì—´ ë°ì´í„°ê°€ ì£¼ê¸° \(N\)ìœ¼ë¡œ ë°˜ë³µí•œë‹¤ê³  í• ë•Œ, DFTëŠ” ì£¼íŒŒìˆ˜ì™€ ì§„í­ì´ ë‹¤ë¥¸ \(N\)ê°œì˜ ì‚¬ì¸ í•¨ìˆ˜ì˜ í•©ìœ¼ë¡œ í‘œí˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>$$y_n = \frac{1}{N} \sum_{k=0}^{N-1} Y_k \cdot \exp \left( i\cdot 2\pi\frac{k}{N} n \right)$$</p><p>ìœ„ ì‹ì„ ë³´ë©´ kì˜ rangeê°€ 0ë¶€í„° \(N-1\)ë¡œ ë³€í™”í–ˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ë•Œ Spectrum \(Y_{k}\)ë¥¼ ì›ë˜ì˜ ì‹œê³„ì—´ ë°ì´í„°ì— ëŒ€í•œ í“¨ë¦¬ì— ë³€í™˜ê°’ì´ë¼ê³  í•˜ì£ .</p><p>$$Y_k = \sum_{n=0}^{N-1} y_n\cdot \exp \left( -i\cdot 2\pi\frac{k}{N} n \right)$$</p><ul><li>\(y_{n}\) : input signal</li><li>\(n\) : Discrete time index</li><li>\(k\) : discrete frequency index</li><li>\(Y_{k}\) : kë²ˆì§¸ frequenyì— ëŒ€í•œ Spectrumì˜ ê°’</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DFT</span>(<span class="params">x</span>):</span></span><br><span class="line">    N = <span class="built_in">len</span>(x)</span><br><span class="line">    X = np.array([])</span><br><span class="line">    nv = np.arange(N)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        s = np.exp(<span class="number">1j</span>*<span class="number">2</span>*np.pi*k/N*nv)</span><br><span class="line">        X = np.append(X, <span class="built_in">sum</span>(x*np.conjugate(s)))</span><br><span class="line">    <span class="keyword">return</span> X</span><br></pre></td></tr></table></figure><h3 id="STFT-Short-Time-Fourier-Transform"><a href="#STFT-Short-Time-Fourier-Transform" class="headerlink" title="STFT (Short-Time Fourier Transform)"></a>STFT (Short-Time Fourier Transform)</h3><p>FFTëŠ” ì‹œê°„ì— íë¦„ì— ë”°ë¼ ì‹ í˜¸ì˜ ìˆ˜íŒŒìˆ˜ê°€ ë³€í–ˆì„ë•Œ, ì–´ëŠ ì‹œê°„ëŒ€ì— ì£¼íŒŒìˆ˜ê°€ ë³€í•˜ëŠ”ì§€ ëª¨ë¥´ê²Œ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ì„œ, STFTëŠ” ì‹œê°„ì˜ ê¸¸ì´ë¥¼ ë‚˜ëˆ ì„œ ì´ì œ í“¨ë¦¬ì— ë³€í™˜ì„ í•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰ FFTë¥¼ í–ˆì„ë•ŒëŠ” Time dominaì— ëŒ€í•œ ì •ë³´ê°€ ë‚ ì•„ê°€ê²Œ ë˜ëŠ” ê²ƒì´ì£ .</p><p>ì£¼íŒŒìˆ˜ì˜ íŠ¹ì„±ì´ ì‹œê°„ì— ë”°ë¼ ë‹¬ë¼ì§€ëŠ” ì‚¬ìš´ë“œë¥¼ ë¶„ì„í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ëŠ” signal ë°ì´í„°ì— ì í•©í•˜ë‹¤. ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ì¼ì •í•œ ì‹œê°„ êµ¬ê°„ (window size)ë¡œ ë‚˜ëˆ„ê³ , ê° êµ¬ê°„ì— ëŒ€í•´ì„œ ìŠ¤í™íŠ¸ëŸ¼ì„ êµ¬í•˜ëŠ” ë°ì´í„°ì´ë‹¤. ì´ëŠ” Time-frequency 2ì°¨ì› ë°ì´í„°ë¡œ í‘œí˜„ì´ ë©ë‹ˆë‹¤.</p><p>$$X(l,k) = \sum_{n=0}^{N-1} w(n) x(n+lH)\exp^{\frac{-2\pi k n}{N}}$$</p><ul><li><p>\(N\) : FFT size</p><ul><li>Windowë¥¼ ì–¼ë§ˆë‚˜ ë§ì€ ì£¼íŒŒìˆ˜ ë°´ë“œë¡œ ë‚˜ëˆ„ëŠ”ê°€ ì…ë‹ˆë‹¤.</li></ul></li><li><p>Duration</p><ul><li>ìƒ˜í”Œë§ ë ˆì´íŠ¸ë¥¼ windowë¡œ ë‚˜ëˆˆ ê°’ì…ë‹ˆë‹¤.</li><li>$$T= window/SR$$</li><li>T(Window) = 5T(Signal), durationì€ ì‹ í˜¸ì£¼ê¸°ë³´ë‹¤ 5ë°° ì´ìƒ ê¸¸ê²Œ ì¡ì•„ì•¼í•œë‹¤.</li><li>440Hz ì‹ í˜¸ì˜ window sizeëŠ” 5*(1/440)ì´ ë©ë‹ˆë‹¤.</li></ul></li><li><p>\(w(n)\) : Window function</p><ul><li>ì¼ë°˜ì ìœ¼ë¡œ Hann windowê°€ ì“°ì…ë‹ˆë‹¤.</li></ul></li><li><p>\(n\) : Window size</p><ul><li>Window í•¨ìˆ˜ì— ë“¤ì–´ê°€ëŠ” Sampleì˜ ì–‘ì…ë‹ˆë‹¤.</li><li>ì‘ì„ìˆ˜ë¡ Low-frequency resolutionì„ ê°€ì§€ê²Œ ë˜ê³ , high-time resolutionì„ ê°€ì§‘ë‹ˆë‹¤.</li><li>ê¸¸ìˆ˜ë¡ High-frequency, low time resolutionì„ ê°€ì§‘ë‹ˆë‹¤.</li></ul></li><li><p>\(H\) : Hop size</p><ul><li>ìœˆë„ìš°ê°€ ê²¹ì¹˜ëŠ” ì‚¬ì´ì¦ˆì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œëŠ” 1/4ì •ë„ë¥¼ ê²¹ì¹˜ê²Œ í•©ë‹ˆë‹¤.</li></ul></li></ul><p>STFTì˜ ê²°ê³¼ëŠ” ì¦‰ ì‹œê°„ì˜ íë¦„(Window)ì— ë”°ë¥¸ Frequencyì˜ì—­ë³„ Amplitudeë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sr = <span class="number">16000</span> <span class="comment"># sample rate</span></span><br><span class="line">T = <span class="number">2.0</span>    <span class="comment"># seconds</span></span><br><span class="line">t = np.linspace(<span class="number">0</span>, T, <span class="built_in">int</span>(T * sr), endpoint=<span class="literal">False</span>) <span class="comment"># time variable</span></span><br><span class="line">x = <span class="number">0.5</span> * np.sin(<span class="number">2</span> * np.pi * <span class="number">440</span> * t)                <span class="comment"># pure sine wave at 440 Hz</span></span><br><span class="line"><span class="comment"># y = 0.5*numpy.sin(2*numpy.pi*400*t)</span></span><br><span class="line"></span><br><span class="line">ipd.Audio(x, rate=sr) <span class="comment"># load a NumPy array</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="built_in">len</span>(y))</span><br><span class="line">D = librosa.stft(y)</span><br><span class="line">print(D.shape, D)</span><br><span class="line"></span><br><span class="line"><span class="comment"># phase ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‚ ë¦°ë‹¤.</span></span><br><span class="line">D_mag = np.<span class="built_in">abs</span>(D)</span><br><span class="line">print(D_mag)</span><br><span class="line">print(D_mag.shape)</span><br><span class="line"></span><br><span class="line">magnitude, phase = librosa.magphase(D)</span><br><span class="line"></span><br><span class="line">print(magnitude)</span><br><span class="line">print(magnitude.shape)</span><br><span class="line"></span><br><span class="line">print(magnitude-D_mag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>48944(1025, 96) [[-2.1494275e-01+0.0000000e+00j -2.0992082e-01+0.0000000e+00j  -2.0418610e-01+0.0000000e+00j ... -1.9438802e-01+0.0000000e+00j  -1.9518623e-01+0.0000000e+00j -2.3163199e-01+0.0000000e+00j] [ 9.3493842e-02+6.7762636e-21j  1.2481287e-01+4.8880498e-03j   7.3961377e-02+1.3274251e-03j ...  7.7925511e-02-1.7781712e-02j   9.6285135e-02+1.7115690e-02j  1.1564651e-01-5.2810002e-02j] [ 1.9829417e-02+8.2818238e-19j -3.1706840e-02+1.5587136e-02j   5.7078212e-02-2.0519590e-02j ...  2.3265863e-02+7.6752454e-02j   3.0044108e-03-6.0352467e-02j  5.4616658e-03+6.8522707e-02j] ... [-5.3125373e-03-1.2618632e-18j  3.4157380e-03-1.7295172e-03j  -1.8859134e-03-3.5993013e-04j ... -7.6227036e-04-9.3025468e-05j  -1.8814437e-04-8.4138475e-05j  4.7763987e-04-5.3400453e-04j] [ 2.1248308e-03+1.5585406e-19j -1.4035926e-03+8.0862024e-05j   2.4144542e-03+3.4830419e-04j ... -2.3595782e-04+1.1687888e-03j   1.1331354e-04+1.2911476e-04j  2.8909228e-04+3.3650018e-04j] [-8.1756472e-04+0.0000000e+00j -9.3529455e-04+0.0000000e+00j  -1.4104146e-03+0.0000000e+00j ...  1.3452002e-03+0.0000000e+00j  -9.2299597e-06+0.0000000e+00j -4.9439305e-04+0.0000000e+00j]][[2.1494275e-01 2.0992082e-01 2.0418610e-01 ... 1.9438802e-01  1.9518623e-01 2.3163199e-01] [9.3493842e-02 1.2490856e-01 7.3973291e-02 ... 7.9928555e-02  9.7794548e-02 1.2713383e-01] [1.9829417e-02 3.5331041e-02 6.0654562e-02 ... 8.0201246e-02  6.0427204e-02 6.8740025e-02] ... [5.3125373e-03 3.8286415e-03 1.9199529e-03 ... 7.6792570e-04  2.0610093e-04 7.1645004e-04] [2.1248308e-03 1.4059199e-03 2.4394479e-03 ... 1.1923688e-03  1.7178644e-04 4.4362905e-04] [8.1756472e-04 9.3529455e-04 1.4104146e-03 ... 1.3452002e-03  9.2299597e-06 4.9439305e-04]](1025, 96)[[2.1494275e-01 2.0992082e-01 2.0418610e-01 ... 1.9438802e-01  1.9518623e-01 2.3163199e-01] [9.3493842e-02 1.2490856e-01 7.3973291e-02 ... 7.9928555e-02  9.7794548e-02 1.2713383e-01] [1.9829417e-02 3.5331041e-02 6.0654562e-02 ... 8.0201246e-02  6.0427204e-02 6.8740025e-02] ... [5.3125373e-03 3.8286415e-03 1.9199529e-03 ... 7.6792570e-04  2.0610093e-04 7.1645004e-04] [2.1248308e-03 1.4059199e-03 2.4394479e-03 ... 1.1923688e-03  1.7178644e-04 4.4362905e-04] [8.1756472e-04 9.3529455e-04 1.4104146e-03 ... 1.3452002e-03  9.2299597e-06 4.9439305e-04]](1025, 96)[[0. 0. 0. ... 0. 0. 0.] [0. 0. 0. ... 0. 0. 0.] [0. 0. 0. ... 0. 0. 0.] ... [0. 0. 0. ... 0. 0. 0.] [0. 0. 0. ... 0. 0. 0.] [0. 0. 0. ... 0. 0. 0.]]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">S = librosa.core.stft(audio_np, n_fft=<span class="number">1024</span>, hop_length=<span class="number">512</span>, win_length=<span class="number">1024</span>)</span><br><span class="line">D = np.<span class="built_in">abs</span>(S)**<span class="number">2</span></span><br><span class="line">log_S = librosa.power_to_db(S, ref=np.<span class="built_in">max</span>) <span class="comment">#ì†Œë¦¬ì˜ ë‹¨ìœ„ë¥¼ dbë¡œ ë°”ê¿ˆ </span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(log_S, sr=<span class="number">16000</span>, x_axis=<span class="string">&#x27;time&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="Window-function"><a href="#Window-function" class="headerlink" title="Window function?"></a>Window function?</h3><p>ìœ„ì—ì„œ Window functionê³¼ Window sizeë¼ëŠ” ì´ì•¼ê¸°ê°€ ë‚˜ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. ìœˆë„ìš° Functionê³¼ SizeëŠ” ì™œ ì“°ëŠ” ê²ƒì´ë©° ì–´ë–¨ë•Œ ì“°ëŠ” ê²ƒì¼ê¹Œìš”?</p><p>Window functionì˜ ì£¼ëœ ê¸°ëŠ¥ì€ main-lobeì˜ widthì™€ side-lobeì˜ ë ˆë²¨ì˜ Trade-off ë¥¼ ì œì–´í•´ ì¤€ë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê¹ìŠ¤ í˜„ìƒì„ ë§‰ì•„ì£¼ëŠ” ê³ ë§ˆìš´ ì¹œêµ¬ì´ê¸°ë„ í•˜ì£ . ì§€ê¸ˆë‚˜ì˜¨ main-lobe, side-bloe, ê¹ìŠ¤í˜„ìƒì€ ë¬´ì—‡ì¼ê¹Œìš”?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">frame_audio</span>(<span class="params">audio, FFT_size=<span class="number">1024</span>, hop_size=<span class="number">20</span>, sample_rate = <span class="number">22050</span></span>):</span></span><br><span class="line">    audio = np.pad(audio, <span class="built_in">int</span>(FFT_size/<span class="number">2</span>), mode=<span class="string">&#x27;reflect&#x27;</span>)</span><br><span class="line">    frame_len = np.<span class="built_in">round</span>(sample_rate*hop_size / <span class="number">1000</span>).astype(<span class="built_in">int</span>)</span><br><span class="line">    frame_num = <span class="built_in">int</span>((<span class="built_in">len</span>(audio) - FFT_size) / frame_len) + <span class="number">1</span></span><br><span class="line">    frames = np.zeros((frame_num, FFT_size))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(frame_num):</span><br><span class="line">        frames[n] = audio[n*frame_len:n*frame_len+FFT_size]</span><br><span class="line">    <span class="keyword">return</span> frames</span><br><span class="line"></span><br><span class="line">audio_framed = frame_audio(audio_np)</span><br><span class="line">print(<span class="string">&quot;Framed audio shape: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(audio_framed.shape))</span><br></pre></td></tr></table></figure><pre><code>Framed audio shape: (469, 1024)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line">window = signal.get_window(<span class="string">&quot;hann&quot;</span>, <span class="number">1024</span>, fftbins=<span class="literal">True</span>)</span><br><span class="line">audio_win = audio_framed * window</span><br><span class="line">ind = <span class="number">2</span></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">6</span>))</span><br><span class="line">plt.subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">plt.plot(window)</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">plt.plot(audio_framed[ind])</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">plt.plot(audio_win[ind])</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_49_0.png" alt="png"></p><p>í”Œë¡¯ì„ ë³´ê²Œ ëœë‹¤ë©´ windowingì„ ì ìš©í•˜ê¸°ì „ plotì€ ëë¶€ë¶„ì´ ë‹¤ ë‹¤ë¥´ì§€ë§Œ, windowingì„ ì§€ë‚˜ê³  ë‚˜ì„œ ë‚˜ì˜¤ëŠ” plotì€ ëì´ 0 ìœ¼ë¡œ ì¼ì¹˜í•œë‹¤ëŠ” íŠ¹ì„±ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><h3 id="Window-size"><a href="#Window-size" class="headerlink" title="Window size?"></a>Window size?</h3><p>ìœˆë„ìš° ì‚¬ì´ì¦ˆëŠ” ì¼ë°˜ì ìœ¼ë¡œ timeê³¼ frequencyì˜ resolutionsì„ ì œì–´í•´ ì¤ë‹ˆë‹¤.</p><ul><li>short-window : ë‚®ì€ frequency resolution, ë†’ì€ time-resolutionì„ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤.</li><li>Long-window : ë†’ì€ frequency resolutionì„ ê°€ì§€ë©°, ë‚®ì€ time-resolutionì„ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤.</li></ul><h3 id="Spectrogram"><a href="#Spectrogram" class="headerlink" title="Spectrogram"></a>Spectrogram</h3><p>Spectrogramì„ ì¶”ì¶œí•˜ëŠ” ë°©ë²•ì„ ê³ ë¯¼í•´ë´…ì‹œë‹¤.ì¼ë°˜ì ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ëŠ” ì…ë ¥ì‹ í˜¸ì— ëŒ€í•´ì„œ window functionì„ í†µê³¼í•˜ì—¬ window sizeë§Œí¼ sampling ëœ dataë¥¼ ë°›ì•„ì„œ Discrete Fourier Transformì„ ê±°ì¹˜ê²Œ ë©ë‹ˆë‹¤. DFTë¥¼ ê±°ì¹œ ì‹ í˜¸ë“¤ì€ Frequencyì™€ Amplitudeì˜ ì˜ì—­ì„ ê°€ì§€ëŠ” Spectrumì´ ë©ë‹ˆë‹¤. ì´í›„ ì´ë¥¼ 90ë„ë¡œ íšŒì „ì‹œì¼œì„œ, time domainìœ¼ë¡œ stackí•˜ê²Œ ë©ë‹ˆë‹¤.</p><p>Spectrogramì€ Frequency Scaleì— ëŒ€í•´ì„œ Scalingì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì£¼íŒŒìˆ˜ ì˜ì—­ì— Scalingì„ í•˜ëŠ” ì´ìœ ëŠ”, ì¸ê°„ì˜ ì£¼íŒŒìˆ˜ë¥¼ ì¸ì‹í•˜ëŠ” ë°©ì‹ê³¼ ì—°ê´€ì´ ìˆìŠµë‹ˆë‹¤. </p><p>ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ëŒì€, ì¸ì ‘í•œ ì£¼íŒŒìˆ˜ë¥¼ í¬ê²Œ êµ¬ë³„í•˜ì§€ ëª»í•©ë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” ìš°ë¦¬ì˜ ì¸ì§€ê¸°ê´€ì´ categoricalí•œ êµ¬ë¶„ì„ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë•Œë¬¸ì— ìš°ë¦¬ëŠ” ì£¼íŒŒìˆ˜ë“¤ì˜ Binì˜ ê·¸ë£¹ì„ ë§Œë“¤ê³  ì´ë“¤ì„ í•©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ, ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œ ì–¼ë§ˆë§Œí¼ì˜ ì—ë„ˆì§€ê°€ ìˆëŠ”ì§€ë¥¼ ì°¾ì•„ë³¼ ê²ƒì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œëŠ” ì¸ê°„ì´ ì ì€ ì£¼íŒŒìˆ˜ì— ë” í’ë¶€í•œ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê¸°ë•Œë¬¸ì—, ì£¼íŒŒìˆ˜ê°€ ì˜¬ë¼ê°ˆìˆ˜ë¡ í•„í„°ì˜ í­ì´ ë†’ì•„ì§€ë©´ì„œ ê³ ì£¼íŒŒëŠ” ê±°ì˜ ê³ ë ¤ë¥¼ ì•ˆí•˜ê²Œ ë©ë‹ˆë‹¤.</p><p>ë”°ë¼ì„œ ì•„ë˜ frequency scaleì€ ì–´ë–¤ ë°©ì‹ì„ í†µí•´ ì €ì£¼íŒŒìˆ˜ëŒ€ ì˜ì—­ì„ ê³ ë ¤í•  ê²ƒì´ê°€ì— ëŒ€í•œ ê³ ë¯¼ì´ ë‚¨ì•„ ìˆìŠµë‹ˆë‹¤.</p><h3 id="Linear-frequency-scale"><a href="#Linear-frequency-scale" class="headerlink" title="Linear frequency scale"></a>Linear frequency scale</h3><p>ì¼ë°˜ì ìœ¼ë¡œ single tone(ìˆœìŒ)ë“¤ì˜ ë°°ìŒ êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ê¸° ì¢‹ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë¶„í¬ê°€ ì €ì£¼íŒŒìˆ˜ ì˜ì—­ì— ê¸°ìš¸ì–´ì ¸(skewed) ìˆìŠµë‹ˆë‹¤.</p><h3 id="Mel-Scale"><a href="#Mel-Scale" class="headerlink" title="Mel Scale"></a>Mel Scale</h3><p>ë©œ ìŠ¤í™íŠ¸ëŸ¼ì€ ì£¼íŒŒìˆ˜ ë‹¨ìœ„ë¥¼ ë‹¤ìŒ ê³µì‹ì— ë”°ë¼ ë©œ ë‹¨ìœ„ë¡œ ë°”ê¾¼ ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p><p>$$m = 2595 \log_{10}\left(1 + \frac{f}{700}\right)$$<br>ì¼ë°˜ì ìœ¼ë¡œëŠ” mel-scaled binì„ FFT sizeë³´ë‹¤ ì¡°ê¸ˆë” ì‘ê²Œ ë§Œë“œëŠ”ê²Œ ì¼ë°˜ì ì…ë‹ˆë‹¤.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># STFT</span></span><br><span class="line">S = librosa.core.stft(audio_np, n_fft=<span class="number">1024</span>, hop_length=<span class="number">512</span>, win_length=<span class="number">1024</span>)</span><br><span class="line"><span class="comment"># phase ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‚ ë¦°ë‹¤.</span></span><br><span class="line">D = np.<span class="built_in">abs</span>(S)**<span class="number">2</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mel spectrogram (512 --&gt; 40)</span></span><br><span class="line">mel_basis = librosa.filters.mel(sr, <span class="number">1024</span>, n_mels=<span class="number">40</span>)</span><br><span class="line">mel_S = np.dot(mel_basis, D)</span><br><span class="line">mel_S.shape</span><br></pre></td></tr></table></figure><pre><code>(40, 404)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> librosa.display</span><br><span class="line"></span><br><span class="line">S = librosa.feature.melspectrogram(audio_np, sr=sr, n_mels = <span class="number">128</span>)</span><br><span class="line">log_S = librosa.power_to_db(S, ref=np.<span class="built_in">max</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(log_S, sr=sr, x_axis=<span class="string">&#x27;time&#x27;</span>, y_axis=<span class="string">&#x27;mel&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Mel power sepctrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+02.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br></pre></td></tr></table></figure><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_54_0.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> librosa.display</span><br><span class="line"></span><br><span class="line">S = librosa.feature.melspectrogram(audio_np, sr=sr, n_mels = <span class="number">256</span>)</span><br><span class="line">log_S = librosa.power_to_db(S, ref=np.<span class="built_in">max</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(log_S, sr=sr, x_axis=<span class="string">&#x27;time&#x27;</span>, y_axis=<span class="string">&#x27;mel&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Mel power sepctrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+02.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br></pre></td></tr></table></figure><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_55_0.png" alt="png"></p><h3 id="Bark-scale"><a href="#Bark-scale" class="headerlink" title="Bark scale"></a>Bark scale</h3><p>ê·€ê°€ ì¸ì‹í•˜ëŠ” ì£¼íŒŒìˆ˜ì˜ ì˜ì—­ì€ ëŒ€ëµ 20Hz~2000Hz ë¡œ ê°€ì •í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì£¼íŒŒìˆ˜ì— ëŒ€í•œ ì‚¬ëŒì˜ ì¸ì‹ì€ ë¹„ì„ í˜•ì ì…ë‹ˆë‹¤. ê·€ì™€ ë‡Œì˜ ê°€ì²­ëŒ€ì—­ì„ 24ê°œì˜ ëŒ€ì—­ìœ¼ë¡œ ë‚˜ëˆˆê²ƒì„ Barkë¼ê³  í•©ë‹ˆë‹¤! Bark scaleì€ 500Hzì´í•˜ì—ì„œëŠ” 100Hzì˜ ëŒ€ì—­í­ì„ ê°€ì§€ë©°, 500Hz ì´ìƒì—ì„œëŠ” ê° ëŒ€ì—­ì˜ ì¤‘ì‹¬ìˆ˜íŒŒìˆ˜ì˜ ëŒ€ëµ 20%ì— í•´ë‹¹í•˜ëŠ” ëŒ€ì—­í­ì„ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤.</p><p><code>20, 100, 200, 300, 400, 510, 630, 770, 920, 1080, 1270, 1480, 1720, 2000, 2320, 2700, 3150, 3700, 4400, 5300, 6400, 7700, 9500, 12000, 15500 ( Hz )</code></p><h3 id="Log-compression"><a href="#Log-compression" class="headerlink" title="Log compression"></a>Log compression</h3><p>\(10 * log10(\frac{S}{ref})\)<br>ì˜ ë‹¨ìœ„ë¡œ ì‹ í˜¸ë¥¼ ìŠ¤ì¼€ì¼ë§ í•©ë‹ˆë‹¤. ì´ëŠ” spectrogramì„ ë°ì‹œë²¨ ìœ ë‹›ìœ¼ë¡œ ì „í™˜í•´ ì¤ë‹ˆë‹¤.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#log compression</span></span><br><span class="line">log_mel_S = librosa.power_to_db(mel_S)</span><br><span class="line">log_mel_S.shape</span><br></pre></td></tr></table></figure><pre><code>(40, 404)</code></pre><h3 id="Discrete-cosine-transform-DCT"><a href="#Discrete-cosine-transform-DCT" class="headerlink" title="Discrete cosine transform (DCT)"></a>Discrete cosine transform (DCT)</h3><p>DCTëŠ” nê°œì˜ ë°ì´í„°ë¥¼ nê°œì˜ ì½”ì‚¬ì¸ í•¨ìˆ˜ì˜ í•©ìœ¼ë¡œ í‘œí˜„í•˜ì—¬ ë°ì´í„°ì˜ ì–‘ì„ ì¤„ì´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. </p><ul><li>ì € ì£¼íŒŒìˆ˜ì— ì—ë„ˆì§€ê°€ ì§‘ì¤‘ë˜ê³  ê³  ì£¼íŒŒìˆ˜ ì˜ì—­ì— ì—ë„ˆì§€ê°€ ê°ì†Œí•©ë‹ˆë‹¤.</li></ul><p>Filter BankëŠ” ëª¨ë‘ Overlapping ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— Filter Bank ì—ë„ˆì§€ë“¤ ì‚¬ì´ì— ìƒê´€ê´€ê³„ê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì´ë‹¤. DCTëŠ” ì—ë„ˆì§€ë“¤ ì‚¬ì´ì— ì´ëŸ¬í•œ ìƒê´€ê´€ê³„ë¥¼ ë¶„ë¦¬ í•´ì£¼ëŠ” ì—­í™œì„ í•´ì¤ë‹ˆë‹¤.</p><p>í•˜ì§€ë§Œ ì—¬ê¸°ì„œ 26ê°œ DCT Coefficient ë“¤ ì¤‘ 12ë§Œ ë‚¨ê²¨ì•¼ í•˜ëŠ”ë°, ê·¸ ì´ìœ ëŠ” DCT Coefficient ê°€ ë§ìœ¼ë©´, Filter Bank ì—ë„ˆì§€ì˜ ë¹ ë¥¸ ë³€í™”ë¥¼ ë‚˜íƒ€ë‚´ê²Œ ë˜ê³ , ì´ê²ƒì€ ìŒì„±ì¸ì‹ì˜ ì„±ëŠ¥ì„ ë‚®ì¶”ê²Œ ë©ë‹ˆë‹¤.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mfcc (DCT)</span></span><br><span class="line">mfcc = librosa.feature.mfcc(S=log_mel_S, n_mfcc=<span class="number">13</span>)</span><br><span class="line">mfcc = mfcc.astype(np.float32)    <span class="comment"># to save the memory (64 to 32 bits)</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(mfcc)</span><br></pre></td></tr></table></figure><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f3a8975cc88&gt;</code></pre><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_61_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mfcc = librosa.feature.mfcc(S=log_S, n_mfcc=<span class="number">13</span>)</span><br><span class="line">delta2_mfcc = librosa.feature.delta(mfcc, order=<span class="number">2</span>)</span><br><span class="line">print(delta2_mfcc.shape)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(delta2_mfcc)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;MFCC coeffs&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Time&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;MFCC&#x27;</span>)</span><br><span class="line">plt.colorbar()</span><br><span class="line">plt.tight_layout()</span><br></pre></td></tr></table></figure><pre><code>(13, 148)</code></pre><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_62_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_pitch</span>(<span class="params">data, sr</span>):</span></span><br><span class="line">    y_pitch = data.copy()</span><br><span class="line">    bins_per_octave = <span class="number">12</span></span><br><span class="line">    pitch_pm = <span class="number">2</span></span><br><span class="line">    pitch_change = pitch_pm * <span class="number">2</span> * (np.random.uniform())</span><br><span class="line">    y_pitch = librosa.effects.pitch_shift(y_pitch.astype(<span class="string">&#x27;float64&#x27;</span>), sr, n_steps=pitch_change,</span><br><span class="line">                                          bins_per_octave=bins_per_octave)</span><br><span class="line">    <span class="keyword">return</span> y_pitch</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waveform_aug</span>(<span class="params">waveform,sr</span>):</span></span><br><span class="line">  y = change_pitch(waveform, sr)</span><br><span class="line">  fig = plt.figure(figsize = (<span class="number">14</span>,<span class="number">5</span>))</span><br><span class="line">  librosa.display.waveplot(y, sr=sr)</span><br><span class="line">  ipd.display(ipd.Audio(data=y, rate=sr))</span><br><span class="line">  <span class="keyword">return</span> y, sr</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ipd.display(ipd.Audio(data=audio_np, rate=sr))</span><br><span class="line">y, sr = waveform_aug(audio_np, <span class="number">16000</span>)</span><br></pre></td></tr></table></figure><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_66_2.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">S = librosa.feature.melspectrogram(audio_np, sr=sr, n_mels = <span class="number">128</span>)</span><br><span class="line">log_S = librosa.power_to_db(S, ref=np.<span class="built_in">max</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(log_S, sr=sr, x_axis=<span class="string">&#x27;time&#x27;</span>, y_axis=<span class="string">&#x27;mel&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Mel power sepctrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+02.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br></pre></td></tr></table></figure><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_67_0.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.random.uniform(low=<span class="number">1.5</span>, high=<span class="number">3</span>)</span><br></pre></td></tr></table></figure><pre><code>2.6892527992385458</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">value_aug</span>(<span class="params">data</span>):</span></span><br><span class="line">    y_aug = data.copy()</span><br><span class="line">    dyn_change = np.random.uniform(low=<span class="number">1.5</span>, high=<span class="number">3</span>)</span><br><span class="line">    y_aug = y_aug * dyn_change</span><br><span class="line">    <span class="keyword">return</span> y_aug</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_noise</span>(<span class="params">data</span>):</span></span><br><span class="line">    noise = np.random.randn(<span class="built_in">len</span>(data))</span><br><span class="line">    data_noise = data + <span class="number">0.005</span> * noise</span><br><span class="line">    <span class="keyword">return</span> data_noise</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hpss</span>(<span class="params">data</span>):</span></span><br><span class="line">    y_harmonic, y_percussive = librosa.effects.hpss(data.astype(<span class="string">&#x27;float64&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> y_harmonic, y_percussive</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shift</span>(<span class="params">data</span>):</span></span><br><span class="line">    <span class="keyword">return</span> np.roll(data, <span class="number">1600</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stretch</span>(<span class="params">data, rate=<span class="number">1</span></span>):</span></span><br><span class="line">    input_length = <span class="built_in">len</span>(data)</span><br><span class="line">    streching = librosa.effects.time_stretch(data, rate)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(streching) &gt; input_length:</span><br><span class="line">        streching = streching[:input_length]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        streching = np.pad(streching, (<span class="number">0</span>, <span class="built_in">max</span>(<span class="number">0</span>, input_length - <span class="built_in">len</span>(streching))), <span class="string">&quot;constant&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> streching</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_pitch_and_speed</span>(<span class="params">data</span>):</span></span><br><span class="line">    y_pitch_speed = data.copy()</span><br><span class="line">    <span class="comment"># you can change low and high here</span></span><br><span class="line">    length_change = np.random.uniform(low=<span class="number">0.8</span>, high=<span class="number">1</span>)</span><br><span class="line">    speed_fac = <span class="number">1.0</span> / length_change</span><br><span class="line">    tmp = np.interp(np.arange(<span class="number">0</span>, <span class="built_in">len</span>(y_pitch_speed), speed_fac), np.arange(<span class="number">0</span>, <span class="built_in">len</span>(y_pitch_speed)), y_pitch_speed)</span><br><span class="line">    minlen = <span class="built_in">min</span>(y_pitch_speed.shape[<span class="number">0</span>], tmp.shape[<span class="number">0</span>])</span><br><span class="line">    y_pitch_speed *= <span class="number">0</span></span><br><span class="line">    y_pitch_speed[<span class="number">0</span>:minlen] = tmp[<span class="number">0</span>:minlen]</span><br><span class="line">    <span class="keyword">return</span> y_pitch_speed</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data_noise = add_noise(audio_np)</span><br><span class="line">data_roll = shift(audio_np)</span><br><span class="line">data_stretch = stretch(audio_np)</span><br><span class="line">pitch_speed = change_pitch_and_speed(audio_np)</span><br><span class="line">value = value_aug(audio_np)</span><br><span class="line">y_harmonic, y_percussive = hpss(audio_np)</span><br><span class="line">y_shift = shift(audio_np)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipd.Audio(data_noise, rate=fs)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">librosa.display.specshow(librosa.amplitude_to_db(magnitude,</span><br><span class="line">                                                  ref=np.<span class="built_in">max</span>),</span><br><span class="line">                          y_axis=<span class="string">&#x27;log&#x27;</span>, x_axis=<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Power spectrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+2.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_32_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mel_s = librosa.feature.melspectrogram(y=y, sr=sr)</span><br><span class="line">print(mel_s.shape)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">librosa.display.specshow(librosa.amplitude_to_db(mel_s,</span><br><span class="line">                                                  ref=np.<span class="built_in">max</span>),</span><br><span class="line">                          y_axis=<span class="string">&#x27;log&#x27;</span>, x_axis=<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Power spectrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+2.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><pre><code>(128, 96)</code></pre><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_33_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mfccs = librosa.feature.mfcc(y=y, sr=sr, n_mfcc=<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">print(mfccs.shape)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(mfccs, x_axis=<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">plt.colorbar()</span><br><span class="line">plt.title(<span class="string">&#x27;MFCC&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><pre><code>(40, 96)</code></pre><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_34_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">librosa.display.specshow(librosa.amplitude_to_db(mfccs,</span><br><span class="line">                                                  ref=np.<span class="built_in">max</span>),</span><br><span class="line">                          y_axis=<span class="string">&#x27;log&#x27;</span>, x_axis=<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Power spectrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+2.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_35_0.png" alt="png"></p><h4 id="ë“¤ë¦¬ëŠ”-ì†Œë¦¬-ë°°ê²½ì¡ìŒ-ëª©ì†Œë¦¬"><a href="#ë“¤ë¦¬ëŠ”-ì†Œë¦¬-ë°°ê²½ì¡ìŒ-ëª©ì†Œë¦¬" class="headerlink" title="ë“¤ë¦¬ëŠ” ì†Œë¦¬ = ë°°ê²½ì¡ìŒ + ëª©ì†Œë¦¬"></a>ë“¤ë¦¬ëŠ” ì†Œë¦¬ = ë°°ê²½ì¡ìŒ + ëª©ì†Œë¦¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">filename_wav = <span class="string">&quot;./wav/voice.wav&quot;</span></span><br><span class="line">filename_noise = <span class="string">&quot;./wav/cafe_noise.wav&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> IPython.display <span class="keyword">as</span> ipd</span><br><span class="line">ipd.Audio(filename_wav)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> IPython.display <span class="keyword">as</span> ipd</span><br><span class="line">ipd.Audio(filename_noise)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">data_wav, sr_wav = librosa.load(filename_wav, mono=<span class="literal">True</span>, sr=<span class="number">16000</span>)</span><br><span class="line">data_noise, sr_noise = librosa.load(filename_noise, mono=<span class="literal">True</span>, sr=<span class="number">16000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(data_wav.shape)</span><br><span class="line">print(data_noise.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ì „ì²´ì ìœ¼ë¡œ ë“¤ë¦¬ëŠ” ì†Œë¦¬ëŠ” ì†Œë¦¬ì˜ í•©( ë°°ê²½ìŒ + ëª©ì†Œë¦¬ )</span></span><br><span class="line">data_wav_noise = data_wav[:] + data_noise[:<span class="built_in">len</span>(data_wav)]</span><br><span class="line"></span><br><span class="line">pos=<span class="number">10</span></span><br><span class="line">print(<span class="string">&quot;wav: &#123;:.8f&#125;, noise &#123;:.8f&#125;, wav+noise: &#123;:.8f&#125;&quot;</span>.<span class="built_in">format</span>(data_wav[pos], data_noise[pos], data_wav_noise[pos]))</span><br></pre></td></tr></table></figure><pre><code>(48944,)(1044712,)wav: -0.00009155, noise -0.00003052, wav + noise: -0.00012207</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipd.Audio(data_wav_noise, rate=<span class="number">16000</span>)</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      <category domain="https://ikarus-999.github.io/tags/Audio/">Audio</category>
      
      
      <comments>https://ikarus-999.github.io/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ë”¥ëŸ¬ë‹-ì…ë¬¸í•˜ê¸°-8</title>
      <link>https://ikarus-999.github.io/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-8/</link>
      <guid>https://ikarus-999.github.io/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-8/</guid>
      <pubDate>Thu, 03 Dec 2020 08:02:23 GMT</pubDate>
      
      <description>ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ í•´ë³´ê¸°
Reference
 * Digital Signal Processing Lecture https://github.com/spatialaudio/digital-signal-processing-lecture 
   
   
 * Python for Signal Processing (unipingco) https://github.com/unpingco/Python-for-Signal-Processing 
   
   
 * Audio for Deep Learning (ë‚¨ê¸°í˜„ë‹˜) https://tykimos.github</description>
      
      
      
      <content:encoded><![CDATA[<h3 id="ì˜¤ë””ì˜¤-ë”¥ëŸ¬ë‹-í•´ë³´ê¸°"><a href="#ì˜¤ë””ì˜¤-ë”¥ëŸ¬ë‹-í•´ë³´ê¸°" class="headerlink" title="ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ í•´ë³´ê¸°"></a>ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ í•´ë³´ê¸°</h3><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><p>Digital Signal Processing Lecture <a href="https://github.com/spatialaudio/digital-signal-processing-lecture">https://github.com/spatialaudio/digital-signal-processing-lecture</a> </p></li><li><p>Python for Signal Processing (unipingco) <a href="https://github.com/unpingco/Python-for-Signal-Processing">https://github.com/unpingco/Python-for-Signal-Processing</a> </p></li><li><p>Audio for Deep Learning (ë‚¨ê¸°í˜„ë‹˜) <a href="https://tykimos.github.io/2019/07/04/ISS_2nd_Deep_Learning_Conference_All_Together/">https://tykimos.github.io/2019/07/04/ISS_2nd_Deep_Learning_Conference_All_Together/</a> </p></li><li><p>ì˜¤ë””ì˜¤ ì „ì²˜ë¦¬ ì‘ì—…ì„ ìœ„í•œ ì—°ìŠµ (ë°•ìˆ˜ì² ë‹˜) <a href="https://github.com/scpark20/audio-preprocessing-practice">https://github.com/scpark20/audio-preprocessing-practice</a> </p></li><li><p>Musical Applications of Machine Learning <a href="https://mac.kaist.ac.kr/~juhan/gct634/">https://mac.kaist.ac.kr/~juhan/gct634/</a> </p></li><li><p>Awesome audio study materials for Korean (ìµœê·¼ìš°ë‹˜) <a href="https://github.com/keunwoochoi/awesome-audio-study-materials-for-korean">https://github.com/keunwoochoi/awesome-audio-study-materials-for-korean</a></p></li><li><p>T Academy(ì¶œì²˜) <a href="https://tacademy.skplanet.com/live/player/onlineLectureDetail.action?seq=178">https://tacademy.skplanet.com/live/player/onlineLectureDetail.action?seq=178</a></p></li></ul><h2 id="1-Digital-Signal-Processing"><a href="#1-Digital-Signal-Processing" class="headerlink" title="1. Digital Signal Processing"></a>1. Digital Signal Processing</h2><p>ì†Œë¦¬ signalë¥¼ ì–´ë– í•œ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ í‘œí˜„í•˜ë©°, ì†Œë¦¬ì™€ ê´€ë ¨ëœ taskë¥¼ í•´ê²°í•˜ëŠ”ë° ìˆìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì†Œë¦¬ëŠ” ì–´ë– í•œ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆì„ê¹Œìš”?</p><h3 id="Sound"><a href="#Sound" class="headerlink" title="Sound?"></a>Sound?</h3><p>ì†Œë¦¬ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì§„ë™ìœ¼ë¡œ ì¸í•œ ê³µê¸°ì˜ ì••ì¶•ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì••ì¶•ì´ ì–¼ë§ˆë‚˜ ë¬ëŠëƒì— ë”°ë¼ì„œ í‘œí˜„ë˜ê²ƒì´ ë°”ë¡œ Wave(íŒŒë™)ì¸ë°ìš”. íŒŒë™ì€ ì§„ë™í•˜ë©° ê³µê°„/ë§¤ì§ˆì„ ì „íŒŒí•´ ë‚˜ê°€ëŠ” í˜„ìƒì…ë‹ˆë‹¤. ì§ˆëŸ‰ì˜ ì´ë™ì€ ì—†ì§€ë§Œ ì—ë„ˆì§€/ìš´ë™ëŸ‰ì˜ ìš´ë°˜ì€ ì¡´ì¬í•©ë‹ˆë‹¤.</p><p>Waveì—ì„œ ì €í¬ê°€ ì–»ì„ìˆ˜ ìˆëŠ” ì •ë³´ëŠ” í¬ê²Œ 3ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.</p><ul><li>Phase(Degress of displacement) : ìœ„ìƒ</li><li>Amplitude(Intensity) : ì§„í­</li><li>Frequency : ì£¼íŒŒìˆ˜</li></ul><h3 id="Sampling"><a href="#Sampling" class="headerlink" title="Sampling"></a>Sampling</h3><p>ìƒ˜í”Œë§ì€ ë¬´ì—‡ì¼ê¹Œìš”?? ì•„ë‚ ë¡œê·¸ ì •ë³´ë¥¼ ì˜ê²Œ ìª¼ê°œì„œ discreteí•œ ë””ì§€í„¸ ì •ë³´ë¡œ í‘œí˜„í•´ì•¼í•©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ë¬´í•œí•˜ê²Œ ìª¼ê°œì„œ ì €ì¥í• ìˆ˜ ì—†ìœ¼ë‹ˆ, ì–´ë–¤ ê¸°ì¤€ì„ ê°€ì§€ê³  ì•„ë‚ ë¡œê·¸ ì •ë³´ë¥¼ ìª¼ê°œì„œ ëŒ€í‘œê°’ì„ ì·¨í•˜ê²Œ ë©ë‹ˆë‹¤.</p><p><code>Convert into a sqeuence of binary values via Sampling and Quantization</code></p><h3 id="1-1-Time-domain"><a href="#1-1-Time-domain" class="headerlink" title="1.1. Time domain"></a>1.1. Time domain</h3><p>ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ì•„ë‚ ë¡œê·¸ ì‹œê·¸ë„ì„ ìª¼ê°œê²Œ ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. Samplingì„ í†µí•˜ì—¬ ì»´í“¨í„°ëŠ” ì†Œë¦¬ sequenceë¥¼ binary valueë¡œ ë°›ì•„ë“œë¦¬ê²Œ ë©ë‹ˆë‹¤.</p><p><strong>Sampling rate : ì–¼ë§ˆë‚˜ ì˜ê²Œ ìª¼ê°¤ ê²ƒì¸ê°€?</strong><br><br>ì˜ê°œ ìª¼ê°¤ìˆ˜ë¡ ì›ë³¸ ë°ì´í„°ì™€ ê±°ì´ ê°€ê¹Œì›Œì§€ê¸° ë–„ë¬¸ì— ì¢‹ì§€ë§Œ Dataì˜ ì–‘ì´ ì¦ê°€í•˜ê²Œ ë©ë‹ˆë‹¤. ë§Œì•½ ë„ˆë¬´ í¬ê²Œ ìª¼ê°œê²Œ ëœë‹¤ë©´, ì›ë³¸ ë°ì´í„°ë¡œ reconstructí•˜ê¸° í˜ë“¤ì–´ ì§ˆ ê²ƒì…ë‹ˆë‹¤.</p><p><strong>Sampling theorem</strong><br><br>ìƒ˜í”Œë§ ë ˆì´íŠ¸ê°€ ìµœëŒ€ frequencyì˜ 2ë°° ë³´ë‹¤ ì»¤ì ¸ì•¼ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.<br>$ f_{s} &gt; 2f_{m} $ ì—¬ê¸°ì„œ $f_{s}$ëŠ” sampling rate, ê·¸ë¦¬ê³  $f_{m}$ì€ maximum frequencyë¥¼ ë§í•©ë‹ˆë‹¤.</p><ul><li>Nyqusit frequency = $f_{s}/2$, sampling rateì˜ ì ˆë°˜ì…ë‹ˆë‹¤.</li></ul><p>ì¼ë°˜ì ìœ¼ë¡œ Samplingì€ ì¸ê°„ì˜ ì²­ê° ì˜ì—­ì— ë§ê²Œ í˜•ì„±ì´ ë©ë‹ˆë‹¤.</p><ul><li>Audio CD : 44.1 kHz(44100 sample/second)</li><li>Speech communication : 8 kHz(8000 sample/second)</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># library load</span></span><br><span class="line"><span class="keyword">import</span> soundfile <span class="keyword">as</span> sf</span><br><span class="line"><span class="keyword">import</span> librosa</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename = <span class="string">&quot;./wav/voice.wav&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># íŒŒì¼ ë¡œë“œ ë°©ë²• 1</span></span><br><span class="line">y, sr = sf.read(filename, dtype=<span class="string">&#x27;int16&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;Sample Rate: &quot;</span>, sr)</span><br><span class="line">print(<span class="string">&quot;DATA: &quot;</span>, <span class="built_in">type</span>(y), y.shape, <span class="built_in">len</span>(y), y)</span><br><span class="line"></span><br><span class="line">dur = <span class="built_in">len</span>(y) / sr</span><br><span class="line">print(<span class="string">&quot;dur : &quot;</span>, dur)</span><br></pre></td></tr></table></figure><pre><code>Sample Rate:  16000DATA:  &lt;class &#39;numpy.ndarray&#39;&gt; (48944,) 48944 [ -9   1  -5 ... -20 -16 -24]dur :  3.059</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># íŒŒì¼ ë¡œë“œ ë°©ë²• 2</span></span><br><span class="line">y, sr = librosa.load(filename, mono=<span class="literal">True</span>, sr=<span class="number">16000</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;Sample Rate: &quot;</span>, sr)</span><br><span class="line">print(<span class="string">&quot;DATA: &quot;</span>, <span class="built_in">type</span>(y), y.shape, y)</span><br><span class="line">dur = <span class="built_in">len</span>(y) / sr</span><br><span class="line">print(<span class="string">&quot;dur : &quot;</span>, dur)</span><br></pre></td></tr></table></figure><pre><code>Sample Rate:  16000DATA:  &lt;class &#39;numpy.ndarray&#39;&gt; (48944,) [-2.7465820e-04  3.0517578e-05 -1.5258789e-04 ... -6.1035156e-04 -4.8828125e-04 -7.3242188e-04]dur :  3.059</code></pre><h3 id="Resampling"><a href="#Resampling" class="headerlink" title="Resampling"></a>Resampling</h3><p>ìƒ˜í”Œë§ëœ ë°ì´í„°ë¥¼ ë‹¤ì‹œê¸ˆ ë” ë†’ì€ sampling rate í˜¹ì€ ë” ë‚®ì€ sampling rateë¡œ ë‹¤ì‹œ ìƒ˜í”Œë§í• ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë•ŒëŠ” ì¼ë°˜ì ìœ¼ë¡œ interpolation(ë³´ê°„)ì„ í• ë•ŒëŠ” low-pass filterë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.(Windowed sinc function)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> IPython.display <span class="keyword">as</span> ipd</span><br><span class="line">y_8k = librosa.resample(y, sr, <span class="number">8000</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipd.Audio(y_8k, rate=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(y_8k)</span><br></pre></td></tr></table></figure><pre><code>24472</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># duration</span></span><br><span class="line"><span class="built_in">len</span>(y_8k)/<span class="number">8000</span></span><br></pre></td></tr></table></figure><pre><code>3.059</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_2k = librosa.resample(y, sr, <span class="number">4000</span>)</span><br><span class="line">ipd.Audio(y_2k, rate=<span class="number">2000</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(y_2k)</span><br></pre></td></tr></table></figure><pre><code>12236</code></pre><h3 id="Nomalization-amp-Quantization"><a href="#Nomalization-amp-Quantization" class="headerlink" title="Nomalization &amp; Quantization"></a>Nomalization &amp; Quantization</h3><p>ì‹œê°„ì˜ ê¸°ì¤€ì´ ì•„ë‹Œ ì‹¤ì œ amplitudeì˜ real valued ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‹œê·¸ë„ì˜ ê°’ì„ ì¡°ì ˆí•©ë‹ˆë‹¤. Amplitudeë¥¼ ì´ì‚°ì ì¸ êµ¬ê°„ìœ¼ë¡œ ë‚˜ëˆ„ê³ , signal ë°ì´í„°ì˜ Amplitudeë¥¼ ë°˜ì˜¬ë¦¼í•˜ê²Œ ë©ë‹ˆë‹¤.</p><p>ê·¸ë ‡ë‹¤ë©´ ì´ì‚°ì ì¸ êµ¬ê°„ì€ ì–´ë–»ê²Œ ë‚˜ëˆŒìˆ˜ ìˆì„ê¹Œìš”?, bitì˜ ë¹„íŠ¸ì— ì˜í•´ì„œ ê²°ì •ë©ë‹ˆë‹¤. </p><ul><li>B bitì˜ Quantization : $-2^{B-1}$ ~ $2^{B-1}-1$</li><li>Audio CDì˜ Quantization (16 bits) : $-2^{15}$ ~ $2^{15}-1$</li><li>ìœ„ ê°’ë“¤ì€ ë³´í†µ -1.0 ~ 1.0  ì˜ì—­ìœ¼ë¡œ scalingë˜ê¸°ë„ í•©ë‹ˆë‹¤.</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Normalize</span></span><br><span class="line">normed_wav = y / <span class="built_in">max</span>(np.<span class="built_in">abs</span>(y))</span><br><span class="line">ipd.Audio(normed_wav, rate=sr)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#quantization í•˜ë©´ ìŒì§ˆì€ ë–¨ì–´ì§€ì§€ë§Œ lightí•œ ìë£Œí˜•ì´ ëœë‹¤.</span></span><br><span class="line">Bit = <span class="number">8</span></span><br><span class="line">max_value = <span class="number">2</span> ** (Bit<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">quantized_8_wav = normed_wav * max_value</span><br><span class="line">quantized_8_wav = np.<span class="built_in">round</span>(quantized_8_wav).astype(<span class="built_in">int</span>)</span><br><span class="line">quantized_8_wav = np.clip(quantized_8_wav, -max_value, max_value<span class="number">-1</span>)</span><br><span class="line">ipd.Audio(quantized_8_wav, rate=sr)</span><br></pre></td></tr></table></figure><h3 id="mu-law-encoding"><a href="#mu-law-encoding" class="headerlink" title="mu-law encoding"></a>mu-law encoding</h3><p>ì‚¬ëŒì˜ ê·€ëŠ” ì†Œë¦¬ì˜ amplitudeì— ëŒ€í•´ logì ìœ¼ë¡œ ë°˜ì‘í•©ë‹ˆë‹¤. ì¦‰, ì‘ì€ì†Œë¦¬ì˜ ì°¨ì´ëŠ” ì˜ì¡ì•„ë‚´ëŠ”ë° ë°˜í•´ ì†Œë¦¬ê°€ ì»¤ì§ˆìˆ˜ë¡ ê·¸ ì°¨ì´ë¥¼ ì˜ ëŠë¼ì§€ ëª»í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ íŠ¹ì„±ì„ waveê°’ì„ í‘œí˜„í•˜ëŠ”ë° ë°˜ì˜í•´ì„œ ì‘ì€ê°’ì—ëŠ” ë†’ì€ ë¶„ë³„ë ¥(high resolution)ì„, í°ê°’ë¼ë¦¬ëŠ” ë‚®ì€ ë¶„ë³„ë ¥(low resolution)ì„ ê°–ë„ë¡ í•©ë‹ˆë‹¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mu_law</span>(<span class="params">x, mu=<span class="number">255</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> np.sign(x) * np.log(<span class="number">1</span> + mu * np.<span class="built_in">abs</span>(x)) / np.log(<span class="number">1</span> + mu)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = np.linspace(<span class="number">-1</span>, <span class="number">1</span>, <span class="number">1000</span>)</span><br><span class="line">x_mu = mu_law(x)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=[<span class="number">6</span>, <span class="number">4</span>])</span><br><span class="line">plt.plot(x)</span><br><span class="line">plt.plot(x_mu)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-8/output_18_0.png" alt="png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wav_mulaw = mu_law(normed_wav)</span><br><span class="line">ipd.Audio(wav_mulaw, rate=sr)</span><br></pre></td></tr></table></figure><blockquote><p>to be continuedâ€¦<br>ë’·ì¥ì—ì„œ ê³„ì†ë©ë‹ˆë‹¤.</p></blockquote>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      <category domain="https://ikarus-999.github.io/tags/Audio/">Audio</category>
      
      
      <comments>https://ikarus-999.github.io/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-8/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ë”¥ëŸ¬ë‹-ì…ë¬¸ê³¼-ì¤€ë¹„7</title>
      <link>https://ikarus-999.github.io/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/</link>
      <guid>https://ikarus-999.github.io/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/</guid>
      <pubDate>Sun, 29 Nov 2020 17:54:54 GMT</pubDate>
      
      <description>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-7
í•©ì„±ê³±(Convolution)
 Convolution?


 ì •ì˜
í•©ì„±ê³± ì—°ì‚°ì€ ë‘ í•¨ìˆ˜ f, g ê°€ìš´ë° í•˜ë‚˜ì˜ í•¨ìˆ˜ë¥¼ ë°˜ì „(reverse), ì „ì´(shift)ì‹œí‚¨ ë‹¤ìŒ, ë‹¤ë¥¸ í•˜ë‚˜ì˜ í•¨ìˆ˜ì™€ ê³±í•œ ê²°ê³¼ë¥¼ ì ë¶„í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì´ë¥¼ ìˆ˜í•™ ê¸°í˜¸ë¡œ í‘œì‹œí•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.


 ë˜í•œ g í•¨ìˆ˜ ëŒ€ì‹ ì— f í•¨ìˆ˜ë¥¼ ë°˜ì „, ì „ì´ ì‹œí‚¤ëŠ” ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ í‘œì‹œí•  ìˆ˜ë„ ìˆë‹¤. ì´ ë‘ ì—°ì‚°ì€ í˜•íƒœëŠ” ë‹¤ë¥´ì§€ë§Œ ê°™ì€ ê²°ê³¼ê°’ì„ ê°–ëŠ”ë‹¤.


 ìœ„ì˜ ì ë¶„ì—ì„œ ì ë¶„ êµ¬ê°„ì€ í•¨ìˆ˜ fì™€ gê°€ ì •ì˜ëœ ë²”ìœ„ì— ë”°ë¼ì„œ ë‹¬ë¼ì§„ë‹¤.

 ë˜í•œ ë‘ í™•ë¥ </description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-7"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-7" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-7"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-7</h2><h3 id="í•©ì„±ê³±-Convolution"><a href="#í•©ì„±ê³±-Convolution" class="headerlink" title="í•©ì„±ê³±(Convolution)"></a>í•©ì„±ê³±(Convolution)</h3><p>  Convolution?<br>  <img src="/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/conv_1.png" alt="conv">  </p><p>  <strong>ì •ì˜</strong><br>  í•©ì„±ê³± ì—°ì‚°ì€ ë‘ í•¨ìˆ˜ f, g ê°€ìš´ë° í•˜ë‚˜ì˜ í•¨ìˆ˜ë¥¼ ë°˜ì „(reverse), ì „ì´(shift)ì‹œí‚¨ ë‹¤ìŒ, ë‹¤ë¥¸ í•˜ë‚˜ì˜ í•¨ìˆ˜ì™€ ê³±í•œ ê²°ê³¼ë¥¼ ì ë¶„í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì´ë¥¼ ìˆ˜í•™ ê¸°í˜¸ë¡œ í‘œì‹œí•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.<br>  <img src="/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/1.PNG" alt="1"></p><p>  ë˜í•œ g í•¨ìˆ˜ ëŒ€ì‹ ì— f í•¨ìˆ˜ë¥¼ ë°˜ì „, ì „ì´ ì‹œí‚¤ëŠ” ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ í‘œì‹œí•  ìˆ˜ë„ ìˆë‹¤. ì´ ë‘ ì—°ì‚°ì€ í˜•íƒœëŠ” ë‹¤ë¥´ì§€ë§Œ ê°™ì€ ê²°ê³¼ê°’ì„ ê°–ëŠ”ë‹¤.<br>  <img src="/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/2.PNG" alt="2"></p><p>  ìœ„ì˜ ì ë¶„ì—ì„œ ì ë¶„ êµ¬ê°„ì€ í•¨ìˆ˜ fì™€ gê°€ ì •ì˜ëœ ë²”ìœ„ì— ë”°ë¼ì„œ ë‹¬ë¼ì§„ë‹¤.</p><p>  ë˜í•œ ë‘ í™•ë¥  ë³€ìˆ˜ Xì™€ Yê°€ ìˆì„ ë•Œ ê°ê°ì˜ í™•ë¥  ë°€ë„ í•¨ìˆ˜ë¥¼ fì™€ gë¼ê³  í•˜ë©´, X+Yì˜ í™•ë¥  ë°€ë„ í•¨ìˆ˜ëŠ” $$f * g$$ë¡œ í‘œì‹œí•  ìˆ˜ ìˆë‹¤. â€“ <a href="https://ko.wikipedia.org/wiki/%ED%95%A9%EC%84%B1%EA%B3%B1">Wikipedia</a></p><blockquote><p>ë¬´ì—‡ì¸ì§€ ëª¨ë¥´ê² ì£ ? ì‰½ê²Œ ë§í•˜ìë©´<br>  ê¸°ì¡´ MLPì—ì„œëŠ” ì´ë¯¸ì§€ê°€ ì‚´ì§ì´ë¼ë„ íšŒì „ì´ ë˜ê±°ë‚˜ ìœ„ì¹˜ ì´ë™ì´ ìˆë‹¤ë©´ ì‹ ê²½ë§ ìì²´ë¥¼ ë‹¤ì‹œ í•™ìŠµí•´ì•¼ í•˜ì§€ë§Œ<br>  CNNì€ ì´ë¯¸ì§€ì˜ ë³€í™”ê°€ ìˆì–´ë„ ì¬í•™ìŠµ ì—†ì–´ë„ ê°€ëŠ¥í•¨.</p></blockquote><p>  <img src="/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/conv_2.PNG" alt="conv2"><br>  ëª¨ë“  pixelì„ ë¹„êµí•  ê²Œ ì ˆëŒ€ ì•„ë‹˜. Feature ì¶”ì¶œì— ì¤‘ì ì„ ë‘ .</p><p>  <img src="/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/conv_3.PNG" alt="conv3"><br>  $$C_in$$*$$C_out$$ ë²ˆì˜ í•©ì„±ê³± ì—°ì‚°<br>  biasëŠ” í•˜ë‚˜ì˜ ë²¡í„°</p><p>  Filter(kernel)ì˜ í¬ê¸°ì— ë”°ë¼ ì˜ìƒì˜ í¬ê¸°ê°€ ì¤„ì–´ë“œëŠ” ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ paddingì„ ì“´ë‹¤.<br>  <img src="/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/conv_4.PNG" alt="conv4"><br>  í¬ê¸°ê°€ (2N + 1)ì¸ ì»¤ë„ì— ìƒí•˜ì¢Œìš°ì— Nê°œ Zero paddingì„ í•´ì£¼ë©´ ëœë‹¤.</p><p>  Sliding Window ë°©ì‹ìœ¼ë¡œ ì»¤ë„ì´ ì´ë™ë˜ëŠ”ë° ê·¸ í¬ê¸°ë¥¼ ì¡°ì ˆí•˜ë ¤ë©´ Strideë¥¼ ì“´ë‹¤.<br>  ë„ˆë¬´ í¬ë©´ ì¶œë ¥ Feature Mapì´ ê³¼ë„í•˜ê²Œ ì¤„ì–´ë“œëŠ” ê²½ìš°ê°€ ë°œìƒí•œë‹¤.</p><h3 id="ë³´ë‹¤-íš¨ìœ¨ì ì¸-Conv-ì—°ì‚°ì„-í•˜ê¸°-ìœ„í•´ì„œëŠ”-1x1-Convë¥¼-ë„£ëŠ”ë‹¤"><a href="#ë³´ë‹¤-íš¨ìœ¨ì ì¸-Conv-ì—°ì‚°ì„-í•˜ê¸°-ìœ„í•´ì„œëŠ”-1x1-Convë¥¼-ë„£ëŠ”ë‹¤" class="headerlink" title="ë³´ë‹¤ íš¨ìœ¨ì ì¸ Conv ì—°ì‚°ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” 1x1 Convë¥¼ ë„£ëŠ”ë‹¤"></a>ë³´ë‹¤ íš¨ìœ¨ì ì¸ Conv ì—°ì‚°ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” 1x1 Convë¥¼ ë„£ëŠ”ë‹¤</h3><p>  ì—°ì‚°ëŸ‰, íŒŒë¼ë¯¸í„° ê°œìˆ˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ BottleNeck êµ¬ì¡°ë¥¼ í™œìš©í•œë‹¤.<br>  í•˜í•„ 1x1 ??<br>  <img src="/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/conv_5.PNG" alt="conv5"><br>  3x3 filter í•œê°œì™€ 1x1 + 3x3 parameter ë¹„êµ</p><p>  ê·¸ë˜ë„ ëª¨ë¥´ê² ë‹¤ë©´??</p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random((<span class="number">3</span>, <span class="number">3</span>)).shape == (np.random((<span class="number">3</span>, <span class="number">1</span>)) * np.random((<span class="number">1</span>, <span class="number">3</span>)).shape)</span><br><span class="line">&gt;&gt; <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># keras</span></span><br><span class="line"><span class="comment"># k - kernel_size(ex. 3, 5, 7...)</span></span><br><span class="line"><span class="comment"># n_filter - number of filters/channels í•„í„° ê°¯ìˆ˜</span></span><br><span class="line">conv1_1 = Conv(n_filters, (<span class="number">1</span>, k))(input_1)</span><br><span class="line">conv1_2 = Conv(n_filters, (k, <span class="number">1</span>))(conv1_1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ì™œ ë³‘ëª©?</span></span><br><span class="line">conv2 = Conv2D(<span class="number">96</span>, (<span class="number">1</span>, <span class="number">1</span>), ...)(conv1) </span><br><span class="line"><span class="comment"># ì¤„ì˜€ë‹¤ê°€(receptive FieldëŠ” ê·¸ëŒ€ë¡œ, Feature mapì„ ë¯¸ë¦¬ ì¤„ì„.)</span></span><br><span class="line">conv3 = Conv2D(<span class="number">96</span>, (<span class="number">3</span>, <span class="number">3</span>), ...)(conv2) </span><br><span class="line">conv4 = Conv2D(<span class="number">128</span>, (<span class="number">1</span>, <span class="number">1</span>), ...)(conv3) <span class="comment"># ë‹¤ì‹œ ëŠ˜ë¦¼</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>  í•­ë“±í–‰ë ¬ì„ ë– ì˜¬ë¦¬ë©´ ì´í•´ê°€ ê°ˆê²ƒì´ë‹¤.</p><h3 id="CNN-ë§Œë“¤ì—ˆëŠ”ë°-ë„ˆë¬´-ëŠë¦¬ë„¤-ì–´ë–»ê²Œ-í•˜ë©´-ë¹ ë¥´ê²Œ-í• -ìˆ˜-ìˆì„ê¹Œâ€¦"><a href="#CNN-ë§Œë“¤ì—ˆëŠ”ë°-ë„ˆë¬´-ëŠë¦¬ë„¤-ì–´ë–»ê²Œ-í•˜ë©´-ë¹ ë¥´ê²Œ-í• -ìˆ˜-ìˆì„ê¹Œâ€¦" class="headerlink" title="CNN ë§Œë“¤ì—ˆëŠ”ë° ë„ˆë¬´ ëŠë¦¬ë„¤? ì–´ë–»ê²Œ í•˜ë©´ ë¹ ë¥´ê²Œ í•  ìˆ˜ ìˆì„ê¹Œâ€¦"></a>CNN ë§Œë“¤ì—ˆëŠ”ë° ë„ˆë¬´ ëŠë¦¬ë„¤? ì–´ë–»ê²Œ í•˜ë©´ ë¹ ë¥´ê²Œ í•  ìˆ˜ ìˆì„ê¹Œâ€¦</h3><p>  Conv filterë¥¼ ë” ë„“ê²Œ ì“´ë‹¤. â€“&gt; GPU ì—°ì‚°ì´ ì‰¬ì›Œì§„ë‹¤  </p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ì´ë ‡ê²Œ ë˜ì–´ìˆëŠ” ê±¸</span></span><br><span class="line">conv = Conv2D(<span class="number">96</span>, (<span class="number">3</span>, <span class="number">3</span>), ...)(conv)</span><br><span class="line">conv = Conv2D(<span class="number">96</span>, (<span class="number">3</span>, <span class="number">3</span>), ...)(conv)</span><br><span class="line"><span class="comment"># ì•„ë˜ì²˜ëŸ¼ ë°”ê¾¼ë‹¤.</span></span><br><span class="line">conv = Conv2D(<span class="number">128</span>, (<span class="number">3</span>, <span class="number">3</span>), ...)(conv)</span><br></pre></td></tr></table></figure><blockquote><p>GPUëŠ” ë³‘ë ¬ë¡œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— í•„í„° ê°¯ìˆ˜ë¥¼ ëŠ˜ë¦¬ë©´ ë”ìš± ë¹¨ë¼ì§„ë‹¤.<br>  ì‰½ê²Œ ë§í•˜ë©´ 96ê°œì”© ë‘ë²ˆë³´ë‹¤ 128ê°œì”© í•œë²ˆì´ ë” ë¹ ë¥´ë‹¤.  </p></blockquote><p>  ì„¤ëª….</p><ol><li><p>96 // 3 = 32</p></li><li><p>2- layerì„ 1- layerë¡œ ë°”ê¿€ë•</p></li><li><p>32 // 2 = 16</p></li><li><p>16^0.5 = 4</p></li><li><p>4 * 32 = 128</p><p>ë˜ ë‹¤ë¥¸ ë°©ë²•<br>ê° ì±„ë„ì—ì„œ ë³„ë„ì˜ 2d convë¥¼ í•˜ëŠ” ë°©ë²•<br>in_channels * channel_multipliter ì¤‘ê°„ì±„ë„ì€ ì—°ê²°ë˜ê³  1x1 convë¡œ out_channelsì— ë§¤í•‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Keras</span></span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> SeparableConv2D</span><br><span class="line">net = SeparableConv2D(<span class="number">32</span>, (<span class="number">3</span>, <span class="number">3</span>))(net)</span><br><span class="line"><span class="comment"># it&#x27;s almost 1:1 similar to the simple Keras Conv2D layer</span></span><br></pre></td></tr></table></figure><p>ì¶œì²˜ :<br><a href="https://colab.research.google.com/drive/1i0Fwh-d8kF05o4QRfJG5dZt_P7G85MCS">source1</a><br><a href="https://towardsdatascience.com/speeding-up-convolutional-neural-networks-240beac5e30f">source2</a></p></li></ol>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>R ë„ì ì—¬ë³´ê¸°</title>
      <link>https://ikarus-999.github.io/2020/11/29/R-%EB%81%84%EC%A0%81%EC%97%AC%EB%B3%B4%EA%B8%B0/</link>
      <guid>https://ikarus-999.github.io/2020/11/29/R-%EB%81%84%EC%A0%81%EC%97%AC%EB%B3%B4%EA%B8%B0/</guid>
      <pubDate>Sun, 29 Nov 2020 02:54:10 GMT</pubDate>
      
      <description>R ì‹œì‘í•´ë³´ê¸°
R ë³€ìˆ˜
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="R-ì‹œì‘í•´ë³´ê¸°"><a href="#R-ì‹œì‘í•´ë³´ê¸°" class="headerlink" title="R ì‹œì‘í•´ë³´ê¸°"></a>R ì‹œì‘í•´ë³´ê¸°</h2><h3 id="R-ë³€ìˆ˜"><a href="#R-ë³€ìˆ˜" class="headerlink" title="R ë³€ìˆ˜"></a>R ë³€ìˆ˜</h3>  <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">v1 &lt;-<span class="built_in">c</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">NA</span>) <span class="comment"># ë²¡í„°</span></span><br><span class="line"></span><br><span class="line">v2 &lt;- <span class="string">&#x27;a&#x27;</span> <span class="comment"># ë™ì  ë³€ìˆ˜ì— ë¬¸ì assign</span></span><br><span class="line"></span><br><span class="line">v2 = <span class="string">&#x27;a&#x27;</span> <span class="comment"># ì •ì  ë³€ìˆ˜</span></span><br><span class="line"></span><br><span class="line">rm(v1, v2) <span class="comment"># ë³€ìˆ˜ ì§€ìš°ê¸°</span></span><br><span class="line"></span><br><span class="line">v1 &lt;- <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">v2 &lt;- <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="literal">NA</span>) <span class="comment"># Error</span></span><br><span class="line">v3 &lt;- <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="literal">NULL</span>) <span class="comment"># ok</span></span><br><span class="line">mean(v1)</span><br><span class="line">mean(v2) <span class="comment"># Error</span></span><br><span class="line">mean(v3) <span class="comment"># ok</span></span><br><span class="line"><span class="literal">TRUE</span> | <span class="literal">TRUE</span> <span class="comment"># TRUE</span></span><br><span class="line"><span class="literal">TRUE</span> | <span class="literal">FALSE</span> <span class="comment"># TRUE</span></span><br><span class="line">!<span class="literal">TRUE</span> <span class="comment"># ë’¤ì§‘ê¸° ì—°ì‚°</span></span><br><span class="line">!<span class="literal">FALSE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ë²”ì£¼í˜• ë³€ìˆ˜</span></span><br><span class="line">key &lt;- factor(<span class="string">&#x27;m&#x27;</span>, <span class="built_in">c</span>(<span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;f&#x27;</span>))</span><br><span class="line"></span><br><span class="line">nlevels(key)</span><br><span class="line">levels(key)[<span class="number">1</span>] <span class="comment"># 1ë ˆë²¨ ì¶”ì¶œ</span></span><br><span class="line">levels(key)[<span class="number">2</span>] <span class="comment"># ì¢…ë¥˜ ì¶”ì¶œ</span></span><br><span class="line"></span><br><span class="line">levels(key) &lt;- <span class="built_in">c</span>(<span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;f&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#vector</span></span><br><span class="line">x &lt;- <span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line">x</span><br><span class="line">y &lt;- <span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="string">&quot;a&quot;</span>)</span><br><span class="line">y</span><br><span class="line"><span class="built_in">names</span>(x) &lt;- <span class="built_in">c</span>(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>,<span class="string">&quot;e&quot;</span>)</span><br><span class="line">x</span><br><span class="line">x[<span class="number">1</span>]</span><br><span class="line">x[<span class="number">2</span>]</span><br><span class="line">x[-<span class="number">1</span>]</span><br><span class="line">x[-<span class="number">2</span>]</span><br><span class="line">x[<span class="number">1</span>:<span class="number">3</span>]</span><br><span class="line">x[<span class="number">3</span>:<span class="number">5</span>]</span><br><span class="line">x[<span class="string">&quot;a&quot;</span>]</span><br><span class="line"><span class="built_in">names</span>(x)[<span class="number">2</span>]</span><br><span class="line"><span class="built_in">length</span>(x)</span><br><span class="line">nrow(x)</span><br><span class="line">NROW(x)</span><br><span class="line"></span><br><span class="line">seq(<span class="number">1</span>,<span class="number">10</span>) <span class="comment"># range</span></span><br><span class="line">seq(<span class="number">1</span>:<span class="number">10</span>)</span><br><span class="line">seq(<span class="number">1</span>,<span class="number">10</span>,<span class="number">1</span>)</span><br><span class="line">seq(<span class="number">1</span>,<span class="number">10</span>,<span class="number">3</span>)</span><br><span class="line">NROW(seq(<span class="number">1</span>,<span class="number">10</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">rep</span>(<span class="number">1</span>:<span class="number">10</span>, times=<span class="number">2</span>) <span class="comment">#ë°˜ë³µ</span></span><br><span class="line"><span class="built_in">rep</span>(<span class="number">1</span>:<span class="number">10</span>, each=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">rep</span>(<span class="number">1</span>:<span class="number">10</span>, each=<span class="number">2</span>, times=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#list</span></span><br><span class="line">x &lt;- <span class="built_in">list</span>(name=<span class="string">&quot;jo&quot;</span>, he=<span class="string">&quot;999&quot;</span>)</span><br><span class="line">x</span><br><span class="line"></span><br><span class="line">x$name</span><br><span class="line">x$he</span><br><span class="line"></span><br><span class="line">x[<span class="number">1</span>]</span><br><span class="line">x[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">x[[<span class="number">1</span>]] <span class="comment"># ì¸ë±ì‹±</span></span><br><span class="line"></span><br><span class="line">x[[<span class="number">2</span>]]</span><br><span class="line"></span><br><span class="line">y &lt;- <span class="built_in">list</span>(name=<span class="string">&quot;k&quot;</span>, he=<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">y</span><br><span class="line">y[[<span class="number">1</span>]]</span><br><span class="line">y[[<span class="number">2</span>]]</span><br><span class="line"></span><br><span class="line">z &lt;- <span class="built_in">list</span>(<span class="built_in">c</span>(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>), <span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line">z</span><br><span class="line"></span><br><span class="line">z[[<span class="number">1</span>]][<span class="number">2</span>]</span><br><span class="line">z[[<span class="number">2</span>]][-<span class="number">1</span>]</span><br><span class="line">z[[<span class="number">2</span>]][<span class="number">2</span>:<span class="number">4</span>]</span><br><span class="line"><span class="built_in">length</span>(z[[<span class="number">1</span>]])</span><br><span class="line"><span class="built_in">length</span>(z[[<span class="number">2</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment">#matrix</span></span><br><span class="line">matrix(<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>), nrow=<span class="number">2</span>)</span><br><span class="line">matrix(<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>), nrow=<span class="number">5</span>)</span><br><span class="line">m &lt;- matrix(<span class="number">1</span>:<span class="number">9</span>, nrow=<span class="number">3</span>, dimnames=<span class="built_in">list</span>(<span class="built_in">c</span>(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>),<span class="built_in">c</span>(<span class="string">&quot;A&quot;</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&quot;C&quot;</span>)))</span><br><span class="line">m</span><br><span class="line"></span><br><span class="line">rownames(m)</span><br><span class="line">colnames(m)</span><br><span class="line"></span><br><span class="line">m[<span class="number">1</span>:<span class="number">2</span>,]</span><br><span class="line">m[,<span class="number">1</span>:<span class="number">2</span>]</span><br><span class="line">m[<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line">m[<span class="number">3</span>,<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">m[-<span class="number">1</span>,]</span><br><span class="line">m[,-<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">m[-<span class="number">1</span>,-<span class="number">2</span>]</span><br><span class="line">m[-<span class="number">1</span>,-<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">m[m[,<span class="number">3</span>]&gt;<span class="number">8</span>,]</span><br><span class="line"><span class="comment">#m[m[2:3]2]</span></span><br><span class="line"></span><br><span class="line">m[m[,<span class="number">3</span>]&gt;=<span class="number">8</span>,<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>)]</span><br><span class="line">m[<span class="built_in">c</span>(<span class="number">2</span>,<span class="number">3</span>),<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>)]</span><br><span class="line">m[m[,<span class="number">3</span>]&gt;=<span class="number">8</span>,m[<span class="number">1</span>,]&lt;<span class="number">5</span>]</span><br><span class="line">m</span><br><span class="line">m[<span class="built_in">c</span>(<span class="number">2</span>,<span class="number">3</span>),<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#array</span></span><br><span class="line">array(<span class="number">1</span>:<span class="number">12</span>, <span class="built_in">dim</span>=<span class="built_in">c</span>(<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line">x &lt;- array(<span class="number">1</span>:<span class="number">12</span>, <span class="built_in">dim</span>=<span class="built_in">c</span>(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">x</span><br><span class="line">x[,,<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">m[<span class="number">1</span>,]</span><br><span class="line"></span><br><span class="line">m1 &lt;- matrix(<span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>), nrow=<span class="number">5</span>)</span><br><span class="line">m1</span><br><span class="line"></span><br><span class="line">name &lt;- <span class="built_in">c</span>(<span class="string">&quot;kim&quot;</span>, <span class="string">&quot;lee&quot;</span>, <span class="string">&quot;park&quot;</span>)</span><br><span class="line">age &lt;- <span class="built_in">c</span>(<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>)</span><br><span class="line">gender &lt;-factor(<span class="built_in">c</span>(<span class="string">&quot;M&quot;</span>,<span class="string">&quot;F&quot;</span>,<span class="string">&quot;M&quot;</span>))</span><br><span class="line">df &lt;- data.frame(name, age, gender)</span><br><span class="line">df</span><br><span class="line">str(df)</span><br><span class="line">df[df$age &gt;= <span class="number">20</span> &amp; gender == <span class="string">&quot;F&quot;</span>, <span class="built_in">c</span>(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;age&quot;</span>)]</span><br><span class="line">df[df$age &gt;= <span class="number">20</span> &amp; gender == <span class="string">&quot;F&quot;</span>, <span class="string">&quot;name&quot;</span>]</span><br><span class="line"></span><br><span class="line">df[df[,<span class="number">2</span>]&gt;=<span class="number">20</span> &amp; df[,<span class="number">3</span>] == <span class="string">&quot;F&quot;</span>, <span class="built_in">c</span>(<span class="number">1</span>,<span class="number">2</span>)]</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Code/">Code</category>
      
      <category domain="https://ikarus-999.github.io/categories/Code/R/">R</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/R/">R</category>
      
      <category domain="https://ikarus-999.github.io/tags/coding/">coding</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/29/R-%EB%81%84%EC%A0%81%EC%97%AC%EB%B3%B4%EA%B8%B0/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ë”¥ëŸ¬ë‹-ì…ë¬¸ê³¼-ì¤€ë¹„6</title>
      <link>https://ikarus-999.github.io/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/</link>
      <guid>https://ikarus-999.github.io/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/</guid>
      <pubDate>Fri, 27 Nov 2020 13:54:12 GMT</pubDate>
      
      <description>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-6
ğŸ’¥Remind!! ë”¥ëŸ¬ë‹ì— ë¹„ì„ í˜• í™œì„±í™” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 
 ì„ í˜• í•¨ìˆ˜ë¡œëŠ” XORê³¼ ê°™ì€ non-linearí•œ ë¬¸ì œëŠ” í•´ê²°ì´ ì•ˆë¨;;

ê·¸ëŸ¬ë©´ Hidden Layerë¥¼ ëŠ˜ë¦¬ë©´ ë˜ì§€ ì•Šì„ê¹Œ?
$$f(ax+by) = af(x) + bf(y)$$ ë¼ëŠ” íŠ¹ì§• ë•Œë¬¸ì—
N-layer ê¹Šì´ë¥¼ ì•„ë¬´ë¦¬ ìŒ“ì•„ë„ 1-Layerë¡œ ë™ì‘í•¨.

ìµœì í™”(Opt) ì•Œê³ ë¦¬ì¦˜
 * ê²½ì‚¬í•˜ê°•ë²•(GD)
   $$\theta = \theta - \eta \nabla_\theta S(\theta)$$ 
   
   Networkì˜ paramet</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-6"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-6" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-6"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-6</h2><h3 id="ğŸ’¥Remind-ë”¥ëŸ¬ë‹ì—-ë¹„ì„ í˜•-í™œì„±í™”-í•¨ìˆ˜ë¥¼-ì‚¬ìš©í•˜ëŠ”-ì´ìœ "><a href="#ğŸ’¥Remind-ë”¥ëŸ¬ë‹ì—-ë¹„ì„ í˜•-í™œì„±í™”-í•¨ìˆ˜ë¥¼-ì‚¬ìš©í•˜ëŠ”-ì´ìœ " class="headerlink" title="ğŸ’¥Remind!! ë”¥ëŸ¬ë‹ì— ë¹„ì„ í˜• í™œì„±í™” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ "></a>ğŸ’¥Remind!! ë”¥ëŸ¬ë‹ì— ë¹„ì„ í˜• í™œì„±í™” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ </h3><p>  ì„ í˜• í•¨ìˆ˜ë¡œëŠ” XORê³¼ ê°™ì€ non-linearí•œ ë¬¸ì œëŠ” í•´ê²°ì´ ì•ˆë¨;;</p><blockquote><p>ê·¸ëŸ¬ë©´ Hidden Layerë¥¼ ëŠ˜ë¦¬ë©´ ë˜ì§€ ì•Šì„ê¹Œ?<br>  $$f(ax+by) = af(x) + bf(y)$$ ë¼ëŠ” íŠ¹ì§• ë•Œë¬¸ì—<br>  N-layer ê¹Šì´ë¥¼ ì•„ë¬´ë¦¬ ìŒ“ì•„ë„ 1-Layerë¡œ ë™ì‘í•¨.</p></blockquote><h3 id="ìµœì í™”-Opt-ì•Œê³ ë¦¬ì¦˜"><a href="#ìµœì í™”-Opt-ì•Œê³ ë¦¬ì¦˜" class="headerlink" title="ìµœì í™”(Opt) ì•Œê³ ë¦¬ì¦˜"></a>ìµœì í™”(Opt) ì•Œê³ ë¦¬ì¦˜</h3><ul><li><p>ê²½ì‚¬í•˜ê°•ë²•(GD)<br>$$\theta = \theta - \eta \nabla_\theta S(\theta)$$  </p><p>Networkì˜ parameter=$$\theta $$ ë¡œ í• ë•Œ ì†ì‹¤í•¨ìˆ˜ $$J(\theta)$$ì˜ ê°’ì„ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ ê¸°ìš¸ê¸°<br>$$\nabla J(\theta)$$ë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•<br>GDì—ì„œëŠ” Gradientì˜ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ì¼ì • í¬ê¸°(lr)ë§Œí¼ ì´ë™í•˜ëŠ” ê²ƒì„ ë°˜ë³µí•˜ì—¬ loss functionì˜ ê°’ì„ ìµœì†Œí™” í•˜ëŠ” $$\theta$$ì˜ ê°’ì„ ì°¾ìŒ,  </p></li><li><p>lr $$\eta$$ ëŠ” ë³´í†µ 1e-3 ~ 1e-4 ì‚¬ì´ì—ì„œ ì‚¬ìš©í•¨.<br>ë„ˆë¬´ í¬ë©´ global minimumì„ ì§€ë‚˜ì¹˜ê³  ë„ˆë¬´ ì‘ìœ¼ë©´ Local Minimumì— ë¹ ì§.</p></li></ul><ul><li><p>í™•ë¥ ì  ê²½ì‚¬í•˜ê°•ë²•(SGD)<br>ì „ì²´ Training setì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ batch Gradient Descent, ê³„ì‚°ëŸ‰ì´ ë§ì•„ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´<br>mini-batchì— ëŒ€í•´ì„œë§Œ ì†ì‹¤í•¨ìˆ˜ë¥¼ ê³„ì‚°í•˜ëŠ” í™•ë¥ ì  GDë¥¼ ì‚¬ìš©í•¨.<br>ê°™ì€ ì‹œê°„ì— ë” ë§ì€ stepë¥¼ ê°ˆ ìˆ˜ ìˆìŒ, ì—¬ëŸ¬ë²ˆ ë°˜ë³µí•  ê²½ìš° batchì˜ ê²°ê³¼ì™€ ë¹„ìŠ·í•¨</p></li><li><p>GD vs SGD<br>GD : í™•ì‹¤í•œë° ë„ˆë¬´ ëŠë¦¼ | SGD : ì¡°ê¸ˆ í—¤ë©”ì§€ë§Œ ë¹ ë¦„</p></li><li><p>Momentum : í˜„ì¬ Gradientë¥¼ í†µí•´ ì´ë™í•˜ëŠ” ë°©í–¥ê³¼ ë³„ê°œë¡œ ê³¼ê±°ì˜ ì´ë™ë°©ì‹ì„ ê¸°ì–µí•˜ë©´ì„œ ì¼ì¢…ì˜ ê´€ì„±ì„ ì£¼ëŠ” ë°©ì‹</p></li><li><p>AdaGrad(Adaptive Gradient)</p><ol><li>ë§ì´ ë³€í™”í–ˆë˜ ë³€ìˆ˜ë“¤ì€ step sizeë¥¼ ì‘ê²Œ í•˜ëŠ” ê²ƒ<br>ìì£¼ ë“±ì¥í•˜ê±°ë‚˜ ë³€í™”ë¥¼ ë§ì´ í•œ ë³€ìˆ˜ë“¤ì€ optimumì— ê°€ê¹Œì´ ìˆì„ í™•ë¥ ì´ ë†’ê¸° ë•Œë¬¸ì— ì‘ì€ í¬ê¸°ë¡œ ì´ë™í•˜ë©´ì„œ ë¯¸ì„¸ì¡°ì ˆ</li><li>ì ê²Œ ë³€í™”í•œ ë³€ìˆ˜ë“¤ì€ ë§ì´ ì´ë™í•´ì•¼í•  í™•ë¥ ì´ ë†’ê¸° ë•Œë¬¸ì— ë¨¼ì € ë¹ ë¥´ê²Œ lossê°’ì„ ì¤„ì´ëŠ” ë°©ì‹ìœ¼ë¡œ ì´ë™í•˜ëŠ” ë°©ì‹<br>í•™ìŠµì„ ê³„ì† ì§„í–‰í•˜ë©´ step sizeê°€ ë„ˆë¬´ ì¤„ì–´ë“œëŠ” ë‹¨ì ì´ ìˆìŒ.<br><img src="/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_05.PNG" alt="AdaGrad"></li></ol></li><li><p>RMSProp<br>í•©ì„ ì§€ìˆ˜í‰ê· ìœ¼ë¡œ ëŒ€ì²´í•˜ì—¬ Adagradì˜ ë‹¨ì ì„ í•´ê²°<br>Gê°€ ë¬´í•œì • ì»¤ì§€ì§€ëŠ” ì•Šìœ¼ë©´ì„œ ìµœê·¼ ë³€í™”ëŸ‰ì˜ ë³€ìˆ˜ê°„ ìƒëŒ€ì ì¸ í¬ê¸° ì°¨ì´ëŠ” ìœ ì§€í•  ìˆ˜ ìˆìŒ.<br><img src="/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_04.PNG" alt="RMsprop"></p></li><li><p>Adam<br>Momentum + RMSProp</p><ol><li>ì§€ê¸ˆê¹Œì§€ ê³„ì‚°í•´ì˜¨ ê¸°ìš¸ê¸°ì˜ ì§€ìˆ˜í‰ê· ì„ ì €ì¥</li><li>rmspropê³¼ ìœ ì‚¬í•˜ê²Œ Gradientì˜ ì œê³±ê°’ì˜ ì§€ìˆ˜í‰ê· ì„ ì €ì¥<br><img src="/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_06.PNG" alt="Adam"></li></ol></li></ul><h3 id="Overfitting-ê³¼ì í•©"><a href="#Overfitting-ê³¼ì í•©" class="headerlink" title="Overfitting(ê³¼ì í•©)"></a>Overfitting(ê³¼ì í•©)</h3><p>  Training Setì˜ ì§€ì—½ì ì¸ íŠ¹ì„±ê¹Œì§€ ë°˜ì˜í•´ Variance Highë¡œ Trainingë˜ì–´ì„œ Training Setì„ ì•”ê¸°í•´ë²„ë¦¬ëŠ” í˜„ìƒ<br>  <em>Test Setì„ ì˜ ì˜ˆì¸¡í•˜ì§€ ëª»í•¨</em><br>  ì£¼ë¡œ í‘œí˜„ë ¥ì´ ë†’ì€ ëª¨ë¸, ì¦‰ íŒŒë¼ë¯¸í„°ê°€ ë§ì€ ëª¨ë¸ì— ë°œìƒ</p><ol><li>ì •ê·œí™”(Regularization)</li></ol><ul><li>ì†ì‹¤í•¨ìˆ˜ì— ê°€ì¤‘ì¹˜ì˜ í¬ê¸°ë¥¼ í¬í•¨</li><li>ê°€ì¤‘ì¹˜ê°€ ì‘ì•„ì§€ë„ë¡ í•™ìŠµí•œë‹¤ëŠ” ê²ƒì€ Outlier(Noise)ì˜ ì˜í–¥ì„ ì ê²Œ ë°›ìŒ  </li></ul><h4 id="L2-ì •ê·œí™”"><a href="#L2-ì •ê·œí™”" class="headerlink" title="L2 ì •ê·œí™”"></a>L2 ì •ê·œí™”</h4><p><img src="/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_08.PNG" alt="L2"></p><p><em>Rigde Regression</em></p><h4 id="L1-ì •ê·œí™”"><a href="#L1-ì •ê·œí™”" class="headerlink" title="L1 ì •ê·œí™”"></a>L1 ì •ê·œí™”</h4><p><img src="/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_09.PNG" alt="L1"><br>Sparse Modelì— ì•Œë§ìŒ.. ì‘ì€ ê°€ì¤‘ì¹˜ë“¤ì´ ê±°ì˜ 0ìœ¼ë¡œ ìˆ˜ë ´í•˜ì—¬ ëª‡ê°œì˜ ì¤‘ìš”í•œ ê°€ì¤‘ì¹˜ë“¤ë§Œ ë‚¨ìŒ. </p><p><em>Lasso Regression</em></p><p>ë¯¸ë¶„ ë¶ˆê°€ëŠ¥í•œ ì ì´ ìˆê¸° ë•Œë¬¸ì— Gradient-Base Learningì—ëŠ” ì£¼ì˜..<br><img src="/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_10.PNG" alt="L1ì£¼ì˜ì "></p><h4 id="DropOut"><a href="#DropOut" class="headerlink" title="DropOut"></a>DropOut</h4><p>ê° ë ˆì´ì–´ì˜ ì¼ì • ë¹„ìœ¨ë¡œ ë‰´ëŸ°ì˜ ì¶œë ¥ ê°’ì„ 0ìœ¼ë¡œ ë§Œë“¤ì–´ ë‚˜ë¨¸ì§€ ë‰´ëŸ°ë“¤ë¡œ í•™ìŠµí•˜ëŠ” ë°©ë²•<br>ê³¼ì í•©ì„ íš¨ê³¼ì ìœ¼ë¡œ ì˜ˆë°© ê°€ëŠ¥(Network ë‚´ë¶€ì˜ Ensemble í•™ìŠµìœ¼ë¡œ ë³¼ ìˆ˜ ìˆìŒ)</p><p>ì—­ì „íŒŒëŠ” ReLUì²˜ëŸ¼ ë™ì‘<br>Forward Propagationë•Œ ì‹œê·¸ë„ì„ í†µê³¼ì‹œí‚¨ ë‰´ëŸ°ì€ Backwardë•Œë„ í†µê³¼ì‹œí‚´<br>dropëœ ë‰´ëŸ°ì€ Backward Propagationë•Œë„ ì‹œê·¸ë„ ì°¨ë‹¨</p><p>ë°˜ë©´, TESTë•ŒëŠ” ëª¨ë“  ë‰´ëŸ°ì— ì‹ í˜¸ë¥¼ ì „ë‹¬í•¨</p><h4 id="Batch-Normalization"><a href="#Batch-Normalization" class="headerlink" title="Batch Normalization"></a>Batch Normalization</h4><p>í•™ìŠµí•˜ëŠ” ì´ì „ ì¸µì˜ íŒŒë¼ë¯¸í„° ë³€í™”ë¡œ í˜„ì¬ì¸µì˜ ì…ë ¥ ë¶„í¬ê°€ ë°”ë€ŒëŠ” í˜„ìƒì„ ë‚´ë¶€ ê³µë¶„ì‚° ë³€í™”(Internal Covariate Shift)<br>ì´ì „ ì¸µì˜ ì‘ì€ íŒŒë¼ë¯¸í„° ë³€í™”ê°€ ì¦í­ë˜ì–´ ë’· ë ˆì´ì–´ì— í° ì˜í–¥ì„ ë°›ìŒ.<br>ê·¸ë˜ì„œâ€¦</p><p>BN(2015)</p><ul><li>Gradient Vanishing, Explodingì„ ë°©ì§€í•˜ëŠ” ëŒ€í‘œì ì¸ ë°©ë²•</li><li>ì§ì ‘ì ì¸ ë°©ë²•ì„.</li><li>Training ê³¼ì • ìì²´ë¥¼ ì•ˆì •í™”ì‹œì¼œ í•™ìŠµì†ë„ë¥¼ ê°€ì†í™”</li><li>í‰ê· ê³¼ ë¶„ì‚°ì„ ì¡°ì ˆí•˜ëŠ” ê³¼ì •ì´ <em>NN ì•ˆì— í¬í•¨</em> ë˜ì–´ ìˆë‹¤ëŠ” ê²ƒì´ í•µì‹¬ì </li></ul><p>Trainingí• ë•Œ<br>ê° Mini Batchë§ˆë‹¤ $$\gamma$$ ì™€ $$\beta$$ë¥¼ êµ¬í•˜ê³  ì €ì¥í•´ ë‘ </p><p>Testí• ë•Œ<br>êµ¬í–ˆë˜ $$\gamma$$ ì™€ $$\beta$$ì˜ í‰ê· ì„ ì‚¬ìš©</p><p><img src="/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_11.PNG" alt="BN"></p><h4 id="Data-Augmentation"><a href="#Data-Augmentation" class="headerlink" title="Data Augmentation"></a>Data Augmentation</h4><p>ì¼ì¢…ì˜ Regularizationì‘ì—…, ë°ì´í„°ê°€ ì ì„ ë•Œ ì‚¬ìš©í•˜ë©´ ë§¤ìš° íš¨ê³¼ì <br>ì¦‰ ë°ì´í„° ë³€í˜•</p>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ë”¥ëŸ¬ë‹-ì…ë¬¸ê³¼-ì¤€ë¹„5</title>
      <link>https://ikarus-999.github.io/2020/11/25/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/</link>
      <guid>https://ikarus-999.github.io/2020/11/25/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/</guid>
      <pubDate>Wed, 25 Nov 2020 12:49:48 GMT</pubDate>
      
      <description>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-5
ì„ í˜•ëŒ€ìˆ˜ ë°°ì›Œë³´ê¸°(í–‰ë ¬ì„ ì•„ë¬´ë¦¬ ê³±í•˜ê³  ë”í•´ë„ ì„ ëª¨ì–‘)
Scala : í¬ê¸°ë§Œ ì¡´ì¬í•˜ëŠ” ì–‘
Vector : ì†ë„, ìœ„ì¹˜ì´ë™, í˜, ê³µê°„ë’¤í‹€ë¦¼ê³¼ ê°™ì´ í¬ê¸°ì™€ ë°©í–¥ì´ ëª¨ë‘ ì¡´ì¬í•˜ëŠ” ì–‘


Norm ? nì°¨ì› ë²¡í„° $$\vec{x} = (x_1, x_2, \cdots x_n)$$
Norm $$\lVert x \rVert = \sqrt{x_1^1 + x_2^2 + \cdots + x_n^2}$$

â€œì›ì  Oì—ì„œ ì \(x_1, x_2, \cdots, x_n\) ê¹Œì§€ì˜ ê±°ë¦¬â€

ë‚´ì  ? Inner product, Dot p</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-5"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-5" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-5"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-5</h2><h3 id="ì„ í˜•ëŒ€ìˆ˜-ë°°ì›Œë³´ê¸°-í–‰ë ¬ì„-ì•„ë¬´ë¦¬-ê³±í•˜ê³ -ë”í•´ë„-ì„ ëª¨ì–‘"><a href="#ì„ í˜•ëŒ€ìˆ˜-ë°°ì›Œë³´ê¸°-í–‰ë ¬ì„-ì•„ë¬´ë¦¬-ê³±í•˜ê³ -ë”í•´ë„-ì„ ëª¨ì–‘" class="headerlink" title="ì„ í˜•ëŒ€ìˆ˜ ë°°ì›Œë³´ê¸°(í–‰ë ¬ì„ ì•„ë¬´ë¦¬ ê³±í•˜ê³  ë”í•´ë„ ì„ ëª¨ì–‘)"></a>ì„ í˜•ëŒ€ìˆ˜ ë°°ì›Œë³´ê¸°(í–‰ë ¬ì„ ì•„ë¬´ë¦¬ ê³±í•˜ê³  ë”í•´ë„ ì„ ëª¨ì–‘)</h3><h4 id="Scala-í¬ê¸°ë§Œ-ì¡´ì¬í•˜ëŠ”-ì–‘"><a href="#Scala-í¬ê¸°ë§Œ-ì¡´ì¬í•˜ëŠ”-ì–‘" class="headerlink" title="Scala : í¬ê¸°ë§Œ ì¡´ì¬í•˜ëŠ” ì–‘"></a>Scala : í¬ê¸°ë§Œ ì¡´ì¬í•˜ëŠ” ì–‘</h4><h4 id="Vector-ì†ë„-ìœ„ì¹˜ì´ë™-í˜-ê³µê°„ë’¤í‹€ë¦¼ê³¼-ê°™ì´-í¬ê¸°ì™€-ë°©í–¥ì´-ëª¨ë‘-ì¡´ì¬í•˜ëŠ”-ì–‘"><a href="#Vector-ì†ë„-ìœ„ì¹˜ì´ë™-í˜-ê³µê°„ë’¤í‹€ë¦¼ê³¼-ê°™ì´-í¬ê¸°ì™€-ë°©í–¥ì´-ëª¨ë‘-ì¡´ì¬í•˜ëŠ”-ì–‘" class="headerlink" title="Vector : ì†ë„, ìœ„ì¹˜ì´ë™, í˜, ê³µê°„ë’¤í‹€ë¦¼ê³¼ ê°™ì´ í¬ê¸°ì™€ ë°©í–¥ì´ ëª¨ë‘ ì¡´ì¬í•˜ëŠ” ì–‘"></a>Vector : ì†ë„, ìœ„ì¹˜ì´ë™, í˜, ê³µê°„ë’¤í‹€ë¦¼ê³¼ ê°™ì´ í¬ê¸°ì™€ ë°©í–¥ì´ ëª¨ë‘ ì¡´ì¬í•˜ëŠ” ì–‘</h4><p><img src="/2020/11/25/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/slido51_1.PNG" alt="ìŠ¤ì¹¼ë¼ì™€ë²¡í„°"></p><h4 id="Norm-nì°¨ì›-ë²¡í„°-vec-x-x-1-x-2-cdots-x-n"><a href="#Norm-nì°¨ì›-ë²¡í„°-vec-x-x-1-x-2-cdots-x-n" class="headerlink" title="Norm ? nì°¨ì› ë²¡í„° $$\vec{x} = (x_1, x_2, \cdots x_n)$$"></a>Norm ? nì°¨ì› ë²¡í„° $$\vec{x} = (x_1, x_2, \cdots x_n)$$</h4><p>Norm $$\lVert x \rVert = \sqrt{x_1^1 + x_2^2 + \cdots + x_n^2}$$</p><blockquote><p>â€œì›ì  Oì—ì„œ ì \(x_1, x_2, \cdots, x_n\) ê¹Œì§€ì˜ ê±°ë¦¬â€</p></blockquote><h4 id="ë‚´ì -Inner-product-Dot-product"><a href="#ë‚´ì -Inner-product-Dot-product" class="headerlink" title="ë‚´ì  ?  Inner product, Dot product"></a>ë‚´ì  ?  Inner product, Dot product</h4><h4 id="í–‰ë ¬ë¼ë¦¬-ê³±í• -ë•ŒëŠ”-ì°¨ì›ì„-ì£¼ì˜í•œë‹¤"><a href="#í–‰ë ¬ë¼ë¦¬-ê³±í• -ë•ŒëŠ”-ì°¨ì›ì„-ì£¼ì˜í•œë‹¤" class="headerlink" title="í–‰ë ¬ë¼ë¦¬ ê³±í•  ë•ŒëŠ” ì°¨ì›ì„ ì£¼ì˜í•œë‹¤."></a>í–‰ë ¬ë¼ë¦¬ ê³±í•  ë•ŒëŠ” ì°¨ì›ì„ ì£¼ì˜í•œë‹¤.</h4><blockquote><p>A(m, n) * B(n, m) ë§Œ ê°€ëŠ¥</p></blockquote><h4 id="Transpose-ì „ì¹˜í–‰ë ¬-í–‰ê³¼-ì—´ì„-ë’¤ë°”ê¿ˆ"><a href="#Transpose-ì „ì¹˜í–‰ë ¬-í–‰ê³¼-ì—´ì„-ë’¤ë°”ê¿ˆ" class="headerlink" title="Transpose: ì „ì¹˜í–‰ë ¬(í–‰ê³¼ ì—´ì„ ë’¤ë°”ê¿ˆ)"></a>Transpose: ì „ì¹˜í–‰ë ¬(í–‰ê³¼ ì—´ì„ ë’¤ë°”ê¿ˆ)</h4><blockquote><p>A.T</p></blockquote><h3 id="numpy-ì—°ì‚°-Element-wise-operation"><a href="#numpy-ì—°ì‚°-Element-wise-operation" class="headerlink" title="numpy ì—°ì‚°(Element-wise operation)"></a>numpy ì—°ì‚°(Element-wise operation)</h3><blockquote><p>np.dot(x, y) (aka ë‚´ì , dot-product)ì™€  x * y(element-wise)ëŠ” ì„œë¡œ ë‹¤ë¦„.</p></blockquote><h3 id="numpy-ë¹„êµ-ë…¼ë¦¬ì—°ì‚°-element-wise-operation"><a href="#numpy-ë¹„êµ-ë…¼ë¦¬ì—°ì‚°-element-wise-operation" class="headerlink" title="numpy ë¹„êµ, ë…¼ë¦¬ì—°ì‚°(element-wise operation)"></a>numpy ë¹„êµ, ë…¼ë¦¬ì—°ì‚°(element-wise operation)</h3><h3 id="numpy-Reductions"><a href="#numpy-Reductions" class="headerlink" title="numpy Reductions"></a>numpy Reductions</h3><blockquote><p>argmax() : ìµœëŒ€ê°’ìˆëŠ” ì¸ë±ìŠ¤ë¥¼ ë¦¬í„´, argmin() : ìµœì†Œê°’ì˜ ì¸ë±ìŠ¤ ë¦¬í„´</p></blockquote><h3 id="np-all-np-any"><a href="#np-all-np-any" class="headerlink" title="np.all, np.any?"></a>np.all, np.any?</h3><blockquote><p>ALL : Arrayë‚´ ëª¨ë“  ê°’ì´ TRUEì¸ê°€?<br>  any : Arrayë‚´ ê°’ì´ í•˜ë‚˜ë¼ë„ TRUEì¸ê°€?</p></blockquote><h3 id="np-mean-np-median-np-std-ë“±-í†µê³„í•¨ìˆ˜-ì‚¬ìš©-ê°€ëŠ¥"><a href="#np-mean-np-median-np-std-ë“±-í†µê³„í•¨ìˆ˜-ì‚¬ìš©-ê°€ëŠ¥" class="headerlink" title="np.mean, np.median, np.std ë“± í†µê³„í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥"></a>np.mean, np.median, np.std ë“± í†µê³„í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥</h3><h4 id="ë”¥ëŸ¬ë‹ì—-ëŒ€í•œ-í™˜ìƒ"><a href="#ë”¥ëŸ¬ë‹ì—-ëŒ€í•œ-í™˜ìƒ" class="headerlink" title="ë”¥ëŸ¬ë‹ì— ëŒ€í•œ í™˜ìƒ"></a>ë”¥ëŸ¬ë‹ì— ëŒ€í•œ í™˜ìƒ</h4><ol><li><p>ë³µì¡í•œ ë¬¸ì œë„ ì¸µì„ ê¹Šê³  ë„“ê²Œ ìŒ“ìœ¼ë©´ í•´ê²°ëœë‹¤ â€“&gt; Gradient Vanhshing, Initialize fault ìœ¼í•˜í•˜í•°ã…‹ã…‹ã…‹</p></li><li><p>$$Sigmoid(z) = \frac{1} {1 + e^{-z}}$$<br>Sigmoid ë„í•¨ìˆ˜ì˜ ìµœëŒ€ê°’ì€ 1/4 â€¦ â€“&gt; ê·¸ë˜ì„œ Gradient Vanishing ë‚˜ëŠ”ê±°ì„ ã…‡ã…‡</p></li></ol><h4 id="ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”"><a href="#ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”" class="headerlink" title="ê°€ì¤‘ì¹˜ ì´ˆê¸°í™”"></a>ê°€ì¤‘ì¹˜ ì´ˆê¸°í™”</h4><ol><li><p>ì´ˆê¸°í™”ì˜ ì¤‘ìš”ì„±<br>$$t = wx+b$$ ì—ì„œ wê°€ 100, bê°€ 50ì´ë¼ë©´ xê°€ 0.01ì´ë”ë¼ë„ tëŠ” 51ì´ ë¨<br>ì—­ì „íŒŒë•Œ sigmoid í•¨ìˆ˜ í†µê³¼ì‹œí‚¤ë©´ $$\sigmaâ€™ (51)$$ ë¦¬í„´ë¨<br>í•˜ì§€ë§Œ tê°€ 5ë§Œ ë„˜ì–´ë„ $$\sigma (t)$$ ëŠ” 0ì— ìˆ˜ë ´ â€“&gt; ì´ê²ƒì´ ë°”ë¡œ Gradient Vanishingâ€¦</p></li><li><p>ê·¸ë˜ì„œ ì…ë ¥ì¸µì˜ ê°€ì¤‘ì¹˜wë¥¼ ëª¨ë‘ 0ìœ¼ë¡œ ë¦¬ì…‹!<br>Forward Propagationë•Œ ë‘ë²ˆì§¸ ì¸µ ë‰´ëŸ°ì— ëª¨ë‘ ê°™ì€ ê°’ì´ ì „ë‹¬ë¨<br>Backward Propagationë•Œ ë‘ì§¸ ì¸µ ê°€ì¤‘ì¹˜ê°€ ëª¨ë‘ ë˜‘ê°™ì´ ì—…ë°ì´íŠ¸ ==&gt; ì‹ ê²½ë§ í‘œí˜„ë ¥ ì œí•œ</p></li><li><p>BiasëŠ” 0ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ëŠ”ê²Œ ì¼ë°˜ì ìœ¼ë¡œ íš¨ìœ¨ì </p></li></ol><h4 id="ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-2"><a href="#ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-2" class="headerlink" title="ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 2"></a>ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 2</h4><ol><li><p>í‘œì¤€ ì •ê·œë¶„í¬ë¥¼ ì´ìš©í•œ ê°€ì¤‘ì¹˜ ì´ˆê¸°í™”<br>Sigmoidí•¨ìˆ˜ì˜ ì¶œë ¥ê°’ì´ ê·¹ë‹¨ì ìœ¼ë¡œ(0 or 1)ì— ì¹˜ìš°ì¹˜ëŠ” í˜„ìƒ â€“&gt; Gradient Vanishing</p></li><li><p>í‘œì¤€í¸ì°¨ë¥¼ 0.01ë¡œ í•˜ëŠ” ì •ê·œë¶„í¬ë¡œ ì´ˆê¸°í™”<br>ê°€ì¤‘ì¹˜ê°€ ëª¨ì—¬ ìˆìŒ =&gt; ê¸°ìš¸ê¸° ì†Œì‹¤ ë¬¸ì œ ì–´ëŠì •ë„ ì™„í™”ë¨</p></li></ol><h4 id="ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-3"><a href="#ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-3" class="headerlink" title="ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 3"></a>ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 3</h4><p>  Xavierì´ˆê¸°í™” ë°©ë²•(2010)<br>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w = np.random.randn(n_input, n_output) / (n_input) ** <span class="number">0.5</span></span><br></pre></td></tr></table></figure><br>  Sigmoidì™€ ê°™ì€ Sì í•¨ìˆ˜ì˜ ê²½ìš° ì¶œë ¥ê°’ë“¤ì´ ì •ê·œë¶„í¬ í˜•íƒœì´ì–´ì•¼ ì•ˆì •ì  í•™ìŠµ ê°€ëŠ¥  </p><ul><li><p>Sigmoid functionê³¼ Xavier Initë°©ë²•ì„ ì‚¬ìš©í–ˆì„ ê²½ìš° ê·¸ë˜í”„<br><img src="/2020/11/25/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/ckpt_01.PNG" alt="sigmodi"></p></li><li><p>ReLU ê³„ì—´ í•¨ìˆ˜ì—ëŠ” ì ì ˆí•˜ì§€ ì•ŠìŒ<br>layerë¥¼ ê±°ì³ê°ˆ ìˆ˜ë¡ 0ì— ìˆ˜ë ´(converge)</p><p><img src="/2020/11/25/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/ckpt_02.PNG" alt="reluNo"></p><h4 id="ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-4"><a href="#ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-4" class="headerlink" title="ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 4"></a>ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 4</h4><p>He ì´ˆê¸°í™” ë°©ë²•(2015)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w = np.random.randn(n_input, n_output) / (n_input / <span class="number">2</span>) ** <span class="number">0.5</span></span><br></pre></td></tr></table></figure><p>RELU + He init â€“&gt; 10 layerë¥¼ ê±°ì³ë„ í‘œì¤€í¸ì°¨ê°€ 0ìœ¼ë¡œ ìˆ˜ë ´í•˜ì§€ ì•ŠìŒ<br><img src="/2020/11/25/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/ckpt_03.PNG" alt="relu"></p></li></ul><h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><ul><li>ê°€ì¤‘ì¹˜ ì´ˆê¸°í™”ëŠ” ë„ˆë¬´ë‚˜ ì¤‘ìš”í•¨</li><li>tanhì˜ ê²½ìš° Xavier Init ë°©ë²•ì´ íš¨ìœ¨ì </li><li>ReLUê³„ì—´ í•¨ìˆ˜ì—ëŠ” He Init ë°©ë²•ì´ íš¨ìœ¨ì </li><li>ìµœê·¼ì—” ëŒ€ë¶€ë¶„ He Initë¥¼ ì£¼ë¡œ ì‚¬ìš©</li></ul>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/Linear-Algebra/">Linear Algebra</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/25/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ë”¥ëŸ¬ë‹-ì…ë¬¸ê³¼-ì¤€ë¹„4</title>
      <link>https://ikarus-999.github.io/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/</link>
      <guid>https://ikarus-999.github.io/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/</guid>
      <pubDate>Tue, 24 Nov 2020 13:24:21 GMT</pubDate>
      
      <description>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-4
ì¸ê³µì‹ ê²½ë§ê³¼ ì†ì‹¤í•¨ìˆ˜
 1. ì¸ê³µì‹ ê²½ë§ì˜ ê¸°ë³¸ êµ¬ì¡°
    
     * ë‡Œì˜ í•™ìŠµë°©ë²•ì„ ìˆ˜í•™ì ìœ¼ë¡œ ëª¨ë¸ë§í•œ ê¸°ê³„í•™ìŠµ ì•Œê³ ë¦¬ì¦˜
     * ê¸°ë³¸ êµ¬ì¡° : y = Wx+b
       
       \(x_i\) : ì…ë ¥, \(w_i\): ê°€ì¤‘ì¹˜, b : bias, f: í™œì„±í™”í•¨ìˆ˜
       u : ê²°í•©(Net), z: ì¶œë ¥
     * ë‰´ëŸ°ì—ëŠ” ì„ í˜• ê²°í•©ê³¼ í™œì„±í™” í•¨ìˆ˜ ê¸°ëŠ¥ì´ ë“¤ì–´ìˆìŒ
     * ì…ë ¥ì¸µ, ì€ë‹‰ì¸µ, ì¶œë ¥ì¸µìœ¼ë¡œ êµ¬ì„±ë¨
     * ê° ë…¸ë“œì˜ ë‰´ëŸ° ì¶œë ¥ì€ ì§ì ‘ ì „ë‹¬ë˜ëŠ” ì •ë³´ì—ë§Œ ì˜ì¡´í•  ë¿ ë‹¤ë¥¸ ë…¸</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-4"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-4" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-4"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-4</h2><h3 id="ì¸ê³µì‹ ê²½ë§ê³¼-ì†ì‹¤í•¨ìˆ˜"><a href="#ì¸ê³µì‹ ê²½ë§ê³¼-ì†ì‹¤í•¨ìˆ˜" class="headerlink" title="ì¸ê³µì‹ ê²½ë§ê³¼ ì†ì‹¤í•¨ìˆ˜"></a>ì¸ê³µì‹ ê²½ë§ê³¼ ì†ì‹¤í•¨ìˆ˜</h3><ol><li><p>ì¸ê³µì‹ ê²½ë§ì˜ ê¸°ë³¸ êµ¬ì¡°</p><ul><li>ë‡Œì˜ í•™ìŠµë°©ë²•ì„ ìˆ˜í•™ì ìœ¼ë¡œ ëª¨ë¸ë§í•œ ê¸°ê³„í•™ìŠµ ì•Œê³ ë¦¬ì¦˜</li><li>ê¸°ë³¸ êµ¬ì¡° : y = Wx+b<br><img src="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_1.PNG" alt="ì¸ê³µì‹ ê²½ë§"><br>\(x_i\) : ì…ë ¥, \(w_i\): ê°€ì¤‘ì¹˜, b : bias, f: í™œì„±í™”í•¨ìˆ˜<br>u : ê²°í•©(Net), z: ì¶œë ¥</li><li>ë‰´ëŸ°ì—ëŠ” ì„ í˜• ê²°í•©ê³¼ í™œì„±í™” í•¨ìˆ˜ ê¸°ëŠ¥ì´ ë“¤ì–´ìˆìŒ</li><li>ì…ë ¥ì¸µ, ì€ë‹‰ì¸µ, ì¶œë ¥ì¸µìœ¼ë¡œ êµ¬ì„±ë¨</li><li>ê° ë…¸ë“œì˜ ë‰´ëŸ° ì¶œë ¥ì€ ì§ì ‘ ì „ë‹¬ë˜ëŠ” ì •ë³´ì—ë§Œ ì˜ì¡´í•  ë¿ ë‹¤ë¥¸ ë…¸ë“œì™€ëŠ” ë¬´ê´€</li><li>ê·¸ë˜ì„œ? ë³‘ë ¬ì²˜ë¦¬ê°€ ê°€ëŠ¥í•¨.</li></ul></li><li><p>ì†ì‹¤ í•¨ìˆ˜(Loss or Cost function)</p><ul><li>ì‹ ê²½ë§ì˜ ì¶œë ¥ê°’ê³¼ ì‹¤ì œ ê²°ê³¼ê°’ì˜ ì°¨ì´ë¥¼ ì •ì˜í•˜ëŠ” í•¨ìˆ˜</li><li>ì‹ ê²½ë§ í•™ìŠµëª©í‘œëŠ” ì†ì‹¤í•¨ìˆ˜ë¥¼ ìµœì†Œí™” í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì›€ì§ì—¬ì•¼ í•¨</li><li>SGD, Adam ë“±ì˜ í•™ìŠµ ìµœì í™” ì•Œê³ ë¦¬ì¦˜</li></ul></li><li><p>ì†ì‹¤ í•¨ìˆ˜</p><ul><li>íšŒê·€(Regression)<br>ì œê³± ì˜¤ì°¨(MSE) ì‚¬ìš©, ìµœê·¼ì—ëŠ” rmse, maeì˜ ì¥ì ì´ ìˆëŠ” Huber Loss ì‚¬ìš©í•˜ëŠ” ì¶”ì„¸<br><img src="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_4.PNG" alt="íšŒê·€"></li></ul></li></ol><ul><li><p>Huber Loss?<br>MAE + MSE -&gt; for Time Series Data!!<br><img src="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_5.PNG" alt="huber"><br><img src="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_7.PNG" alt="huber Loss"></p><ul><li>ë¶„ë¥˜(Classification)<br>í™œì„±í™” í•¨ìˆ˜ : softmax, ì†ì‹¤í•¨ìˆ˜ : cross-entropy<br><img src="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_2.PNG" alt="ë¶„ë¥˜"></li></ul></li></ul><h3 id="ì•Œê³ ë¦¬ì¦˜ê³¼-ì—­ì „íŒŒ"><a href="#ì•Œê³ ë¦¬ì¦˜ê³¼-ì—­ì „íŒŒ" class="headerlink" title="ì•Œê³ ë¦¬ì¦˜ê³¼ ì—­ì „íŒŒ"></a>ì•Œê³ ë¦¬ì¦˜ê³¼ ì—­ì „íŒŒ</h3><ol><li><p>í•™ìŠµ ì•Œê³ ë¦¬ì¦˜</p><ul><li>ê²½ì‚¬ í•˜ê°•ë²•: ê¸°ìš¸ê¸°ë¥¼ ì´ìš©í•˜ì—¬ ì†ì‹¤í•¨ìˆ˜ S(\theta) ê°’ì„ ìµœì í™”</li><li>gradient(ê¸°ìš¸ê¸°)ì˜ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ì¼ì • í¬ê¸°ë§Œí¼ ì´ë™í•˜ëŠ” ê²ƒì„ ë°˜ë³µí•˜ì—¬<br>ì†ì‹¤í•¨ìˆ˜ì˜ ê°’ì„ ìµœì†Œí™”í•˜ëŠ” \thetaì˜ ê°’ì„ ì°¾ìŒ</li><li>\[\theta = \theta - \eta \nabla_\theta S(\theta)\]</li><li>ì´ ë–„ \eta ëŠ” ë¯¸ë¦¬ ì •í•´ì§„ learning rate(step size) ì´ê³  ë³´í†µ 1e-3 ~ 1e-4 ì •ë„ë¥¼ ì‚¬ìš©</li></ul></li><li><p>ì—­ì „íŒŒ</p><ul><li><p>ê³„ì‚° ê·¸ë˜í”„</p></li><li><p>ë…¸ë“œëŠ” ì—°ì‚°ì„, ì—£ì§€ëŠ” ë°ì´í„°ì˜ íë¦„ë°©í–¥<br><img src="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_8.PNG" alt="Chain Rule"></p></li><li><p>sigmoid í•¨ìˆ˜ ì—­ì „íŒŒ<br><img src="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_9.PNG" alt="sigmoidBP"></p></li><li><p>í•©ì„±í•¨ìˆ˜ ë¯¸ë¶„ë²•(Chain Rule)<br><img src="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_10.PNG" alt="í•©ì„±ë¯¸ë¶„"></p></li><li><p>í–‰ë ¬ì—°ì‚°ê³¼ ì—­ì „íŒŒ 1<br><img src="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_11.PNG" alt="í–‰ë ¬ì—­ì „íŒŒ"></p></li><li><p>ì´ì§„ë¶„ë¥˜ 2-layer NN ì—­ì „íŒŒ<br><img src="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_12.PNG" alt="ì´ì§„ì—­ì „íŒŒ"></p></li></ul><blockquote><p>to be continuedâ€¦</p></blockquote></li></ol>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ë”¥ëŸ¬ë‹-ì…ë¬¸ê³¼-ì¤€ë¹„3</title>
      <link>https://ikarus-999.github.io/2020/11/23/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%843/</link>
      <guid>https://ikarus-999.github.io/2020/11/23/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%843/</guid>
      <pubDate>Sun, 22 Nov 2020 19:44:55 GMT</pubDate>
      
      <description>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-3
ì°¨ì›ìˆ˜ ëŠ˜ë¦¬ê¸°, ì¤„ì´ê¸°(TF2.x)
1
2
3
4
5
6
7


x = tf.expand_dims(x, 1)
x.shape # (x.shape, 1)

x[..., tf.newaxis].shape # (x.shape, 1)

np.squeeze(x[0]).shape # x.shape ì°¨ì› ì¤„ì´ê¸°



TF2.x Layers
Convolution

 * filters : layerì—ì„œ ì¶œë ¥ë ë•Œ ëª‡ê°œì˜ filter
 * kernel_size : filter(weight) ì˜ ì‚¬ì´ì¦ˆ
 * strides : ëª‡ ê°œì˜ </description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-3"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-3" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-3"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-3</h2><h3 id="ì°¨ì›ìˆ˜-ëŠ˜ë¦¬ê¸°-ì¤„ì´ê¸°-TF2-x"><a href="#ì°¨ì›ìˆ˜-ëŠ˜ë¦¬ê¸°-ì¤„ì´ê¸°-TF2-x" class="headerlink" title="ì°¨ì›ìˆ˜ ëŠ˜ë¦¬ê¸°, ì¤„ì´ê¸°(TF2.x)"></a>ì°¨ì›ìˆ˜ ëŠ˜ë¦¬ê¸°, ì¤„ì´ê¸°(TF2.x)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = tf.expand_dims(x, <span class="number">1</span>)</span><br><span class="line">x.shape <span class="comment"># (x.shape, 1)</span></span><br><span class="line"></span><br><span class="line">x[..., tf.newaxis].shape <span class="comment"># (x.shape, 1)</span></span><br><span class="line"></span><br><span class="line">np.squeeze(x[<span class="number">0</span>]).shape <span class="comment"># x.shape ì°¨ì› ì¤„ì´ê¸°</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="TF2-x-Layers"><a href="#TF2-x-Layers" class="headerlink" title="TF2.x Layers"></a>TF2.x Layers</h3><p>Convolution</p><ul><li>filters : layerì—ì„œ ì¶œë ¥ë ë•Œ ëª‡ê°œì˜ filter</li><li>kernel_size : filter(weight) ì˜ ì‚¬ì´ì¦ˆ</li><li>strides : ëª‡ ê°œì˜ pixelë§Œí¼ skipí•˜ë©´ì„œ sliding window í•  ê²ƒì¸ì§€</li><li>padding : same, zero</li><li>activation : í™œì„±í™” í•¨ìˆ˜(<em>Linear functionì€ ì¸µì„ ìŒ“ëŠ” ì˜ë¯¸ê°€ ì—†ë‹¤</em>)</li></ul><blockquote><p>to be Continuedâ€¦</p></blockquote>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/23/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%843/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>TF2</title>
      <link>https://ikarus-999.github.io/2020/11/22/TF2/</link>
      <guid>https://ikarus-999.github.io/2020/11/22/TF2/</guid>
      <pubDate>Sun, 22 Nov 2020 10:56:34 GMT</pubDate>
      
      <description>Tensorflow 2.x ì‚¬ìš©ë²•
Tensor ìƒì„±
 * tf.constant() : list, tuple, Array ë¥¼ Tensorë¡œ ë°”ê¿ˆ
   
   
 * tensor = tf.constant(arr)
   
   
 * tensor.dtype : ë°ì´í„° íƒ€ì… í™•ì¸
   
   
 * tf.cast(tensor, dtype=tf.uint8) : TF int8ë¡œ ë°ì´í„°íƒ€ì… ë°”ê¾¸ê¸°
   
   
   
 * tensor.numpy() : numpy arrayë¡œ ë°”ê¾¸ê¸°
   
   

Tensorì— ëœë¤í•œ ìˆ«ìë“¤ ìƒì„±
 * num</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="Tensorflow-2-x-ì‚¬ìš©ë²•"><a href="#Tensorflow-2-x-ì‚¬ìš©ë²•" class="headerlink" title="Tensorflow 2.x ì‚¬ìš©ë²•"></a>Tensorflow 2.x ì‚¬ìš©ë²•</h2><h3 id="Tensor-ìƒì„±"><a href="#Tensor-ìƒì„±" class="headerlink" title="Tensor ìƒì„±"></a>Tensor ìƒì„±</h3><ul><li><p>tf.constant() : list, tuple, Array ë¥¼ Tensorë¡œ ë°”ê¿ˆ</p></li><li><p>tensor = tf.constant(arr)</p></li><li><p>tensor.dtype : ë°ì´í„° íƒ€ì… í™•ì¸</p></li><li><p>tf.cast(tensor, dtype=tf.uint8) : TF int8ë¡œ ë°ì´í„°íƒ€ì… ë°”ê¾¸ê¸°<br><img src="/2020/11/22/TF2/lect_2.PNG" alt="castì‚¬ìš©ë²•"></p></li><li><p>tensor.numpy() : numpy arrayë¡œ ë°”ê¾¸ê¸°</p></li></ul><h3 id="Tensorì—-ëœë¤í•œ-ìˆ«ìë“¤-ìƒì„±"><a href="#Tensorì—-ëœë¤í•œ-ìˆ«ìë“¤-ìƒì„±" class="headerlink" title="Tensorì— ëœë¤í•œ ìˆ«ìë“¤ ìƒì„±"></a>Tensorì— ëœë¤í•œ ìˆ«ìë“¤ ìƒì„±</h3><ul><li>numpyì—ì„œëŠ” ê¸°ë³¸ì ì¸ normal distribution ìƒì„±<br>np.random.randn(9) : 9ê°œì˜ ë¶ˆì—°ì†ì ì´ë©° ì¼ì •í•œ ë¶„í¬ ë‚œìˆ˜ ìƒì„±</li></ul><p>Distributionì— ë”°ë¥¸ ë‚œìˆ˜ ìƒì„±</p><ul><li><p>tf.random.normal<br>ì¤‘ì‹¬ê·¹í•œ ì´ë¡ ì— ì˜í•œ ì—°ì†ì ì¸ ëª¨ì–‘</p></li><li><p>tf.random.uniform<br>ë¶ˆì—°ì†ì ì´ë©° ì¼ì •í•œ ë¶„í¬</p></li></ul>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/Tensorflow2/">Tensorflow2</category>
      
      <category domain="https://ikarus-999.github.io/tags/TF2/">TF2</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/22/TF2/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ë”¥ëŸ¬ë‹ ì…ë¬¸ê³¼ ì¤€ë¹„2</title>
      <link>https://ikarus-999.github.io/2020/11/22/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%842/</link>
      <guid>https://ikarus-999.github.io/2020/11/22/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%842/</guid>
      <pubDate>Sun, 22 Nov 2020 10:44:36 GMT</pubDate>
      
      <description>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-2
Broadcast
ë‘ê°œì˜ í–‰ë ¬ shapeê°€ ì„œë¡œ ë‹¬ë¼ë„
í•œìª½ì˜ ì°¨ì›ì´ ê°™ê±°ë‚˜, ì—°ì‚°í•˜ëŠ” ê°’ì´ í•œ ê°œì¼ë•Œ
shapeì— ë§ê²Œ ë³µì‚¬í•´ì„œ ì—°ì‚°í•¨

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21


arr = np.arange(6).reshape(-1, 3)
# [[0, 1, 2], 
#  [3, 4, 5]]

arr + 3
# [[3, 4, 5],
#  [6, 7, 8]]

arr * 3
# [[0, 3, 6],
#  [9, 12 15]

arr + np.array([</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-2"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-2" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-2"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-2</h2><h3 id="Broadcast"><a href="#Broadcast" class="headerlink" title="Broadcast"></a>Broadcast</h3><p>ë‘ê°œì˜ í–‰ë ¬ shapeê°€ ì„œë¡œ ë‹¬ë¼ë„<br>í•œìª½ì˜ ì°¨ì›ì´ ê°™ê±°ë‚˜, ì—°ì‚°í•˜ëŠ” ê°’ì´ í•œ ê°œì¼ë•Œ<br>shapeì— ë§ê²Œ ë³µì‚¬í•´ì„œ ì—°ì‚°í•¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">arr = np.arange(<span class="number">6</span>).reshape(<span class="number">-1</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># [[0, 1, 2], </span></span><br><span class="line"><span class="comment">#  [3, 4, 5]]</span></span><br><span class="line"></span><br><span class="line">arr + <span class="number">3</span></span><br><span class="line"><span class="comment"># [[3, 4, 5],</span></span><br><span class="line"><span class="comment">#  [6, 7, 8]]</span></span><br><span class="line"></span><br><span class="line">arr * <span class="number">3</span></span><br><span class="line"><span class="comment"># [[0, 3, 6],</span></span><br><span class="line"><span class="comment">#  [9, 12 15]</span></span><br><span class="line"></span><br><span class="line">arr + np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="comment"># [[1, 3, 5],</span></span><br><span class="line"><span class="comment">#  [4, 6, 8]]</span></span><br><span class="line"></span><br><span class="line">np.add(arr, <span class="number">1</span>)</span><br><span class="line"><span class="comment"># ëª¨ë“  ì›ì†Œì— 1ì„ ë”í•¨</span></span><br><span class="line"></span><br><span class="line">np.multiply(arr, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># ëª¨ë“  ì›ì†Œì— 3ì„ ê³±í•¨</span></span><br></pre></td></tr></table></figure><h3 id="argmax-argmin"><a href="#argmax-argmin" class="headerlink" title="argmax, argmin"></a>argmax, argmin</h3><p> ë°°ì—´ì˜ í° ê°’ì´ë‚˜ ì‘ì€ ê°’ì˜ index return<br> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arr = np.array([<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">54</span>, <span class="number">3</span>, <span class="number">2</span>])</span><br><span class="line">np.argmax(arr) <span class="comment"># 54</span></span><br><span class="line">np.argmin(arr) <span class="comment"># 1</span></span><br><span class="line">np.unique(arr) <span class="comment"># ìœ ì¼í•œ ê°’ ì¶œë ¥</span></span><br></pre></td></tr></table></figure></p>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/22/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%842/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ë”¥ëŸ¬ë‹ ì…ë¬¸ê³¼ ì¤€ë¹„</title>
      <link>https://ikarus-999.github.io/2020/11/22/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%84/</link>
      <guid>https://ikarus-999.github.io/2020/11/22/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%84/</guid>
      <pubDate>Sun, 22 Nov 2020 09:45:13 GMT</pubDate>
      
      <description>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°
Tensor ì´í•´í•˜ê¸°
 1. ì°¨ì›
    
     * 0ì°¨ì›(ìƒìˆ˜) : Scalarê°’
     * 1ì°¨ì›(ë¦¬ìŠ¤íŠ¸ ì”Œìš´ ìƒìˆ˜), 2ì°¨ì›(2d), 3ì°¨ì›(3d), 4ì°¨ì›(4-d), nì°¨ì›(n-d) : Tensor
     * Numpyë¡œ Tensor í‘œí˜„ê³¼ ì‘ìš©ì´ ê°€ëŠ¥
    
    1
    2
    3
    4
    5
    6
    
    
    import numpy as np
    arr = np.array([[3, 6, 9], [2, 4, 8]])
    print(arr.dtype) # </description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°</h2><h3 id="Tensor-ì´í•´í•˜ê¸°"><a href="#Tensor-ì´í•´í•˜ê¸°" class="headerlink" title="Tensor ì´í•´í•˜ê¸°"></a>Tensor ì´í•´í•˜ê¸°</h3><ol><li><p>ì°¨ì›</p><ul><li>0ì°¨ì›(ìƒìˆ˜) : Scalarê°’</li><li>1ì°¨ì›(ë¦¬ìŠ¤íŠ¸ ì”Œìš´ ìƒìˆ˜), 2ì°¨ì›(2d), 3ì°¨ì›(3d), 4ì°¨ì›(4-d), nì°¨ì›(n-d) : Tensor</li><li>Numpyë¡œ Tensor í‘œí˜„ê³¼ ì‘ìš©ì´ ê°€ëŠ¥</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">arr = np.array([[<span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>], [<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>]])</span><br><span class="line">print(arr.dtype) <span class="comment"># dtype(&#x27;float64&#x27;)</span></span><br><span class="line">print(arr.shape) <span class="comment"># (2, 3)</span></span><br><span class="line">print(arr.size) <span class="comment"># 2 * 3 = 6</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>ì°¨ì› ëŠ˜ë¦¬ê¸°ì™€ ì¤„ì´ê¸°</p><ul><li><p>reshape, -1 í™œìš©</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr.reshape(<span class="number">-1</span>) <span class="comment"># 1ì°¨ì›ìœ¼ë¡œ í¼ì¹˜ê¸°</span></span><br><span class="line">arr.reshape(<span class="number">-1</span>, <span class="number">3</span>) <span class="comment"># ì²«ë²ˆì§¸ ì°¨ì›ì€ ì•Œì•„ì„œ, ë‘ë²ˆì§¸ ì°¨ì›ì€ shape 3</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>Ravel() : arrì˜ ì°¨ì›ì„ 1ë¡œ ë°”ê¿ˆ(==&gt; Flatten)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]]) <span class="comment"># (2, 3)</span></span><br><span class="line">arr.ravel()</span><br><span class="line">arr.shape <span class="comment">#(6, )</span></span><br></pre></td></tr></table></figure></li><li><p>np.expand_dims() : ê°’ì„ ìœ ì§€í•˜ê³  ì°¨ì›ë§Œ ëŠ˜ë¦´ë•Œ</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr = np.expand_dims(arr, <span class="number">-1</span>) <span class="comment">#(6, 1)</span></span><br><span class="line">arr.shape</span><br></pre></td></tr></table></figure><ul><li>numpy arrayë¥¼ ë¹ ë¥´ê²Œ ì±„ìš°ëŠ” ë°©ë²•!</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0ìœ¼ë¡œ ì±„ìš°ê¸°</span></span><br><span class="line">arr2 = np.zeros([<span class="number">3</span>, <span class="number">4</span>]) <span class="comment"># 3 * 4ì˜ 0ì´ ì±„ì›Œì§„ ë°°ì—´</span></span><br><span class="line">one2 = np.ones([<span class="number">3</span>, <span class="number">4</span>]) <span class="comment"># 3 * 4ì˜ 1ë¡œ ì±„ì›Œì§„ ë°°ì—´</span></span><br><span class="line"></span><br><span class="line">five2 = np.ones([<span class="number">3</span>, <span class="number">4</span>]) * <span class="number">5</span> <span class="comment"># 1ë¡œ ì±„ìš´ ê°’ì— 5ë¥¼ ë‹¤ ê³±í•¨</span></span><br><span class="line">arr2 = np.arange(n, m) <span class="comment"># n ~ m-1ê¹Œì§€ì˜  ìˆ˜ë¡œ ë°°ì—´ ì±„ìš°ê¸°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># array([n ~ m-1])</span></span><br><span class="line">arr = np.arange(<span class="number">5</span>, <span class="number">11</span>).reshape(<span class="number">2</span>, <span class="number">-1</span>) </span><br><span class="line"><span class="comment"># 5 ~ 10 : 6ê°œì˜ ìˆ«ì, (2, 3)</span></span><br><span class="line"></span><br><span class="line">arr <span class="comment"># array([5, 6, 7]</span></span><br><span class="line">    <span class="comment">#       [8, 9, 10])</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>ëª¨ì–‘ì´ ë§ì§€ ì•Šìœ¼ë©´ Errorâ€¦<br>5, 6, 7, 8, 9ëŠ” 5ê°œì˜ ìˆ«ì<br>5 * 1 ë§Œ ê°€ëŠ¥í•œ.<br><img src="/2020/11/22/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%84/slide_lect.PNG" alt="ëª¨ì–‘ë‹¤ë¦„"></li></ul></li><li><p>Index &amp; slicing</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ë¦¬ìŠ¤íŠ¸ ì¸ë±ìŠ¤ &amp; ìŠ¬ë¼ì´ì‹±</span></span><br><span class="line"></span><br><span class="line">nums = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">nums[:<span class="number">-1</span>] <span class="comment"># ë§ˆì§€ë§‰ ìˆ«ì ì „ê¹Œì§€ í‘œì‹œ</span></span><br><span class="line"></span><br><span class="line">nums[::<span class="number">-1</span>] <span class="comment"># ë¦¬ìŠ¤íŠ¸ ì•ˆì˜ ìˆ«ìë¥¼ ê±°ê¾¸ë¡œ í‘œí˜„</span></span><br><span class="line"></span><br><span class="line">nums = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line">print(nums[<span class="number">0</span>][<span class="number">1</span>]) = <span class="number">2</span> <span class="comment"># ì²«ë²ˆì§¸ ë¦¬ìŠ¤íŠ¸ ì•ˆì˜ ì¸ë±ìŠ¤ê°€ 1ì¸ ìˆ«ì</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">arr = np.array([<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>], [<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>])</span><br><span class="line">print(arr[<span class="number">1</span>, <span class="number">2</span>]) <span class="comment"># 10 --&gt; ì¸ë±ì‹± [í–‰, ì—´]</span></span><br><span class="line"></span><br><span class="line">print(arr[<span class="number">1</span>:, <span class="number">1</span>:]) <span class="comment"># [[9, 10]]</span></span><br></pre></td></tr></table></figure><ol start="4"><li>Boolean Indexing<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randn(<span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line">print(data&lt;=<span class="number">0</span>) <span class="comment"># False, Trueë¡œ ë‚˜ì˜´</span></span><br><span class="line"></span><br><span class="line">data[data &lt;=<span class="number">0</span>] = <span class="number">1</span> <span class="comment"># 0 ì´í•˜ì¸ ê²ƒì„ 1ë¡œ ì±„ìš°ë‹¤</span></span><br></pre></td></tr></table></figure></li></ol>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/22/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%84/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>GANí”„ë¡œì íŠ¸_try</title>
      <link>https://ikarus-999.github.io/2020/11/17/GAN%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-try/</link>
      <guid>https://ikarus-999.github.io/2020/11/17/GAN%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-try/</guid>
      <pubDate>Tue, 17 Nov 2020 12:28:07 GMT</pubDate>
      
      <description>Style GAN toy í”„ë¡œì íŠ¸
StyleGANì˜ íŠ¹ì§•
 1. ì´ë¯¸ì§€ë¥¼ Styleì˜ ì¡°í•©ìœ¼ë¡œ ë³´ê³ 
    Generatorì˜ ê° Layerë§ˆë‹¤ Style ì •ë³´ë¥¼ ì…íˆëŠ” ë°©ì‹ìœ¼ë¡œ ì´ë¯¸ì§€ í•©ì„±
    ì´ ë•Œ ê° Layerì—ì„œ ì¶”ê°€ë˜ëŠ” Styleì€ ì´ë¯¸ì§€ì˜ Coarse Feature(í¬ì¦ˆ, ì„±ë³„ ë“±)ë¶€í„°
    Fine Detail(ë¨¸ë¦¬ìƒ‰, í”¼ë¶€í†¤ ë“±)ê¹Œì§€
    ê°ê¸° ë‹¤ë¥¸ Levelì˜ Visual ì†ì„±ë“¤ì„ ì¡°ì ˆ ê°€ëŠ¥
    StyleGANì€ ìƒê°ë³´ë‹¤ ì•ˆì •ì ì´ê³  ë†’ì€ í€„ë¦¬í‹°ì˜ ì´ë¯¸ì§€ ìƒì„± 

ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°(Module)
 1. GANì´</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="Style-GAN-toy-í”„ë¡œì íŠ¸"><a href="#Style-GAN-toy-í”„ë¡œì íŠ¸" class="headerlink" title="Style GAN toy í”„ë¡œì íŠ¸"></a>Style GAN toy í”„ë¡œì íŠ¸</h2><h3 id="StyleGANì˜-íŠ¹ì§•"><a href="#StyleGANì˜-íŠ¹ì§•" class="headerlink" title="StyleGANì˜ íŠ¹ì§•"></a>StyleGANì˜ íŠ¹ì§•</h3><ol><li>ì´ë¯¸ì§€ë¥¼ Styleì˜ ì¡°í•©ìœ¼ë¡œ ë³´ê³ <br>Generatorì˜ ê° Layerë§ˆë‹¤ Style ì •ë³´ë¥¼ ì…íˆëŠ” ë°©ì‹ìœ¼ë¡œ ì´ë¯¸ì§€ í•©ì„±<br>ì´ ë•Œ ê° Layerì—ì„œ ì¶”ê°€ë˜ëŠ” Styleì€ ì´ë¯¸ì§€ì˜ Coarse Feature(í¬ì¦ˆ, ì„±ë³„ ë“±)ë¶€í„°<br>Fine Detail(ë¨¸ë¦¬ìƒ‰, í”¼ë¶€í†¤ ë“±)ê¹Œì§€<br>ê°ê¸° ë‹¤ë¥¸ Levelì˜ Visual ì†ì„±ë“¤ì„ ì¡°ì ˆ ê°€ëŠ¥<br>StyleGANì€ ìƒê°ë³´ë‹¤ ì•ˆì •ì ì´ê³  ë†’ì€ í€„ë¦¬í‹°ì˜ ì´ë¯¸ì§€ ìƒì„±  </li></ol><h3 id="ë„¤íŠ¸ì›Œí¬-êµ¬ì¡°-Module"><a href="#ë„¤íŠ¸ì›Œí¬-êµ¬ì¡°-Module" class="headerlink" title="ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°(Module)"></a>ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°(Module)</h3><ol><li>GANì´ë€ ì–´ë–¤ ê²ƒì¼ê¹Œ???<br><img src="/2020/11/17/GAN%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-try/GANdesc.png" alt="ì´ê²ƒì´ GAN"></li></ol><p><img src="/2020/11/17/GAN%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-try/slide21.PNG" alt="GAN model"></p><ul><li>Instance Norm?<br><img src="/2020/11/17/GAN%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-try/slide22.PNG" alt="Instance Norm"></li></ul><p><img src="/2020/11/17/GAN%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-try/slide23.PNG" alt="Instance Norm2"></p><ul><li>Generator êµ¬ì¡° ì„¤ëª…</li></ul><p><img src="/2020/11/17/GAN%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-try/slide322.png" alt="model"></p><p>ì™¼ìª½ì´ Traditional Network, ì˜¤ë¥¸ìª½ì´ ì´ ë…¼ë¬¸ì—ì„œ ì œì•ˆí•œ Style-gased Generator. </p><p>ì™¼ìª½ ë„¤íŠ¸ì›Œí¬ì™€ ì˜¤ë¥¸ìª½ì— Synthesis Networkê°€ ë˜‘ê°™ì€ êµ¬ì¡°ë¥¼ ê°–ê³  ìˆì§€ë§Œ,<br>ì´ì „ GANì—ì„œëŠ” Latent zë¥¼ ë°”ë¡œ Inputìœ¼ë¡œ ë„£ì–´ì¤¬ë˜ ê²ƒê³¼ëŠ” ë‹¤ë¥´ê²Œ,<br>StyleGANì—ì„œëŠ” í•™ìŠµëœ Constant, (w) ê°’ì„ ì…ë ¥ìœ¼ë¡œ ì‚¬ìš©í•¨. </p><p>ìƒˆë¡­ê²Œ Mapping Networkì™€ Noiseê°€ ì¶”ê°€ë¨..</p><p>Wë¥¼ Featureì— ë§¤í•‘í•˜ëŠ” ê²½ìš°<br>WëŠ” Zì²˜ëŸ¼ ê³ ì •ëœ ë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠìŒ. </p><p>Sampling densityëŠ” í•™ìŠµëœ Piecewise Continuous Mapping f(z)<br>(fëŠ” Mapping Network ì…ë‹ˆë‹¤)ì— ì˜í•´ ì •í•´ì§. </p><p>ë”°ë¼ì„œ, Warping(í‹€ì–´ì§)ì´ ë§ì´ ì¼ì–´ë‚˜ì§€ ì•ŠìŒ.<br>ê·¸ë ‡ê¸° ë•Œë¬¸ì— Factors of variationì€ ë”ìš± Linearí•˜ê³ , Disentangled (ì–½íˆì§€ ì•ŠìŒ).<br>ì´ê²ƒì´ ë°”ë¡œ zë¥¼ ê³§ë°”ë¡œ Featureì— ë§¤í•‘í•˜ëŠ” ê²ƒë³´ë‹¤ wì— ë§¤í•‘í•˜ëŠ” ê²ƒì˜ ì¥ì ì…ë‹ˆë‹¤</p><p>ê¸°ì¡´ì˜ Generator (a)ëŠ”<br>Input Latent Vector (z)ê°€ ì§ì ‘ Convolution, Upsampling ë“±ì„ ê±°ì³ ì´ë¯¸ì§€ë¡œ ë³€í™˜ë˜ëŠ” êµ¬ì¡°. </p><p>Style-based Generator (b) ì˜ ê²½ìš°,<br>(z)ê°€  Fully-connected Layerë¡œ êµ¬ì„±ëœ Mapping Networkì„ ê±°ì³<br>Intermediate Latent Vector (w) ë¨¼ì € ë³€í™˜. </p><p>(w)ëŠ” Constant Tensorê°€ ì´ë¯¸ì§€ë¡œ ë³€í™˜ë˜ëŠ” ê³¼ì •ì—ì„œ<br>ìŠ¤íƒ€ì¼ì„ ì…íˆëŠ” ì—­í• ì„ ìˆ˜í–‰.</p><p>ë‹¤ì–‘í•œ ìŠ¤íƒ€ì¼ì˜ ì´ë¯¸ì§€ë¥¼ ìƒì„±.</p><ul><li>Style Transferë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°€ëŠ¥ì¼€í•˜ëŠ” Adaptive Instance Norm</li></ul><p>Synthesis Network (í•©ì„± ë„¤íŠ¸ì›Œí¬)<br>zë¥¼ ì¤‘ê°„ latent space Wì— ë§¤í•‘ì„ í•œ ë’¤ì— ì´ wëŠ” â€œAâ€ë¥¼ ê±°ì³ì„œ style, y=(ys,yb)<br>ë¡œ ë³€í˜•ë¨. ì´ë•Œ AëŠ” í•™ìŠµëœ affine transform ì„. ê·¸ë¦¬ê³  ì´ styleë“¤ì€<br>AdaIN(adaptive instance normalization) opeartionì„ control í•¨.<br><img src="/2020/11/17/GAN%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-try/Adain.png" alt="AdaIN"></p><p>AdaINì€ style transferë¥¼ í•  ë•Œ ë§ì´ ì“°ì´ëŠ” ë°©ë²•ìœ¼ë¡œ, ì„ì˜ì˜ style transferë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°€ëŠ¥í•˜ê²Œ í•¨.<br>ì—¬ê¸°ì„œ feature map xiëŠ”<br>normalized ëœ ë‹¤ìŒì—, styleë¡œ ë³€í™˜ëœ ë‘ yë¡œ scaled, biased ë¨. (styleì´ ì…í˜€ì§)<br>ì´ ê³¼ì •ì„ ë§¤ layer ë§ˆë‹¤ ë°˜ë³µí•¨. ê·¸ë¦¬ê³  ì´ëŸ¬í•œ ë°©ë²•ì€ scale-specific control ì„ ê°€ëŠ¥í•˜ê²Œ í•¨.</p><blockquote><p>To be continuedâ€¦</p></blockquote>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      <category domain="https://ikarus-999.github.io/tags/GAN/">GAN</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/17/GAN%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-try/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>training_pc</title>
      <link>https://ikarus-999.github.io/2020/11/16/training-pc/</link>
      <guid>https://ikarus-999.github.io/2020/11/16/training-pc/</guid>
      <pubDate>Sun, 15 Nov 2020 17:00:28 GMT</pubDate>
      
      <description>ë”¥ëŸ¬ë‹ ê³µë¶€ í›„ê¸°
ë¹„ì •í˜• ë°ì´í„°ë¥¼ ë‹¤ë£°ë ¤ë©´ GPUëŠ” í•„ìˆ˜ë‹¤.

Why GPU ??
 1. CPUë³´ë‹¤ ë” ë¹ ë¥¸ ë³‘ë ¬ ì²˜ë¦¬ ê°€ëŠ¥

 *  í–‰ë ¬ê³± ê³„ì‚°ì´ CPUë³´ë‹¤ í›¨ì”¬ ë¹ ë¦„

 2. ê³„ì‚° ê·¸ë˜í”„ ë¹Œë“œ, ì²˜ë¦¬ ì†ë„ê°€ ë¹ ë¦„.

 * ë¹„ì •í˜• ë°ì´í„° ì²˜ë¦¬ì—” GPUê°€ í•„ìˆ˜

ìŒì„± ë”¥ëŸ¬ë‹, ë‚˜ë„ í•´ë³¼ê¹Œ?
ìŒì„± ë”¥ëŸ¬ë‹

ìŒì„± ë”¥ëŸ¬ë‹ì€ ê²°ì½” ì‰½ì§€ ì•Šë‹¤. ë”¥ëŸ¬ë‹ê³„ì˜ ë³´ìŠ¤ê¸‰.
ì‹ í˜¸ì²˜ë¦¬ ë°°ì›Œì•¼ ê·¸ë‚˜ë§ˆ ìˆ˜ì›”í•˜ë‹¤.
ì´ˆë°˜ Feature Extraction ê²½í—˜ì„ ìŒ“ëŠ”ê²ƒì„ ê¶Œì¥í•œë‹¤.
RNNê³„ì—´ì˜ LSTMìœ¼ë¡œ ì‹œì‘. í•˜ì§€ë§Œ,
Attention, Transforme</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="ë”¥ëŸ¬ë‹-ê³µë¶€-í›„ê¸°"><a href="#ë”¥ëŸ¬ë‹-ê³µë¶€-í›„ê¸°" class="headerlink" title="ë”¥ëŸ¬ë‹ ê³µë¶€ í›„ê¸°"></a>ë”¥ëŸ¬ë‹ ê³µë¶€ í›„ê¸°</h2><blockquote><p>ë¹„ì •í˜• ë°ì´í„°ë¥¼ ë‹¤ë£°ë ¤ë©´ GPUëŠ” í•„ìˆ˜ë‹¤.</p></blockquote><h3 id="Why-GPU"><a href="#Why-GPU" class="headerlink" title="Why GPU ??"></a>Why GPU ??</h3><ol><li>CPUë³´ë‹¤ ë” ë¹ ë¥¸ ë³‘ë ¬ ì²˜ë¦¬ ê°€ëŠ¥</li></ol><ul><li> í–‰ë ¬ê³± ê³„ì‚°ì´ CPUë³´ë‹¤ í›¨ì”¬ ë¹ ë¦„</li></ul><ol start="2"><li>ê³„ì‚° ê·¸ë˜í”„ ë¹Œë“œ, ì²˜ë¦¬ ì†ë„ê°€ ë¹ ë¦„.</li></ol><ul><li>ë¹„ì •í˜• ë°ì´í„° ì²˜ë¦¬ì—” GPUê°€ í•„ìˆ˜</li></ul><h3 id="ìŒì„±-ë”¥ëŸ¬ë‹-ë‚˜ë„-í•´ë³¼ê¹Œ"><a href="#ìŒì„±-ë”¥ëŸ¬ë‹-ë‚˜ë„-í•´ë³¼ê¹Œ" class="headerlink" title="ìŒì„± ë”¥ëŸ¬ë‹, ë‚˜ë„ í•´ë³¼ê¹Œ?"></a>ìŒì„± ë”¥ëŸ¬ë‹, ë‚˜ë„ í•´ë³¼ê¹Œ?</h3><p><a href="https://github.com/topics/vggish">ìŒì„± ë”¥ëŸ¬ë‹</a></p><p>ìŒì„± ë”¥ëŸ¬ë‹ì€ ê²°ì½” ì‰½ì§€ ì•Šë‹¤. ë”¥ëŸ¬ë‹ê³„ì˜ ë³´ìŠ¤ê¸‰.<br>ì‹ í˜¸ì²˜ë¦¬ ë°°ì›Œì•¼ ê·¸ë‚˜ë§ˆ ìˆ˜ì›”í•˜ë‹¤.<br>ì´ˆë°˜ Feature Extraction ê²½í—˜ì„ ìŒ“ëŠ”ê²ƒì„ ê¶Œì¥í•œë‹¤.<br>RNNê³„ì—´ì˜ LSTMìœ¼ë¡œ ì‹œì‘. í•˜ì§€ë§Œ,<br>Attention, Transformer ë‚ ì½”ë”© ë“± ë…¼ë¬¸ êµ¬í˜„ ê²½í—˜ì´ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤.<br>Mel Spectrogramì„ í•œë‹¤ í•´ë„ ì›ë¦¬ë¥¼ ì˜ ì•Œì•„ì•¼ ë‚˜ì¤‘ì— ëª¨ë¸ë§ê³¼ ë°ì´í„° ë¶„í•´ê°€ ì‰½ë‹¤.</p><h3 id="ë”¥ëŸ¬ë‹-ì…ë¬¸-ë°©ë²•"><a href="#ë”¥ëŸ¬ë‹-ì…ë¬¸-ë°©ë²•" class="headerlink" title="ë”¥ëŸ¬ë‹ ì…ë¬¸ ë°©ë²•"></a>ë”¥ëŸ¬ë‹ ì…ë¬¸ ë°©ë²•</h3><p>ë”¥ëŸ¬ë‹ ì…ë¬¸ í•˜ë ¤ë©´ ìˆ˜í•™ì€ í•„ìˆ˜. ì •ë§ ì¤‘ìš”.</p><p><a href="https://paperswithcode.com/">ë…¼ë¬¸ êµ¬í˜„ ì‹œë„í•´ë³´ê¸°1</a><br><a href="https://arxiv.org/abs/1706.03762">ë…¼ë¬¸ êµ¬í˜„ ì‹œë„í•´ë³´ê¸°2</a></p><blockquote><p>ì–´ë–¤ ë…¼ë¬¸ì—ëŠ” <em>íŒŒë¼ë¯¸í„° í•˜ë‚˜ë„ ì—†ëŠ”</em> ê²ƒë„ ìˆë‹¤.<br>ë ˆì´ì–´ êµ¬ì¡°ë„ë§Œ ìˆê³  íŒŒë¼ë¯¸í„°ê°€ ì—†ëŠ” ê²ƒì€ ì§„ì§œ êµ¬í˜„ë‚œì´ë„ ë³´ìŠ¤ê¸‰.</p></blockquote><h3 id="ë”¥ëŸ¬ë‹-ìê²©ì¦-ì·¨ë“-í›„ê¸°"><a href="#ë”¥ëŸ¬ë‹-ìê²©ì¦-ì·¨ë“-í›„ê¸°" class="headerlink" title="ë”¥ëŸ¬ë‹ ìê²©ì¦ ì·¨ë“ í›„ê¸°"></a>ë”¥ëŸ¬ë‹ ìê²©ì¦ ì·¨ë“ í›„ê¸°</h3><p>ì´ê²ƒì´ ë°”ë¡œ ë”¥ëŸ¬ë‹ ìê²©ì¦!!<br><img src="https://api.accredible.com/v1/frontend/credential_website_embed_image/certificate/25378511," alt="ìš°ì™€~" title="WoW!"></p><ol><li>ë¬¸ì œ ìœ í˜•</li></ol><ul><li><p>Category 1: Basic model</p></li><li><p>Category 2: Model from learning dataset</p></li><li><p>Category 3: Image classification<br>Convolutional Neural Network with real-world image dataset</p></li><li><p>Category 4: Natural language processing (NLP)<br>NLP Text Classification with real-world text dataset</p></li><li><p>Category 5: Time series, sequences and predictions<br>Sequence Model with real-world numeric dataset</p></li><li><p>ì´ ì‹œí—˜ì€ ì‘ì‹œìê°€ TensorFlow 2.xë¥¼ í†µí•´ ëª¨ë¸ì„ ë¹Œë“œí•˜ì—¬ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ”ì§€<br>í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.</p></li><li><p>ë¨¸ì‹ ëŸ¬ë‹(ML) ë° ë”¥ëŸ¬ë‹ì˜ ê¸°ë³¸ ì›ì¹™</p></li><li><p>TensorFlow 2.xì—ì„œ ML ëª¨ë¸ ê°œë°œí•˜ê¸°</p></li><li><p>ì‹¬ì¸µì‹ ê²½ë§ ë° í•©ì„±ê³± ì‹ ê²½ë§(CNN)ì„ í†µí•œ ì´ë¯¸ì§€ ì¸ì‹, ê°ì²´ íƒì§€, í…ìŠ¤íŠ¸ ì¸ì‹ ì•Œê³ ë¦¬ì¦˜ ë¹Œë“œ</p></li><li><p>ì»´í“¨í„°ê°€ ì •ë³´ë¥¼ â€˜ë³´ëŠ”â€™ ë°©ì‹ê³¼ í”Œë¡¯ ì†ì‹¤ ë° ì •í™•ë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ë‹¤ë¥¸ í¬ê¸° ë° í˜•íƒœì˜ ì‹¤ì œ ì´ë¯¸ì§€ë¥¼ í™œìš©í•˜ì—¬ í•©ì„±ê³±ì—ì„œ ì´ë¯¸ì§€ì˜ ê²½ë¡œë¥¼ ì‹œê°í™”</p></li><li><p>ê³¼ì í•©ì„ ì˜ˆë°©í•˜ê¸° ìœ„í•œ í™•ì¥ ë° ë“œë¡­ì•„ì›ƒê³¼ ê°™ì€ ì „ëµ íƒìƒ‰</p></li><li><p>TensorFlowë¥¼ ì´ìš©í•˜ì—¬ ìì—°ì–´ ì²˜ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì‹ ê²½ë§ ì ìš©</p></li></ul><blockquote><p>Google ê³µì‹ í˜ì´ì§€ ë°œì·Œ</p></blockquote><ol start="2"><li>í•©ê²© ì ìˆ˜ / ê·œì¹™</li></ol><blockquote><p>í—ˆìš©ëœ ì¸í„°ë„· ë¸Œë¼ìš°ì§•ì€ Tensorflow document, ì´ 100ì  ë§Œì ì— 90ì  ì»¤íŠ¸ë¼ì¸</p></blockquote><ul><li>ë‚œì´ë„ëŠ” category 5ê°€ ê°€ì¥ ë†’ìŒ</li></ul><blockquote><p>ì‹œí—˜ ì‹œê°„ : 5ì‹œê°„ (ì»´í“¨í„° ë”¥ëŸ¬ë‹ í›ˆë ¨ì‹œê°„ í¬í•¨)</p></blockquote><ol start="3"><li>ë”°ë©´ ì¢‹ì€ ì </li></ol><p>ê°œë°œì ë„¤íŠ¸ì›Œí¬ì— join í•  ìˆ˜ê°€ ìˆì–´ìš”~</p><p><a href="https://www.tensorflow.org/certificate-network?hl=ko">ìê²©ì¦ ë„¤íŠ¸ì›Œí¬</a></p><p><a href="https://github.com/Hvass-Labs/TensorFlow-Tutorials">ì°¸ê³ ë¬¸ì„œ</a></p><p>ê·¸ëŸ¼ 20000~!</p>]]></content:encoded>
      
      
      <category domain="https://ikarus-999.github.io/categories/Machine-Learning/">Machine Learning</category>
      
      
      <category domain="https://ikarus-999.github.io/tags/ML/">ML</category>
      
      <category domain="https://ikarus-999.github.io/tags/DL/">DL</category>
      
      
      <comments>https://ikarus-999.github.io/2020/11/16/training-pc/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
